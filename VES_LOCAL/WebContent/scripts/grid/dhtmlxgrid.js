dhtmlx=function(a){for(var b in a)dhtmlx[b]=a[b];return dhtmlx};dhtmlx.extend_api=function(a,b,c){var d=window[a];if(d)window[a]=function(a){if(a&&typeof a=="object"&&!a.tagName){var c=d.apply(this,b._init?b._init(a):arguments),h;for(h in dhtmlx)if(b[h])this[b[h]](dhtmlx[h]);for(h in a)if(b[h])this[b[h]](a[h]);else h.indexOf("on")==0&&this.attachEvent(h,a[h])}else c=d.apply(this,arguments);b._patch&&b._patch(this);return c||this},window[a].prototype=d.prototype,c&&dhtmlXHeir(window[a].prototype,c)};
dhtmlxAjax={get:function(a,b){var c=new dtmlXMLLoaderObject(!0);c.async=arguments.length<3;c.waitCall=b;c.loadXML(a);return c},post:function(a,b,c){var d=new dtmlXMLLoaderObject(!0);d.async=arguments.length<4;d.waitCall=c;d.loadXML(a,!0,b);return d},getSync:function(a){return this.get(a,null,!0)},postSync:function(a,b){return this.post(a,b,null,!0)}};
function dtmlXMLLoaderObject(a,b,c,d){this.xmlDoc="";this.async=typeof c!="undefined"?c:!0;this.onloadAction=a||null;this.mainObject=b||null;this.waitCall=null;this.rSeed=d||!1;return this}dtmlXMLLoaderObject.count=0;
dtmlXMLLoaderObject.prototype.waitLoadFunction=function(a){var b=!0;return this.check=function(){if(a&&a.onloadAction!=null&&(!a.xmlDoc.readyState||a.xmlDoc.readyState==4)&&b){b=!1;dtmlXMLLoaderObject.count++;if(typeof a.onloadAction=="function")a.onloadAction(a.mainObject,null,null,null,a);if(a.waitCall)a.waitCall.call(this,a),a.waitCall=null}}};
dtmlXMLLoaderObject.prototype.getXMLTopNode=function(a,b){if(this.xmlDoc.responseXML){var c=this.xmlDoc.responseXML.getElementsByTagName(a);c.length==0&&a.indexOf(":")!=-1&&(c=this.xmlDoc.responseXML.getElementsByTagName(a.split(":")[1]));var d=c[0]}else d=this.xmlDoc.documentElement;if(d)return this._retry=!1,d;if(!this._retry&&_isIE)return this._retry=!0,b=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(a,b);dhtmlxError.throwError("LoadXML","Incorrect XML",
[b||this.xmlDoc,this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(a,b){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(a);else{var c=new DOMParser;this.xmlDoc=c.parseFromString(a,"text/xml")}if(!b){if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall)this.waitCall(),this.waitCall=null}};
dtmlXMLLoaderObject.prototype.loadXML=function(a,b,c,d){this.rSeed&&(a+=(a.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=a;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(this.async)this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this);this.xmlDoc.open(b?"POST":"GET",a,this.async);d?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type",
"text/xml")):b&&this.xmlDoc.setRequestHeader("Content-type",this.contenttype||"application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(c);this.async||(new this.waitLoadFunction(this))()};
dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null};
dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(a){for(var b={},c=0;c<a.attributes.length;c++)b[a.attributes[c].name]=a.attributes[c].value;b._tagvalue=a.firstChild?a.firstChild.nodeValue:"";for(c=0;c<a.childNodes.length;c++){var d=a.childNodes[c].tagName;d&&(b[d]||(b[d]=[]),b[d].push(this.xmlNodeToJSON(a.childNodes[c])))}return b};function callerFunction(a,b){return this.handler=function(c){if(!c)c=window.event;a(c,b);return!0}}function getAbsoluteLeft(a){return getOffset(a).left}
function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop),c+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:b,left:c}}
function getOffsetRect(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,g=window.pageXOffset||d.scrollLeft||c.scrollLeft,h=d.clientTop||c.clientTop||0,f=d.clientLeft||c.clientLeft||0,i=b.top+e-h,j=b.left+g-f;return{top:Math.round(i),left:Math.round(j)}}function getOffset(a){return a.getBoundingClientRect?getOffsetRect(a):getOffsetSum(a)}
function convertStringToBoolean(a){typeof a=="string"&&(a=a.toLowerCase());switch(a){case "1":case "true":case "yes":case "y":case 1:case !0:return!0;default:return!1}}function getUrlSymbol(a){return a.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop)return window.dhtmlDragAndDrop;this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0;this.tempDOMM=this.tempDOMU=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}
dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy;a.dragStarter=b;this.addDragLanding(a,b)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b};
dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if(!((a||window.event)&&(a||event).button==2)){if(window.dhtmlDragAndDrop.waitDrag)return window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1;window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(a);window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=
document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=(new Date).valueOf();a&&a.preventDefault&&a.preventDefault();return!1}};
dhtmlDragAndDropObject.prototype.callDrag=function(a){if(!a)a=window.event;dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode)if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,a);if(!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=
0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else return dragger.stopDrag(a,!0);if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var b=dragger.gldragNode;if(dragger.gldragNode.old)b=dragger.gldragNode.old;b.parentNode.removeChild(b);var c=dragger.dragNode.pWindow;b.pWindow&&b.pWindow.dhtmlDragAndDrop.lastLanding&&b.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(b.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var d=document.createElement("Div");d.innerHTML=
dragger.dragNode.outerHTML;dragger.dragNode=d.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);c.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=a.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=a.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||
document.documentElement.scrollTop)+"px";var e=a.srcElement?a.srcElement:a.target;dragger.checkLanding(e,a)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(a){if(window.name){for(var b=parent.frames[window.name].frameElement.offsetParent,c=0,d=0;b;)c+=b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;if(parent.dhtmlDragAndDrop){var e=parent.dhtmlDragAndDrop.calculateFramePosition(1);c+=e.split("_")[0]*1;d+=e.split("_")[1]*1}if(a)return c+"_"+d;else this.fx=c;this.fy=d}return"0_0"};
dhtmlDragAndDropObject.prototype.checkLanding=function(a,b){a&&a.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=a,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,b.clientX,b.clientY,b),this.lastLanding_scr=_isIE?b.srcElement:b.target):a&&a.tagName!="BODY"?this.checkLanding(a.parentNode,b):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,b.clientX,b.clientY,b),this.lastLanding=
0,this._onNotFound&&this._onNotFound())};
dhtmlDragAndDropObject.prototype.stopDrag=function(a,b){dragger=window.dhtmlDragAndDrop;if(!b){dragger.stopFrameRoute();var c=dragger.lastLanding;dragger.lastLanding=null;c&&c.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,c,_isIE?event.srcElement:a.target)}dragger.lastLanding=null;dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode);dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=
0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(a){a&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var b=0;b<window.frames.length;b++)try{window.frames[b]!=a&&window.frames[b].dhtmlDragAndDrop&&window.frames[b].dhtmlDragAndDrop.stopFrameRoute(window)}catch(c){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(d){}};
dhtmlDragAndDropObject.prototype.initFrameRoute=function(a,b){if(a)window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=a.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=a.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=a.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=a.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&b&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition();
try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(c){}for(var d=0;d<window.frames.length;d++)try{window.frames[d]!=a&&window.frames[d].dhtmlDragAndDrop&&window.frames[d].dhtmlDragAndDrop.initFrameRoute(window,!a||b?1:0)}catch(e){}};_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);
if(navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1)_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0;else if(navigator.userAgent.indexOf("Opera")!=-1)_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3));else if(navigator.appName.indexOf("Microsoft")!=-1){if(_isIE=!0,(navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=
-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1||document.documentMode>7)&&document.compatMode!="BackCompat")_isIE=8}else navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));
dtmlXMLLoaderObject.prototype.doXPath=function(a,b,c,d){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(a,b);if(_isIE)return b||(b=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),b||dhtmlxError.throwError("LoadXML","Incorrect XML",[b||this.xmlDoc,this.mainObject]),c!=null&&b.setProperty("SelectionNamespaces","xmlns:xsl='"+c+"'"),d=="single"?b.selectSingleNode(a):b.selectNodes(a)||[];else{var e=b;b||(b=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML);b||dhtmlxError.throwError("LoadXML",
"Incorrect XML",[b||this.xmlDoc,this.mainObject]);b.nodeName.indexOf("document")!=-1?e=b:(e=b,b=b.ownerDocument);var g=XPathResult.ANY_TYPE;if(d=="single")g=XPathResult.FIRST_ORDERED_NODE_TYPE;var h=[],f=b.evaluate(a,e,function(){return c},g,null);if(g==XPathResult.FIRST_ORDERED_NODE_TYPE)return f.singleNodeValue;for(var i=f.iterateNext();i;)h[h.length]=i,i=f.iterateNext();return h}};function z(){if(!this.catches)this.catches=[];return this}z.prototype.catchError=function(a,b){this.catches[a]=b};
z.prototype.throwError=function(a,b,c){if(this.catches[a])return this.catches[a](a,b,c);if(this.catches.ALL)return this.catches.ALL(a,b,c);alert("Error type: "+a+"\nDescription: "+b);return null};window.dhtmlxError=new z;
dtmlXMLLoaderObject.prototype.doXPathOpera=function(a,b){var c=a.replace(/[\/]+/gi,"/").split("/"),d=null,e=1;if(!c.length)return[];if(c[0]==".")d=[b];else if(c[0]=="")d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(c[e].replace(/\[[^\]]*\]/g,"")),e++;else return[];for(;e<c.length;e++)d=this._getAllNamedChilds(d,c[e]);c[e-1].indexOf("[")!=-1&&(d=this._filterXPath(d,c[e-1]));return d};
dtmlXMLLoaderObject.prototype._filterXPath=function(a,b){for(var c=[],b=b.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),d=0;d<a.length;d++)a[d].getAttribute(b)&&(c[c.length]=a[d]);return c};
dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(a,b){var c=[];_isKHTML&&(b=b.toUpperCase());for(var d=0;d<a.length;d++)for(var e=0;e<a[d].childNodes.length;e++)_isKHTML?a[d].childNodes[e].tagName&&a[d].childNodes[e].tagName.toUpperCase()==b&&(c[c.length]=a[d].childNodes[e]):a[d].childNodes[e].tagName==b&&(c[c.length]=a[d].childNodes[e]);return c};function dhtmlXHeir(a,b){for(var c in b)typeof b[c]=="function"&&(a[c]=b[c]);return a;}
function dhtmlxEvent(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(a,b,c){if(!c)c=this.xslDoc;if(c.responseXML)c=c.responseXML;var d=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+a+"']",c,"http://www.w3.org/1999/XSL/Transform","single");if(d!=null)d.firstChild.nodeValue=b};
dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(a,b){if(!a)a=this.xslDoc;if(a.responseXML)a=a.responseXML;if(!b)b=this.xmlDoc;if(b.responseXML)b=b.responseXML;if(_isIE){d=new ActiveXObject("Msxml2.DOMDocument.3.0");try{b.transformNodeToObject(a,d)}catch(c){d=b.transformNode(a)}}else{if(!this.XSLProcessor)this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(a);var d=this.XSLProcessor.transformToDocument(b)}return d};
dtmlXMLLoaderObject.prototype.doXSLTransToString=function(a,b){var c=this.doXSLTransToObject(a,b);return typeof c=="string"?c:this.doSerialization(c)};dtmlXMLLoaderObject.prototype.doSerialization=function(a){if(!a)a=this.xmlDoc;if(a.responseXML)a=a.responseXML;if(_isIE)return a.xml;else{var b=new XMLSerializer;return b.serializeToString(a)}};
dhtmlxEventable=function(a){a.attachEvent=function(a,c,d){a="ev_"+a.toLowerCase();this[a]||(this[a]=new this.eventCatcher(d||this));return a+":"+this[a].addEvent(c)};a.callEvent=function(a,c){a="ev_"+a.toLowerCase();return this[a]?this[a].apply(this,c):!0};a.checkEvent=function(a){return!!this["ev_"+a.toLowerCase()]};a.eventCatcher=function(a){var c=[],d=function(){for(var e=!0,d=0;d<c.length;d++)if(c[d]!=null)var h=c[d].apply(a,arguments),e=e&&h;return e};d.addEvent=function(a){typeof a!="function"&&
(a=eval(a));return a?c.push(a)-1:!1};d.removeEvent=function(a){c[a]=null};return d};a.detachEvent=function(a){if(a!=!1){var c=a.split(":");this[c[0]].removeEvent(c[1])}};a.detachAllEvents=function(){for(var a in this)a.indexOf("ev_")==0&&(this.detachEvent(a),this[a]=null)};a=null};if(!window.dhtmlx)window.dhtmlx={};
(function(){function a(a,b){var e=a.callback;c(!1);a.box.parentNode.removeChild(a.box);m=a.box=null;e&&e(b)}function b(b){if(m){var b=b||event,c=b.which||event.keyCode;dhtmlx.message.keyboard&&((c==13||c==32)&&a(m,!0),c==27&&a(m,!1));b.preventDefault&&b.preventDefault();return!(b.cancelBubble=!0)}}function c(a){if(!c.cover)c.cover=document.createElement("DIV"),c.cover.onkeydown=b,c.cover.className="dhx_modal_cover",document.body.appendChild(c.cover);var e=document.body.scrollHeight;c.cover.style.display=
a?"inline-block":"none"}function d(a,b){return"<div class='dhtmlx_popup_button' result='"+b+"' ><div>"+a+"</div></div>"}function e(a){if(!n.area)n.area=document.createElement("DIV"),n.area.className="dhtmlx_message_area",n.area.style[n.position]="5px",document.body.appendChild(n.area);n.hide(a.id);var b=document.createElement("DIV");b.innerHTML="<div>"+a.text+"</div>";b.className="dhtmlx-info dhtmlx-"+a.type;b.onclick=function(){n.hide(a.id);a=null};n.position=="bottom"&&n.area.firstChild?n.area.insertBefore(b,
n.area.firstChild):n.area.appendChild(b);a.expire>0&&(n.timers[a.id]=window.setTimeout(function(){n.hide(a.id)},a.expire));n.pull[a.id]=b;b=null;return a.id}function g(b,c,e){var g=document.createElement("DIV");g.className=" dhtmlx_modal_box dhtmlx-"+b.type;g.setAttribute("dhxbox",1);var f="";if(b.width)g.style.width=b.width;if(b.height)g.style.height=b.height;b.title&&(f+='<div class="dhtmlx_popup_title">'+b.title+"</div>");f+='<div class="dhtmlx_popup_text"><span>'+(b.content?"":b.text)+'</span></div><div  class="dhtmlx_popup_controls">';
c&&(f+=d(b.ok||"OK",!0));e&&(f+=d(b.cancel||"Cancel",!1));if(b.buttons)for(var h=0;h<b.buttons.length;h++)f+=d(b.buttons[h],h);f+="</div>";g.innerHTML=f;if(b.content){var k=b.content;typeof k=="string"&&(k=document.getElementById(k));if(k.style.display=="none")k.style.display="";g.childNodes[b.title?1:0].appendChild(k)}g.onclick=function(c){var c=c||event,e=c.target||c.srcElement;if(!e.className)e=e.parentNode;if(e.className=="dhtmlx_popup_button"){var d=e.getAttribute("result"),d=d=="true"||(d==
"false"?!1:d);a(b,d)}};b.box=g;if(c||e)m=b;return g}function h(a,e,d){var f=a.tagName?a:g(a,e,d);a.hidden||c(!0);document.body.appendChild(f);var h=a.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-f.offsetWidth)/2)),k=a.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-f.offsetHeight)/2));f.style.top=a.position=="top"?"-3px":k+"px";f.style.left=h+"px";f.onkeydown=b;f.focus();a.hidden&&dhtmlx.modalbox.hide(f);return f}function f(a){return h(a,
!0,!1)}function i(a){return h(a,!0,!0)}function j(a){return h(a)}function l(a,b,c){typeof a!="object"&&(typeof b=="function"&&(c=b,b=""),a={text:a,type:b,callback:c});return a}function k(a,b,c,e){typeof a!="object"&&(a={text:a,type:b,expire:c,id:e});a.id=a.id||n.uid();a.expire=a.expire||n.expire;return a}var m=null;document.attachEvent?document.attachEvent("onkeydown",b):document.addEventListener("keydown",b,!0);dhtmlx.alert=function(){var a=l.apply(this,arguments);a.type=a.type||"confirm";return f(a)};
dhtmlx.confirm=function(){var a=l.apply(this,arguments);a.type=a.type||"alert";return i(a)};dhtmlx.modalbox=function(){var a=l.apply(this,arguments);a.type=a.type||"alert";return j(a)};dhtmlx.modalbox.hide=function(a){for(;a&&a.getAttribute&&!a.getAttribute("dhxbox");)a=a.parentNode;a&&(a.parentNode.removeChild(a),c(!1))};var n=dhtmlx.message=function(a,b,c,d){a=k.apply(this,arguments);a.type=a.type||"info";var g=a.type.split("-")[0];switch(g){case "alert":return f(a);case "confirm":return i(a);case "modalbox":return j(a);
default:return e(a)}};n.seed=(new Date).valueOf();n.uid=function(){return n.seed++};n.expire=4E3;n.keyboard=!0;n.position="top";n.pull={};n.timers={};n.hideAll=function(){for(var a in n.pull)n.hide(a)};n.hide=function(a){var b=n.pull[a];b&&b.parentNode&&(window.setTimeout(function(){b.parentNode.removeChild(b);b=null},2E3),b.className+=" hidden",n.timers[a]&&window.clearTimeout(n.timers[a]),delete n.pull[a])}})();
function dataProcessor(a){this.serverProcessor=a;this.action_param="!nativeeditor_status";this.object=null;this.updatedRows=[];this.autoUpdate=!0;this.updateMode="cell";this._tMode="GET";this.post_delim="_";this._waitMode=0;this._in_progress={};this._invalid={};this.mandatoryFields=[];this.messages=[];this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",clear:"font-weight:normal;text-decoration:none;"};
this.enableUTFencoding(!0);dhtmlxEventable(this);return this}
dataProcessor.prototype={setTransactionMode:function(a,b){this._tMode=a;this._tSend=b},escape:function(a){return this._utf?encodeURIComponent(a):escape(a)},enableUTFencoding:function(a){this._utf=convertStringToBoolean(a)},setDataColumns:function(a){this._columns=typeof a=="string"?a.split(","):a},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(a){this._endnm=convertStringToBoolean(a)},enablePartialDataSend:function(a){this._changed=convertStringToBoolean(a)},setUpdateMode:function(a,
b){this.autoUpdate=a=="cell";this.updateMode=a;this.dnd=b},ignore:function(a,b){this._silent_mode=!0;a.call(b||window);this._silent_mode=!1},setUpdated:function(a,b,c){if(!this._silent_mode){var d=this.findRow(a),c=c||"updated",e=this.obj.getUserData(a,this.action_param);e&&c=="updated"&&(c=e);b?(this.set_invalid(a,!1),this.updatedRows[d]=a,this.obj.setUserData(a,this.action_param,c),this._in_progress[a]&&(this._in_progress[a]="wait")):this.is_invalid(a)||(this.updatedRows.splice(d,1),this.obj.setUserData(a,
this.action_param,""));b||this._clearUpdateFlag(a);this.markRow(a,b,c);b&&this.autoUpdate&&this.sendData(a)}},_clearUpdateFlag:function(){},markRow:function(a,b,c){var d="",e=this.is_invalid(a);e&&(d=this.styles[e],b=!0);if(this.callEvent("onRowMark",[a,b,c,e])&&(d=this.styles[b?c:"clear"]+d,this.obj[this._methods[0]](a,d),e&&e.details)){d+=this.styles[e+"_cell"];for(var g=0;g<e.details.length;g++)if(e.details[g])this.obj[this._methods[1]](a,g,d)}},getState:function(a){return this.obj.getUserData(a,
this.action_param)},is_invalid:function(a){return this._invalid[a]},set_invalid:function(a,b,c){c&&(b={value:b,details:c,toString:function(){return this.value.toString()}});this._invalid[a]=b},checkBeforeUpdate:function(){return!0},sendData:function(a){if(!this._waitMode||!(this.obj.mytype=="tree"||this.obj._h2)){this.obj.editStop&&this.obj.editStop();if(typeof a=="undefined"||this._tSend)return this.sendAllData();if(this._in_progress[a])return!1;this.messages=[];if(!this.checkBeforeUpdate(a)&&this.callEvent("onValidationError",
[a,this.messages]))return!1;this._beforeSendData(this._getRowData(a),a)}},_beforeSendData:function(a,b){if(!this.callEvent("onBeforeUpdate",[b,this.getState(b),a]))return!1;this._sendData(a,b)},serialize:function(a,b){if(typeof a=="string")return a;if(typeof b!="undefined")return this.serialize_one(a,"");else{var c=[],d=[],e;for(e in a)a.hasOwnProperty(e)&&(c.push(this.serialize_one(a[e],e+this.post_delim)),d.push(e));c.push("ids="+this.escape(d.join(",")));dhtmlx.security_key&&c.push("dhx_security="+
dhtmlx.security_key);return c.join("&")}},serialize_one:function(a,b){if(typeof a=="string")return a;var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(this.escape((b||"")+d)+"="+this.escape(a[d]));return c.join("&")},_sendData:function(a,b){if(a){if(!this.callEvent("onBeforeDataSending",b?[b,this.getState(b),a]:[null,null,a]))return!1;b&&(this._in_progress[b]=(new Date).valueOf());var c=new dtmlXMLLoaderObject(this.afterUpdate,this,!0),d=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+
["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");this._tMode!="POST"?c.loadXML(d+(d.indexOf("?")!=-1?"&":"?")+this.serialize(a,b)):c.loadXML(d,!0,this.serialize(a,b));this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var a=!0,b=0;b<this.updatedRows.length;b++)a&=this.checkBeforeUpdate(this.updatedRows[b]);if(!a&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());
else for(b=0;b<this.updatedRows.length;b++)if(!this._in_progress[this.updatedRows[b]]&&!this.is_invalid(this.updatedRows[b])&&(this._beforeSendData(this._getRowData(this.updatedRows[b]),this.updatedRows[b]),this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2)))break}},_getAllData:function(){for(var a={},b=!1,c=0;c<this.updatedRows.length;c++){var d=this.updatedRows[c];!this._in_progress[d]&&!this.is_invalid(d)&&this.callEvent("onBeforeUpdate",[d,this.getState(d)])&&(a[d]=this._getRowData(d,d+this.post_delim),
b=!0,this._in_progress[d]=(new Date).valueOf())}return b?a:null},setVerificator:function(a,b){this.mandatoryFields[a]=b||function(a){return a!=""}},clearVerificator:function(a){this.mandatoryFields[a]=!1},findRow:function(a){for(var b=0,b=0;b<this.updatedRows.length;b++)if(a==this.updatedRows[b])break;return b},defineAction:function(a,b){if(!this._uActions)this._uActions=[];this._uActions[a]=b},afterUpdateCallback:function(a,b,c,d){var e=a,g=c!="error"&&c!="invalid";g||this.set_invalid(a,c);if(this._uActions&&
this._uActions[c]&&!this._uActions[c](d))return delete this._in_progress[e];this._in_progress[e]!="wait"&&this.setUpdated(a,!1);var h=a;switch(c){case "inserted":case "insert":b!=a&&(this.obj[this._methods[2]](a,b),a=b);break;case "delete":case "deleted":return this.obj.setUserData(a,this.action_param,"true_deleted"),this.obj[this._methods[3]](a),delete this._in_progress[e],this.callEvent("onAfterUpdate",[a,c,b,d])}this._in_progress[e]!="wait"?(g&&this.obj.setUserData(a,this.action_param,""),delete this._in_progress[e]):
(delete this._in_progress[e],this.setUpdated(b,!0,this.obj.getUserData(a,this.action_param)));this.callEvent("onAfterUpdate",[h,c,b,d])},afterUpdate:function(a,b,c,d,e){e.getXMLTopNode("data");if(e.xmlDoc.responseXML){for(var g=e.doXPath("//data/action"),h=0;h<g.length;h++){var f=g[h],i=f.getAttribute("type"),j=f.getAttribute("sid"),l=f.getAttribute("tid");a.afterUpdateCallback(j,l,i,f)}a.finalizeUpdate()}},finalizeUpdate:function(){this._waitMode&&this._waitMode--;(this.obj.mytype=="tree"||this.obj._h2)&&
this.updatedRows.length&&this.sendData();this.callEvent("onAfterUpdateFinish",[]);this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(a){this.obj=a;this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(a){this.attachEvent("onAfterUpdate",a)},enableDebug:function(){},setOnBeforeUpdateHandler:function(a){this.attachEvent("onBeforeDataSending",a)},setAutoUpdate:function(a,b){a=a||2E3;this._user=b||(new Date).valueOf();this._need_update=!1;this._loader=null;this._update_busy=
!1;this.attachEvent("onAfterUpdate",function(a,b,c,h){this.afterAutoUpdate(a,b,c,h)});this.attachEvent("onFullSync",function(){this.fullSync()});var c=this;window.setInterval(function(){c.loadUpdate()},a)},afterAutoUpdate:function(a,b){return b=="collision"?(this._need_update=!0,!1):!0},fullSync:function(){if(this._need_update==!0)this._need_update=!1,this.loadUpdate();return!0},getUpdates:function(a,b){if(this._update_busy)return!1;else this._update_busy=!0;this._loader=this._loader||new dtmlXMLLoaderObject(!0);
this._loader.async=!0;this._loader.waitCall=b;this._loader.loadXML(a)},_v:function(a){return a.firstChild?a.firstChild.nodeValue:""},_a:function(a){for(var b=[],c=0;c<a.length;c++)b[c]=this._v(a[c]);return b},loadUpdate:function(){var a=this,b=this.obj.getUserData(0,"version"),c=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+b].join("&"),c=c.replace("editing=true&","");this.getUpdates(c,function(){var b=a._loader.doXPath("//userdata");a.obj.setUserData(0,
"version",a._v(b[0]));var c=a._loader.doXPath("//update");if(c.length){a._silent_mode=!0;for(var g=0;g<c.length;g++){var h=c[g].getAttribute("status"),f=c[g].getAttribute("id"),i=c[g].getAttribute("parent");switch(h){case "inserted":a.callEvent("insertCallback",[c[g],f,i]);break;case "updated":a.callEvent("updateCallback",[c[g],f,i]);break;case "deleted":a.callEvent("deleteCallback",[c[g],f,i])}}a._silent_mode=!1}a._update_busy=!1;a=null})}};var globalActiveDHTMLGridObject;
String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(a){return dhtmlXHeir(a||[],dhtmlxArray._master)}
dhtmlxArray._master={_dhx_find:function(a){for(var b=0;b<this.length;b++)if(a==this[b])return b;return-1},_dhx_insertAt:function(a,b){this[this.length]=null;for(var c=this.length-1;c>=a;c--)this[c]=this[c-1];this[a]=b},_dhx_removeAt:function(a){this.splice(a,1)},_dhx_swapItems:function(a,b){var c=this[a];this[a]=this[b];this[b]=c}};
function dhtmlXGridObject(a){if(_isIE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(b){}if(a)if(typeof a=="object"){if(this.entBox=a,!this.entBox.id)this.entBox.id="cgrid2_"+this.uid()}else this.entBox=document.getElementById(a);else this.entBox=document.createElement("DIV"),this.entBox.id="cgrid2_"+this.uid();this.entBox.innerHTML="";dhtmlxEventable(this);var c=this;this._wcorr=0;this.fontWidth=7;this.row=this.cell=null;this.iconURL="";this.editor=null;this._dclE=this._f2kE=!0;this.combos=
[];this.defVal=[];this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=!0;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,!0,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?this.entBox.style.width||window.getComputedStyle(this.entBox,
null).width:this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0)||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?this.entBox.style.height||window.getComputedStyle(this.entBox,null).height:this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0)||"100%";
// MARIS
this.entBox.maxlength=this.entBox.getAttribute("maxlength");
// MARIS
this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return!1};var d=function(a){var b=document.createElement("TABLE");b.cellSpacing=
b.cellPadding=0;b.style.cssText="width:100%;table-layout:fixed;";b.className=a.substr(2);return b};this.obj=d("c_obj");this.hdr=d("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";dhtmlx.$customScroll&&dhtmlx.CustomScroll.enable(this);this.hdrBox=document.createElement("DIV");this.hdrBox.style.width=
"100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=[];this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=
[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=_isIE&&document.compatMode!="BackCompat"?22:20;this.imgURL=window.dhx_globalImgPath||"";this.isActive=!1;this.isEditable=!0;this.pagingOn=this.useImagesInHeader=!1;this.rowsBufferOutSize=0;

this.initCellmaxsize =[];
 	this.setCellmaxsize = function(wp){
 	this.initCellmaxsize = wp.split(this.delim.replace(/px/gi,""));
}
this.cellNumeric =[];
	this.setNumeric = function(wp){
	this.cellNumeric = wp.split(this.delim.replace(/px/gi,""));
}


dhtmlxEvent(window,
"unload",function(){try{c.destructor&&c.destructor()}catch(a){}});this.setSkin=function(a){this.skin_name=a;var b=this.entBox.className.split(" gridbox")[0];this.entBox.className=b+" gridbox gridbox_"+a;this.skin_h_correction=0;this.enableAlterCss("ev_"+a,"odd_"+a,this.isTreeGrid());this._fixAlterCss();switch(a){case "clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+
this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";this.skin_h_correction=20;break;case "dhx_terrace":this._srdh=40;this.forceDivInHeader=
!0;break;case "dhx_skyblue":case "dhx_web":case "glassy_blue":case "dhx_black":case "dhx_blue":case "modern":case "light":this._srdh=20;this.forceDivInHeader=!0;break;case "xp":this.forceDivInHeader=!0;this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "mt":this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case "gray":if(_isIE&&document.compatMode!="BackCompat")this._srdh=22}if(_isIE&&this.hdr){var c=this.hdr.parentNode;c.removeChild(this.hdr);c.appendChild(this.hdr)}this.setSizes()};
_isIE&&this.preventIECaching(!0);if(window.dhtmlDragAndDropObject)this.dragger=new dhtmlDragAndDropObject;this._doOnScroll=function(a,b){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(a,b)};this.doOnScroll=function(a,b){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr)this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft;if(!b&&this._srnd)this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dLoadTimer=window.setTimeout(function(){c._update_srnd_view&&
c._update_srnd_view()},100)};this.attachToObject=function(a){a.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(a){if(this.isTreeGrid()&&!this._h2){this._h2=new dhtmlxHierarchy;if(this._fake&&!this._realfake)this._fake._h2=this._h2;this._tgc={imgURL:null}}if(this._hstyles){this.editStop();this.fldSorted=this.r_fldSorted=this.resized=this.lastClicked=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0){var b=this.xmlFileUrl;this.clearAll(!0);
this.xmlFileUrl=b}for(var d=this.hdr.insertRow(0),f=0;f<this.hdrLabels.length;f++)d.appendChild(document.createElement("TH")),d.childNodes[f]._cellIndex=f,d.childNodes[f].style.height="0px";_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?d.style.position="absolute":d.style.height="auto";d=this.hdr.insertRow(_isKHTML?2:1);d._childIndexes=[];for(var i=0,f=0;f<this.hdrLabels.length;f++)d._childIndexes[f]=f-i,this.hdrLabels[f]==this.splitSign&&f!=0?(_isKHTML&&d.insertCell(f-i),d.cells[f-
i-1].colSpan=(d.cells[f-i-1].colSpan||1)+1,d.childNodes[f-i-1]._cellIndex++,i++,d._childIndexes[f]=f-i):(d.insertCell(f-i),d.childNodes[f-i]._cellIndex=f,d.childNodes[f-i]._cellIndexS=f,this.setColumnLabel(f,this.hdrLabels[f]));if(i==0)d._childIndexes=null;this._cCount=this.hdrLabels.length;_isIE&&window.setTimeout(function(){c.setSizes&&c.setSizes()},1);this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var j=this.obj.firstChild;if(!j.firstChild){j.appendChild(document.createElement("TR"));
j=j.firstChild;_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?j.style.position="absolute":j.style.height="auto";for(f=0;f<this.hdrLabels.length;f++)j.appendChild(document.createElement("TH")),j.childNodes[f].style.height="0px"}this._c_order=null;this.multiLine!=!0&&(this.obj.className+=" row20px");this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;this.noHeader?this.hdrBox.style.display="none":
this.noHeader=!1;this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();a&&this.parseXML();this.obj.scrollTop=0;this.dragAndDropOff&&this.dragger.addDragLanding(this.entBox,this);this._initDrF&&this._initD();this._init_point&&this._init_point()}};this.setColumnSizes=function(a){for(var b=0,c=[],d=0,i=0;i<this._cCount;i++)if(this.initCellWidth[i]=="*"&&!this._hrrar[i])this._awdth=!1,c.push(i);else{if(this.cellWidthType=="%"){typeof this.cellWidthPC[i]=="undefined"&&(this.cellWidthPC[i]=
this.initCellWidth[i]);var j=a*this.cellWidthPC[i]/100||0;d>0.5&&(j++,d--);var l=this.cellWidthPX[i]=Math.floor(j),d=d+j-l}else typeof this.cellWidthPX[i]=="undefined"&&(this.cellWidthPX[i]=this.initCellWidth[i]);this._hrrar[i]||(b+=this.cellWidthPX[i]*1)}if(c.length){var k=Math.floor((a-b)/c.length);k<0&&(k=1);for(i=0;i<c.length;i++){var m=Math.max(this._drsclmW?this._drsclmW[c[i]]||0:0,k);this.cellWidthPX[c[i]]=m;b+=m}if(a>b){var n=c[c.length-1];this.cellWidthPX[n]+=a-b;b=a}this._setAutoResize()}this.obj.style.width=
b+"px";this.hdr.style.width=b+"px";if(this.ftr)this.ftr.style.width=b+"px";this.chngCellWidth();return b};this.setSizes=function(){if(this.hdr.rows[0]){var a=this.quirks=_isIE&&document.compatMode=="BackCompat",b=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes)if(this.globalBox){var d=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var f=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=
Math.max(0,this.globalBox.clientWidth+(a?d*2:0)-this._fake.entBox.clientWidth)+"px";f!=this.globalBox.clientWidth&&this._fake._correctSplit(this._fake.entBox.clientWidth)}if(this._delta_y&&!this._realfake)this.globalBox.style.height=this._delta_y,this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden",this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(a?d*2:0)+"px"}else{if(this._delta_x)this.entBox.parentNode&&this.entBox.parentNode.tagName=="TD"?(this.entBox.style.width=
"1px",this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-b*2+"px"):this.entBox.style.width=this._delta_x;if(this._delta_y)this.entBox.style.height=this._delta_y}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth))this._sizeTime=window.setTimeout(function(){c.setSizes&&c.setSizes()},250);else{var i=!this._wthB&&(this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0,j=!this._wthB&&
(this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0;this._sizeFix&&(i-=this._sizeFix,j-=this._sizeFix);var l=this.parentGrid?!1:this.objBox.scrollHeight>this.objBox.offsetHeight,k=dhtmlx.$customScroll?0:18,m=this.entBox.clientWidth-(this.skin_h_correction||0)*(a?0:1)-i,n=this.entBox.clientWidth-(this.skin_h_correction||0)-i,o=this.entBox.clientHeight-j,q=this.setColumnSizes(n-(l?k:0)-(this._correction_x||0)),p=this.parentGrid?!1:this.objBox.scrollWidth>this.objBox.offsetWidth||
this.objBox.style.overflowX=="scroll",s=this.hdr.clientHeight,r=this.ftr?this.ftr.clientHeight:0,v=m,t=o-s-r;this._awdth&&this._awdth[0]&&this._awdth[1]==99999&&(p=0);if(this._ahgr&&(t=this._ahgrMA?this.entBox.parentNode.clientHeight-s-r:this.obj.offsetHeight+(p?k:0)+(this._correction_y||0),this._ahgrM&&(t=this._ahgrF?Math.min(this._ahgrM,t+s+r)-s-r:Math.min(this._ahgrM,t)),l&&t>=this.obj.scrollHeight+(p?k:0)))l=!1,this.setColumnSizes(n-(this._correction_x||0));if(this._awdth&&this._awdth[0]){if(this.cellWidthType==
"%")this.cellWidthType="px";this._fake&&(q+=this._fake.entBox.clientWidth);v=Math.min(Math.max(q+(l?k:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this._fake&&(v-=this._fake.entBox.clientWidth)}t=Math.max(0,t);this._ff_size_delta=this._ff_size_delta==0.1?0.2:0.1;if(!_isFF)this._ff_size_delta=0;if(!this.dontSetSizes)this.entBox.style.width=Math.max(0,v+(a?2:0)*b+this._ff_size_delta)+"px",this.entBox.style.height=t+(a?2:0)*b+s+r+"px";this.objBox.style.height=t+(a&&!l?2:0)*b+"px";this.hdrBox.style.height=
s+"px";t!=o&&this.doOnScroll(0,!this._srnd);var u=this["setSizes_"+this.skin_name];u&&u.call(this);this.setSortImgPos();s!=this.hdr.clientHeight&&this._ahgr&&this.setSizes();this.callEvent("onSetSizes",[])}}};this.setSizes_clear=function(){var a=this.hdr.offsetHeight,b=this.entBox.offsetWidth,c=a+this.objBox.offsetHeight;this._topMb.style.top=(a||0)+"px";this._topMb.style.width=b+20+"px";this._botMb.style.top=c-3+"px";this._botMb.style.width=b+20+"px"};this.chngCellWidth=function(){if(_isOpera&&this.ftr)this.ftr.width=
this.objBox.scrollWidth+"px";for(var a=this._cCount,b=0;b<a;b++)if(this.hdr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px",this.obj.rows[0].childNodes[b].style.width=this.cellWidthPX[b]+"px",this.ftr)this.ftr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px"};this.setDelimiter=function(a){this.delim=a};this.setInitWidthsP=function(a,b){this.cellWidthType="%";this.initCellWidth=a.split(this.delim.replace(/px/gi,""));b||this._setAutoResize()};this._setAutoResize=function(){if(!this._realfake){var a=
window,b=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(b._resize_timer);if(b._setAutoResize)b._resize_timer=window.setTimeout(function(){b.setSizes&&b.setSizes();b._fake&&b._fake._correctSplit()},100)})}};this.setInitWidths=function(a){this.cellWidthType="px";this.initCellWidth=a.split(this.delim);if(_isFF)for(var b=0;b<this.initCellWidth.length;b++)this.initCellWidth[b]!="*"&&(this.initCellWidth[b]=parseInt(this.initCellWidth[b]))};this.enableMultiline=function(a){this.multiLine=
convertStringToBoolean(a)};this.enableMultiselect=function(a){this.selMultiRows=convertStringToBoolean(a)};this.setImagesPath=this.setImagePath=function(a){this.imgURL=a};this.setIconsPath=this.setIconPath=function(a){this.iconURL=a};this.changeCursorState=function(a){var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.getFirstParentOfType(b,"TD"));if(b){if(b.tagName=="TD"&&this._drsclmn&&!this._drsclmn[b._cellIndex])return b.style.cursor="default";var c=(a.layerX||0)+(!_isIE&&a.target.tagName==
"DIV"?b.offsetLeft:0);b.style.cursor=b.offsetWidth-(a.offsetX||(parseInt(this.getPosition(b,this.hdrBox))-c)*-1)<(_isOpera?20:10)?"E-resize":"default";if(_isOpera)this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(a){this.resized&&this.stopColResize();this.resized=null;var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.getFirstParentOfType(b,"TD"));var d=a.clientX,f=this.hdr.offsetWidth,i=parseInt(b.offsetWidth);if(b.tagName=="TD"&&b.style.cursor!="default"&&(!this._drsclmn||
this._drsclmn[b._cellIndex]))c._old_d_mm=document.body.onmousemove,c._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(a){c&&c.doColResize(a||window.event,b,i,d,f)},document.body.onmouseup=function(){c&&c.stopColResize()}};this.stopColResize=function(){document.body.onmousemove=c._old_d_mm||"";document.body.onmouseup=c._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(a,b,c,d,i){b.style.cursor="E-resize";this.resized=
b;var j=c+(a.clientX-d),l=i+(a.clientX-d);if(this.callEvent("onResize",[b._cellIndex,j,this])){if(_isIE)this.objBox.scrollLeft=this.hdrBox.scrollLeft;if(b.colSpan>1){for(var k=[],m=0;m<b.colSpan;m++)k[m]=Math.round(j*this.hdr.rows[0].childNodes[b._cellIndexS+m].offsetWidth/b.offsetWidth);for(m=0;m<b.colSpan;m++)this._setColumnSizeR(b._cellIndexS+m*1,k[m])}else this._setColumnSizeR(b._cellIndex,j);this.doOnScroll(0,1);this.setSizes();this._fake&&this._awdth&&this._fake._correctSplit()}};this._setColumnSizeR=
function(a,b){if(b>(this._drsclmW&&!this._notresize?this._drsclmW[a]||10:10)){this.obj.rows[0].childNodes[a].style.width=b+"px";this.hdr.rows[0].childNodes[a].style.width=b+"px";if(this.ftr)this.ftr.rows[0].childNodes[a].style.width=b+"px";if(this.cellWidthType=="px")this.cellWidthPX[a]=b;else{var c=parseInt(this.entBox.offsetWidth);this.objBox.scrollHeight>this.objBox.offsetHeight&&(c-=17);var d=Math.round(b/c*100);this.cellWidthPC[a]=d}this.sortImg.style.display!="none"&&this.setSortImgPos()}};
this.setSortImgState=function(a,b,c,d){c=(c||"asc").toLowerCase();if(convertStringToBoolean(a)){this.sortImg.src=c=="asc"?this.imgURL+"sort_asc.gif":this.imgURL+"sort_desc.gif";this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[b];var i=this.hdr.rows[d||1];if(i){for(var j=0;j<i.childNodes.length;j++)if(i.childNodes[j]._cellIndexS==b)return this.r_fldSorted=i.childNodes[j],this.setSortImgPos();return this.setSortImgState(a,b,c,(d||1)+1)}}else this.sortImg.style.display="none",
this.fldSorted=this.r_fldSorted=null};this.setSortImgPos=function(a,b,c,d){if(!this._hrrar||!this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:a])if(d||(d=a?this.hdr.rows[c||0].cells[a]:this.r_fldSorted),d!=null){var i=this.getPosition(d,this.hdrBox),j=d.offsetWidth;this.sortImg.style.left=Number(i[0]+j-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(i[1]+5)+"px";if(!this.useImagesInHeader&&!b)this.sortImg.style.display="inline";this.sortImg.style.left=
this.sortImg.defLeft+"px"}};this.setActive=function(a){arguments.length==0&&(a=!0);a==!0?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.isActive=!0):(this.isActive=!1,this.callEvent("onBlur",[this]))};this._doClick=function(a){var b=0,c=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(c){var d=!0;if(this.markedCells){var i=
0;if(a.shiftKey||a.metaKey)i=1;a.ctrlKey&&(i=2);this.doMark(c,i);return!0}if(this.selMultiRows!=!1&&(a.shiftKey&&this.row!=null&&this.selectedRows.length&&(b=1),a.ctrlKey||a.metaKey))b=2;this.doClick(c,d,b)}};this._doContClick=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(!b||typeof b.parentNode.idd=="undefined")return this.callEvent("onEmptyClick",[a]),!0;if(a.button==2||_isMacOS&&a.ctrlKey){if(!this.callEvent("onRightClick",[b.parentNode.idd,b._cellIndex,a])){var c=
function(a){(a||event).cancelBubble=!0;return!1};(a.srcElement||a.target).oncontextmenu=c;return c(a)}if(this._ctmndx){if(!this.callEvent("onBeforeContextMenu",[b.parentNode.idd,b._cellIndex,this]))return!0;if(_isIE)a.srcElement.oncontextmenu=function(){event.cancelBubble=!0;return!1};if(this._ctmndx.showContextMenu){var d=window.document.documentElement,i=window.document.body,j=[d.scrollLeft||i.scrollLeft,d.scrollTop||i.scrollTop];if(_isIE)var l=a.clientX+j[0],k=a.clientY+j[1];else l=a.pageX,k=a.pageY;
this._ctmndx.showContextMenu(l-1,k-1);this.contextID=this._ctmndx.contextMenuZoneId=b.parentNode.idd+"_"+b._cellIndex;this._ctmndx._skip_hide=!0}else b.contextMenuId=b.parentNode.idd+"_"+b._cellIndex,b.contextMenu=this._ctmndx,b.a=this._ctmndx._contextStart,b.a(b,a),b.a=null;a.cancelBubble=!0;return!1}}else this._ctmndx&&(this._ctmndx.hideContextMenu?this._ctmndx.hideContextMenu():this._ctmndx._contextEnd());return!0};this.doClick=function(a,b,d,f){this.selMultiRows||(d=0);var i=this.row?this.row.idd:
0;this.setActive(!0);d||(d=0);if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,"");if(a.tagName=="TD"){if(this.checkEvent("onSelectStateChanged"))var j=this.getSelectedId();var l=this.row;if(d==1){var k=this.rowsCol._dhx_find(a.parentNode),m=this.rowsCol._dhx_find(this.lastClicked);if(k>m)var n=m,o=k;else n=k,o=m;for(var q=0;q<this.rowsCol.length;q++)if(q>=n&&q<=o)if(this.rowsCol[q]&&!this.rowsCol[q]._sRow)this.rowsCol[q].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",
[this.rowsCol[q].idd,i])&&(this.rowsCol[q].className+=" rowselected",this.selectedRows[this.selectedRows.length]=this.rowsCol[q]);else return this.clearSelection(),this.doClick(a,b,0,f)}else if(d==2&&a.parentNode.className.indexOf("rowselected")!=-1){a.parentNode.className=a.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(a.parentNode));var p=!0,f=!1}this.editStop();if(typeof a.parentNode.idd=="undefined")return!0;if(!p&&!a.parentNode._sRow)if(this.callEvent("onBeforeSelect",
[a.parentNode.idd,i]))if(this.getSelectedRowId()!=a.parentNode.idd){if(d==0&&this.clearSelection(),this.cell=a,l==a.parentNode&&this._chRRS&&(b=!1),this.row=a.parentNode,this.row.className+=" rowselected",this.selectedRows._dhx_find(this.row)==-1)this.selectedRows[this.selectedRows.length]=this.row}else this.cell=a,this.row=a.parentNode;else b=!1;if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1)this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected";
if(d!=1&&!this.row)return;this.lastClicked=a.parentNode;var s=this.row.idd,r=this.cell;b&&typeof s!="undefined"&&r&&!p?c.onRowSelectTime=setTimeout(function(){c.callEvent&&c.callEvent("onRowSelect",[s,r._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[s]);if(this.checkEvent("onSelectStateChanged")){var v=this.getSelectedId();j!=v&&this.callEvent("onSelectStateChanged",[v,j])}}this.isActive=!0;f!==!1&&this.cell&&this.cell.parentNode.idd&&this.moveToVisible(this.cell)};this.selectAll=function(){this.clearSelection();
var a=this.rowsBuffer;if(this.pagingOn)a=this.rowsCol;for(var b=0;b<a.length;b++)this.render_row(b).className+=" rowselected";this.selectedRows=dhtmlxArray([].concat(a));if(this.selectedRows.length)this.row=this.selectedRows[0],this.cell=this.row.cells[0];this._fake&&!this._realfake&&this._fake.selectAll()};this.selectCell=function(a,b,c,d,i,j){c||(c=!1);typeof a!="object"&&(a=this.render_row(a));if(!a||a==-1)return null;var l=a.childNodes[b];l||(l=a.childNodes[0]);this.markedCells?this.doMark(l,
d?2:0):d?this.doClick(l,c,3,j):this.doClick(l,c,0,j);i&&this.editCell()};this.moveToVisible=function(a,b){if(this.pagingOn){var c=Math.floor(this.getRowIndex(a.parentNode.idd)/this.rowsBufferOutSize)+1;c!=this.currentPage&&this.changePage(c)}try{if(a.offsetHeight){var d=a.offsetLeft+a.offsetWidth+20,i=0;d>this.objBox.offsetWidth+this.objBox.scrollLeft?a.offsetLeft>this.objBox.scrollLeft&&(i=a.offsetLeft-5):a.offsetLeft<this.objBox.scrollLeft&&(d-=a.offsetWidth*2/3,d<this.objBox.scrollLeft&&(i=a.offsetLeft-
5));if(i&&!b)this.objBox.scrollLeft=i}if(a.offsetHeight)d=a.offsetTop;else var j=this._realfake?this._fake.rowsAr[a.parentNode.idd]:a.parentNode,d=this.rowsBuffer._dhx_find(j)*this._srdh;var l=d+a.offsetHeight+38;if(l>this.objBox.offsetHeight+this.objBox.scrollTop)var k=d;else d<this.objBox.scrollTop&&(k=d-5);if(k)this.objBox.scrollTop=k}catch(m){}};this.editCell=function(){if(!(this.editor&&this.cell==this.editor.cell)){this.editStop();if(this.isEditable!=!0||!this.cell)return!1;var a=this.cell;
if(a.parentNode._locked)return!1;this.editor=this.cells4(a);if(this.editor!=null){if(this.editor.isDisabled())return this.editor=null,!1;this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=!1&&this.editor.edit?(this._Opera_stop=(new Date).valueOf(),a.className+=" editable",this.editor.edit(),this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}};this.editStop=function(a){if(_isOpera&&this._Opera_stop){if(this._Opera_stop*1+50>(new Date).valueOf())return;
this._Opera_stop=null}if(this.editor&&this.editor!=null)if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),a){var b=this.editor.val;this.editor.detach();this.editor.setValue(b);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,b])}else{if(this.editor.detach())this.cell.wasChanged=!0;var c=this.editor;this.editor=null;var d=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,c.getValue(),c.val]);if(typeof d=="string"||typeof d==
"number")c[c.setImage?"setLabel":"setValue"](d);else if(!d)c[c.setImage?"setLabel":"setValue"](c.val);this._ahgr&&this.multiLine&&this.setSizes()}};this._nextRowCell=function(a,b,c){a=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(a),b);return!a?null:a.childNodes[a._childIndexes?a._childIndexes[c]:c]};this._getNextCell=function(a,b,c){var a=a||this.cell,d=a.parentNode;this._tabOrder?(c=this._tabOrder[a._cellIndex],typeof c!="undefined"&&(a=c<0?this._nextRowCell(d,b,Math.abs(c)-
1):d.childNodes[c])):(c=a._cellIndex+b,c>=0&&c<this._cCount?(d._childIndexes&&(c=d._childIndexes[a._cellIndex]+b),a=d.childNodes[c]):a=this._nextRowCell(d,b,b==1?0:this._cCount-1));return!a?(b==1&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),b==-1&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null):a.style.display!="none"&&(!this.smartTabOrder||!this.cells(a.parentNode.idd,a._cellIndex).isDisabled())?a:this._getNextCell(a,b)};this._nextRow=
function(a,b){var c=this.render_row(a+b);return!c||c==-1?null:c&&c.style.display=="none"?this._nextRow(a+b,b):c};this.scrollPage=function(a){if(this.rowsBuffer.length){var b=this._realfake?this._fake:this,c=Math.floor((b._r_select||this.getRowIndex(this.row.idd)||0)+a*this.objBox.offsetHeight/(this._srdh||20));c<0&&(c=0);c>=this.rowsBuffer.length&&(c=this.rowsBuffer.length-1);if(this._srnd&&!this.rowsBuffer[c]){this.objBox.scrollTop+=Math.floor(a*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||
20);if(this._fake)this._fake.objBox.scrollTop=this.objBox.scrollTop;b._r_select=c}else{this.selectCell(c,this.cell._cellIndex,!0,!1,!1,this.multiLine||this._srnd);if(!this.multiLine&&!this._srnd&&!this._realfake&&(this.objBox.scrollTop=this.getRowById(this.getRowId(c)).offsetTop,this._fake))this._fake.objBox.scrollTop=this.objBox.scrollTop;b._r_select=null}}};
// MARIS
this.doKeyPress = function(ev){ 
	try{
		if ((this.initCellmaxsize[this.cell._cellIndex]) != 0){
				if (this.cellType[this.cell._cellIndex] != "amount" || this.cellType[this.cell._cellIndex] != "kxamount" ) {
					if ((this.initCellmaxsize[this.cell._cellIndex]) <= (ev.target||ev.srcElement).value.length)
						{
							ev.keyCode  = 0;
						}
				}
		}
	}catch(e){}
	try{
 		if ((this.cellUppercase[this.cell._cellIndex]) == 1){
 	       if (!((ev.keyCode>=97 && ev.keyCode<=122) || (ev.keyCode>=65 && ev.keyCode<=91) || (ev.keyCode>=48 && ev.keyCode<=57)|| (ev.keyCode== 13)))  { 
				ev.keyCode = 0;
				return;
		   }
		   if (ev.keyCode>= 97 && ev.keyCode<=122) {
				ev.keyCode = ev.keyCode - 32;
		   }
		}else if ((this.cellUppercase[this.cell._cellIndex]) == 2){
			if (!((ev.keyCode>=97 && ev.keyCode<=122) || (ev.keyCode>=65 && ev.keyCode<=91) || (ev.keyCode>=48 && ev.keyCode<=57)|| (ev.keyCode== 13)))	{
					return;
			}
			if (ev.keyCode>= 97 && ev.keyCode<=122)	{
				ev.keyCode = ev.keyCode - 32;
			}
		}
	}catch(e){}
	try{
		 	if ((this.cellNumeric[this.cell._cellIndex]) == 1)	{
		 		if (isNumeric(ev.keyCode) == false)	{
			 		ev.keyCode  = 0;
		 		}
		 	}else{
		 		if ((this.cellNumeric[this.cell._cellIndex]) == 2) {
				    if ((( ev.keyCode >= KEY_NUMBER_0) && (ev.keyCode <= KEY_NUMBER_9))  || ev.keyCode == KEY_DOT || ev.keyCode == KEY_MINUS ) {
					} else {
		     			 ev.keyCode =0;
					}
		        } else if ((this.cellNumeric[this.cell._cellIndex]) == 3){
		        	if(isNumeric(ev.keyCode) == false){
						ev.keyCode = 0;
					}else
		        	seperatorappendgrid(this);
		        }
			 }
	}catch(e){}
	return true;
}

this.doKey=function(a){if(!a)return!0;if((a.target||a.srcElement).value!==window.undefined){var b=a.target||a.srcElement;if(!b.parentNode||
b.parentNode.className.indexOf("editable")==-1)return!0}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(a);if(this.isActive==!1)return!0;if(this._htkebl)return!0;if(!this.callEvent("onKeyPress",[a.keyCode,a.ctrlKey,a.shiftKey,a]))return!1;var c="k"+a.keyCode+"_"+(a.ctrlKey?1:0)+"_"+(a.shiftKey?1:0);if(this.cell){if(this._key_events[c]){if(!1===this._key_events[c].call(this))return!0;a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}this._key_events.k_other&&
this._key_events.k_other.call(this,a)}return!0};this.selectRow=function(a,b,c,d){typeof a!="object"&&(a=this.render_row(a));this.selectCell(a,0,b,c,!1,d)};this.wasDblClicked=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(b){var c=b.parentNode.idd;return this.callEvent("onRowDblClicked",[c,b._cellIndex,a])}};this._onHeaderClick=function(a,b){var c=this.grid,b=b||c.getFirstParentOfType(_isIE?event.srcElement:a.target,"TD");if(this.grid.resized==null){if(!this.grid.callEvent("onHeaderClick",
[b._cellIndexS,a||window.event]))return!1;c.sortField(b._cellIndexS,!1,b)}this.grid.resized=null};this.deleteSelectedRows=function(){var a=this.selectedRows.length;if(a!=0){var b=this.selectedRows;this.selectedRows=dhtmlxArray();for(var c=a-1;c>=0;c--){var d=b[c];if(this.deleteRow(d.idd,d)){if(d==this.row)var i=c}else this.selectedRows[this.selectedRows.length]=d}if(i)try{i+1>this.rowsCol.length&&i--,this.selectCell(i,0,!0)}catch(j){this.cell=this.row=null}}};this.getSelectedRowId=function(){for(var a=
[],b={},c=0;c<this.selectedRows.length;c++){var d=this.selectedRows[c].idd;b[d]||(a[a.length]=d,b[d]=!0)}return a.length==0?null:a.join(this.delim)};this.getSelectedCellIndex=function(){return this.cell!=null?this.cell._cellIndex:-1};this.getColWidth=function(a){return parseInt(this.cellWidthPX[a])};this.setColWidth=function(a,b){if(b=="*")this.initCellWidth[a]="*";else{if(this._hrrar[a])return;this.cellWidthType=="px"?this.cellWidthPX[a]=parseInt(b):this.cellWidthPC[a]=parseInt(b)}this.setSizes()};
this.getRowIndex=function(a){for(var b=0;b<this.rowsBuffer.length;b++)if(this.rowsBuffer[b]&&this.rowsBuffer[b].idd==a)return b;return-1};this.getRowId=function(a){return this.rowsBuffer[a]?this.rowsBuffer[a].idd:this.undefined};this.setRowId=function(a,b){this.changeRowId(this.getRowId(a),b)};this.changeRowId=function(a,b){if(a!=b){var c=this.rowsAr[a];c.idd=b;this.UserData[a]&&(this.UserData[b]=this.UserData[a],this.UserData[a]=null);if(this._h2&&this._h2.get[a])this._h2.get[b]=this._h2.get[a],
this._h2.get[b].id=b,delete this._h2.get[a];this.rowsAr[a]=null;this.rowsAr[b]=c;for(var d=0;d<c.childNodes.length;d++)if(c.childNodes[d]._code)c.childNodes[d]._code=this._compileSCL(c.childNodes[d]._val,c.childNodes[d]);if(this._mat_links&&this._mat_links[a]){var i=this._mat_links[a];delete this._mat_links[a];for(var j in i)for(d=0;d<i[j].length;d++)this._compileSCL(i[j][d].original,i[j][d])}this.callEvent("onRowIdChange",[a,b])}};this.setColumnIds=function(a){this.columnIds=a.split(this.delim)};
this.setColumnId=function(a,b){this.columnIds[a]=b};this.getColIndexById=function(a){for(var b=0;b<this.columnIds.length;b++){if(this.columnIds[b]==a)return b}};this.getColumnId=function(a){return this.columnIds[a]};this.getColLabel=this.getColumnLabel=function(a,b,c){for(var d=(c||this.hdr).rows[(b||0)+1],i=0;i<d.cells.length;i++)if(d.cells[i]._cellIndexS==a)return _isIE?d.cells[i].innerText:d.cells[i].textContent;return""};this.getFooterLabel=function(a,b){return this.getColumnLabel(a,b,this.ftr)};
this.setRowTextBold=function(a){var b=this.getRowById(a);if(b)b.style.fontWeight="bold"};this.setRowTextStyle=function(a,b){var c=this.getRowById(a);if(c)for(var d=0;d<c.childNodes.length;d++){var i=c.childNodes[d]._attrs.style||"";c.childNodes[d].style.cssText=i+"width:"+c.childNodes[d].style.width+";"+b}};this.setRowColor=function(a,b){for(var c=this.getRowById(a),d=0;d<c.childNodes.length;d++)c.childNodes[d].bgColor=b};this.setCellTextStyle=function(a,b,c){var d=this.getRowById(a);if(d){var i=
d.childNodes[d._childIndexes?d._childIndexes[b]:b];if(i){var j="";i.style.cssText=j+"width:"+i.style.width+";"+c}}};this.setRowTextNormal=function(a){var b=this.getRowById(a);if(b)b.style.fontWeight="normal"};this.doesRowExist=function(a){return this.getRowById(a)!=null?!0:!1};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(a){var b=this.getRowById(a);if(this.isTreeGrid())return this.moveRowUDTG(a,-1);var c=this.rowsCol._dhx_find(b);if(b.previousSibling&&c!=0){b.parentNode.insertBefore(b,
b.previousSibling);this.rowsCol._dhx_swapItems(c,c-1);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d-1);this._cssEven&&this._fixAlterCss(c-1)}};this.moveRowDown=function(a){var b=this.getRowById(a);if(this.isTreeGrid())return this.moveRowUDTG(a,1);var c=this.rowsCol._dhx_find(b);if(b.nextSibling){this.rowsCol._dhx_swapItems(c,c+1);b.nextSibling.nextSibling?b.parentNode.insertBefore(b,b.nextSibling.nextSibling):b.parentNode.appendChild(b);this.setSizes();var d=
this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d+1);this._cssEven&&this._fixAlterCss(c)}};this.getCombo=function(a){this.combos[a]||(this.combos[a]=new dhtmlXGridComboObject);return this.combos[a]};this.setUserData=function(a,b,c){a||(a="gridglobaluserdata");this.UserData[a]||(this.UserData[a]=new Hashtable);this.UserData[a].put(b,c)};this.getUserData=function(a,b){a||(a="gridglobaluserdata");this.getRowById(a);var c=this.UserData[a];return c?c.get(b):""};this.setEditable=function(a){this.isEditable=
convertStringToBoolean(a)};this.selectRowById=function(a,b,c,d){d||(d=!1);this.selectCell(this.getRowById(a),0,d,b,!1,c)};this.clearSelection=function(){this.editStop();for(var a=0;a<this.selectedRows.length;a++){var b=this.rowsAr[this.selectedRows[a].idd];if(b)b.className=b.className.replace(/rowselected/g,"")}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=null;this.callEvent("onSelectionCleared",[])};
this.copyRowContent=function(a,b){var c=this.getRowById(a);if(this.isTreeGrid())this._copyTreeGridRowContent(c,a,b);else for(var d=0;d<c.cells.length;d++)this.cells(b,d).setValue(this.cells(a,d).getValue());if(!_isIE)this.getRowById(a).cells[0].height=c.cells[0].offsetHeight};this.setFooterLabel=function(a,b,c){return this.setColumnLabel(a,b,c,this.ftr)};this.setColumnLabel=function(a,b,c,d){var i=(d||this.hdr).rows[c||1],j=i._childIndexes?i._childIndexes[a]:a;if(i.cells[j]){if(this.useImagesInHeader){i.cells[j].style.textAlign=
"left";i.cells[j].innerHTML="<img src='"+this.imgURL+""+b+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var l=new Image;l.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=l;var k=new Image;k.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=k}else{var m="<div class='hdrcell'>";if(b.indexOf("img:[")!=-1){var n=b.replace(/.*\[([^>]+)\].*/,"$1"),b=b.substr(b.indexOf("]")+1,b.length);
m+="<img width='18px' height='18px' align='absmiddle' src='"+n+"' hspace='2'>"}m+=b;m+="</div>";i.cells[j].innerHTML=m;if(this._hstyles[j])i.cells[j].style.cssText=this._hstyles[j]}if((b||"").indexOf("#")!=-1){var o=b.match(/(^|{)#([^}]+)(}|$)/);if(o){var q="_in_header_"+o[2];if(this[q])this[q](this.forceDivInHeader?i.cells[j].firstChild:i.cells[j],j,b.split(o[0]))}}}};this.setColLabel=function(a,b,c,d){return this.setColumnLabel(a,b,(c||0)+1,d)};this.clearAll=function(a){if(this.obj.rows[0]){if(this._h2&&
(this._h2=new dhtmlxHierarchy,this._fake))this._realfake?this._h2=this._fake._h2:this._fake._h2=this._h2;this.limit=this._limitC=0;this.editStop(!0);this._dLoadTimer&&window.clearTimeout(this._dLoadTimer);if(this._dload)this.objBox.scrollTop=0,this.limit=this._limitC||0,this._initDrF=!0;for(var b=this.rowsCol.length,b=this.obj.rows.length,c=b-1;c>0;c--){var d=this.obj.rows[c];d.parentNode.removeChild(d)}if(a){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(c=this.hdr.rows.length-
1;c>=0;c--)d=this.hdr.rows[c],d.parentNode.removeChild(d);if(this.ftr)this.ftr.parentNode.removeChild(this.ftr),this.ftr=null;this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._strangeParams=[];this.defVal=[];this._ivizcol=null}this.cell=this.row=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd)this.xmlFileUrl=
"";this.pagingOn&&this.changePage(1);this._contextCallTimer&&window.clearTimeout(this._contextCallTimer);this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;this.setSortImgState(!1);this.setSizes();this.callEvent("onClearAll",[])}};this.sortField=function(a,b,c){if(this.getRowsNum()==0)return!1;var d=this.hdr.rows[0].cells[a];if(d&&d.tagName=="TH"&&this.fldSort.length-1>=d._cellIndex&&this.fldSort[d._cellIndex]!="na"){var i=this.getSortingState(),j=i[0]==a&&i[1]=="asc"?"des":"asc";
if(this.callEvent("onBeforeSorting",[a,this.fldSort[a],j])){this.sortImg.src=this.imgURL+"sort_"+(j=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var l=this.hdr.rows[1].cells[d._cellIndex].firstChild;if(this.fldSorted!=null){var k=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;k.src=k.src.replace(/(\.asc\.)|(\.des\.)/,".")}l.src=l.src.replace(/(\.[a-z]+)$/,"."+j+"$1")}this.sortRows(d._cellIndex,this.fldSort[d._cellIndex],j);this.fldSorted=d;this.r_fldSorted=c;var m=this.hdr.rows[1],
m=c.parentNode,n=m._childIndexes?m._childIndexes[d._cellIndex]:d._cellIndex;this.setSortImgPos(!1,!1,!1,c)}}};this.enableHeaderImages=function(a){this.useImagesInHeader=a};this.setHeader=function(a,b,c){for(var d=typeof a!="object"?this._eSplit(a):[].concat(a),i=[],j=new dhtmlxArray(0),l=[],k=[],m=[],n=0;n<d.length;n++)i[i.length]=Math.round(100/d.length),j[j.length]="ed",l[l.length]="left",k[k.length]="middle",m[m.length]="na";this.splitSign=b||"#cspan";this.hdrLabels=d;this.cellWidth=i;this.initCellWidth.length||
this.setInitWidthsP(i.join(this.delim),!0);this.cellType=j;this.cellAlign=l;this.cellVAlign=k;this.fldSort=m;this._hstyles=c||[]};this._eSplit=function(a){if(![].push)return a.split(this.delim);var b="r"+(new Date).valueOf(),c=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(a||"").replace(RegExp(c,"g"),b).replace(RegExp("\\\\"+b,"g"),this.delim).split(b)};this.getColType=function(a){return this.cellType[a]};this.getColTypeById=function(a){return this.cellType[this.getColIndexById(a)]};this.setColTypes=
function(a){this.cellType=dhtmlxArray(a.split(this.delim));this._strangeParams=[];for(var b=0;b<this.cellType.length;b++){if(this.cellType[b].indexOf("[")!=-1){var c=this.cellType[b].split(/[\[\]]+/g);this.cellType[b]=c[0];this.defVal[b]=c[1];c[1].indexOf("=")==0&&(this.cellType[b]="math",this._strangeParams[b]=c[0])}window["eXcell_"+this.cellType[b]]||dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[b],[this,this.cellType[b]])}};this.setColSorting=function(a){this.fldSort=
a.split(this.delim)};this.setColAlign=function(a){this.cellAlign=a.split(this.delim);for(var b=0;b<this.cellAlign.length;b++)this.cellAlign[b]=this.cellAlign[b]._dhx_trim()};this.setColVAlign=function(a){this.cellVAlign=a.split(this.delim)};this.setNoHeader=function(a){this.noHeader=convertStringToBoolean(a)};this.showRow=function(a){this.getRowById(a);this._h2&&this.openItem(this._h2.get[a].parent.id);for(var b=this.getRowById(a).childNodes[0];b&&b.style.display=="none";)b=b.nextSibling;b&&this.moveToVisible(b,
!0)};this.setStyle=function(a,b,c,d){this.ssModifier=[a,b,c,c,d];for(var i=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],j=0;!_isIE;){try{var l=document.styleSheets[j].cssRules.length}catch(k){j++;continue}break}for(var m=0;m<i.length;m++)this.ssModifier[m]&&(_isIE?document.styleSheets[0].addRule(i[m],this.ssModifier[m]):
document.styleSheets[j].insertRule(i[m]+(" { "+this.ssModifier[m]+" }"),document.styleSheets[j].cssRules.length))};this.setColumnColor=function(a){this.columnColor=a.split(this.delim)};this.enableAlterCss=function(a,b,c,d){(a||b)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();this._fake&&this._fake._fixAlterCss()});this._cssSP=c;this._cssSU=d;this._cssEven=a;this._cssUnEven=b};this._fixAlterCss=function(a){if(this._h2&&(this._cssSP||this._cssSU))return this._fixAlterCssTGR(a);
if(this._cssEven||this._cssUnEven)for(var b=a=a||0,c=a;c<this.rowsCol.length;c++)if(this.rowsCol[c]&&this.rowsCol[c].style.display!="none")this.rowsCol[c]._cntr?b=1:(this.rowsCol[c].className=this.rowsCol[c].className.indexOf("rowselected")!=-1?b%2==1?this._cssUnEven+" rowselected "+(this.rowsCol[c]._css||""):this._cssEven+" rowselected "+(this.rowsCol[c]._css||""):b%2==1?this._cssUnEven+" "+(this.rowsCol[c]._css||""):this._cssEven+" "+(this.rowsCol[c]._css||""),b++)};this.getPosition=function(a,
b){if(!b){var c=getOffset(a);return[c.left,c.top]}for(var b=b||document.body,d=a,i=0,j=0;d&&d!=b;)i+=d.offsetLeft-d.scrollLeft,j+=d.offsetTop-d.scrollTop,d=d.offsetParent;b==document.body&&(_isIE?(j+=document.body.offsetTop||document.documentElement.offsetTop,i+=document.body.offsetLeft||document.documentElement.offsetLeft):_isFF||(i+=document.body.offsetLeft,j+=document.body.offsetTop));return[i,j]};this.getFirstParentOfType=function(a,b){for(;a&&a.tagName!=b&&a.tagName!="BODY";)a=a.parentNode;return a};
this.objBox.onscroll=function(){this.grid._doOnScroll()};this.objBox.ontouchend=function(){this.hdrBox.scrollLeft=this.objBox.scrollLeft};this.hdrBox.onscroll=function(){if(!this._try_header_sync){this._try_header_sync=!0;if(this.grid.objBox.scrollLeft!=this.scrollLeft)this.grid.objBox.scrollLeft=this.scrollLeft;this._try_header_sync=!1}};if(!_isOpera||_OperaRv>8.5)this.hdr.onmousemove=function(a){this.grid.changeCursorState(a||window.event)},this.hdr.onmousedown=function(a){return this.grid.startColResize(a||
window.event)};this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(a){(a||event).cancelBubble=!0};this.obj.onclick=function(a){this.grid._doClick(a||window.event);this.grid._sclE?this.grid.editCell(a||window.event):this.grid.editStop();(a||event).cancelBubble=!0};_isMacOS?this.entBox.oncontextmenu=function(a){a.cancelBubble=!0;a.returnValue=!1;var b=this.grid;if(b._realfake)b=b._fake;return b._doContClick(a||window.event)}:(this.entBox.onmousedown=function(a){return this.grid._doContClick(a||
window.event)},this.entBox.oncontextmenu=function(a){if(this.grid._ctmndx)(a||event).cancelBubble=!0;return!this.grid._ctmndx});this.obj.ondblclick=function(a){if(!this.grid.wasDblClicked(a||window.event))return!1;if(this.grid._dclE){var b=this.grid.getFirstParentOfType(_isIE?event.srcElement:a.target,"TR");b==this.grid.row&&this.grid.editCell(a||window.event)}(a||event).cancelBubble=!0;if(_isOpera)return!1};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){c._onHeaderClick.apply({grid:c},
[null,c.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;

if(!document.body._dhtmlxgrid_onkeypress)dhtmlxEvent(document,"keypress",function(a){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKeyPress(a||window.event)}),document.body._dhtmlxgrid_onkeypress=!0;

if(!document.body._dhtmlxgrid_onkeydown)dhtmlxEvent(document,"keydown",function(a){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(a||window.event)}),document.body._dhtmlxgrid_onkeydown=!0;dhtmlxEvent(document.body,"click",function(){c.editStop&&c.editStop();c.isActive&&c.setActive(!1)});if(this.entBox.style.height.toString().indexOf("%")!=-1)this._delta_y=this.entBox.style.height;if(this.entBox.style.width.toString().indexOf("%")!=
-1)this._delta_x=this.entBox.style.width;(this._delta_x||this._delta_y)&&this._setAutoResize();this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;
this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path);dhtmlx.skin&&this.setSkin(dhtmlx.skin);return this}
dhtmlXGridObject.prototype={getRowAttribute:function(a,b){return this.getRowById(a)._attrs[b]},setRowAttribute:function(a,b,c){this.getRowById(a)._attrs[b]=c},isTreeGrid:function(){return this.cellType._dhx_find("tree")!=-1},setRowHidden:function(a,b){var c=convertStringToBoolean(b),d=this.getRowById(a);if(d){d.expand===""&&this.collapseKids(d);if(b&&d.style.display!="none"){d.style.display="none";var e=this.selectedRows._dhx_find(d);if(e!=-1){d.className=d.className.replace("rowselected","");for(var g=
0;g<d.childNodes.length;g++)d.childNodes[g].className=d.childNodes[g].className.replace(/cellselected/g,"");this.selectedRows._dhx_removeAt(e)}this.callEvent("onGridReconstructed",[])}if(!b&&d.style.display=="none")d.style.display="",this.callEvent("onGridReconstructed",[]);this.callEvent("onRowHide",[a,b]);this.setSizes()}},enableRowsHover:function(a,b){this._unsetRowHover(!1,!0);this._hvrCss=b;if(convertStringToBoolean(a)){if(!this._elmnh)this.obj._honmousemove=this.obj.onmousemove,this.obj.onmousemove=
this._setRowHover,_isIE?this.obj.onmouseleave=this._unsetRowHover:this.obj.onmouseout=this._unsetRowHover,this._elmnh=!0}else if(this._elmnh)this.obj.onmousemove=this.obj._honmousemove,_isIE?this.obj.onmouseleave=null:this.obj.onmouseout=null,this._elmnh=!1},enableEditEvents:function(a,b,c){this._sclE=convertStringToBoolean(a);this._dclE=convertStringToBoolean(b);this._f2kE=convertStringToBoolean(c)},enableLightMouseNavigation:function(a){if(convertStringToBoolean(a)){if(!this._elmn)this.entBox._onclick=
this.entBox.onclick,this.entBox.onclick=function(){return!0},this.obj._onclick=this.obj.onclick,this.obj.onclick=function(a){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(c)this.grid.editStop(),this.grid.doClick(c),this.grid.editCell(),(a||event).cancelBubble=!0},this.obj._onmousemove=this.obj.onmousemove,this.obj.onmousemove=this._autoMoveSelect,this._elmn=!0}else if(this._elmn)this.entBox.onclick=this.entBox._onclick,this.obj.onclick=this.obj._onclick,this.obj.onmousemove=
this.obj._onmousemove,this._elmn=!1},_unsetRowHover:function(a,b){that=b?this:this.grid;if(that._lahRw&&that._lahRw!=b){for(var c=0;c<that._lahRw.childNodes.length;c++)that._lahRw.childNodes[c].className=that._lahRw.childNodes[c].className.replace(that._hvrCss,"");that._lahRw=null}},_setRowHover:function(a){var b=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(b&&b.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,b);b=b.parentNode;if(!b.idd||b.idd=="__filler__")return;
for(var c=0;c<b.childNodes.length;c++)b.childNodes[c].className+=" "+this.grid._hvrCss;this.grid._lahRw=b}this._honmousemove(a)},_autoMoveSelect:function(a){if(!this.grid.editor){var b=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");b.parentNode.idd&&this.grid.doClick(b,!0,0)}this._onmousemove(a)},destructor:function(){this.editStop(!0);if(this._sizeTime)this._sizeTime=window.clearTimeout(this._sizeTime);this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs)for(var a=
0;a<this.formInputs.length;a++)this.parentForm.removeChild(this.formInputs[a]);var b;this.xmlLoader=this.xmlLoader.destructor();for(a=0;a<this.rowsCol.length;a++)if(this.rowsCol[a])this.rowsCol[a].grid=null;for(a in this.rowsAr)this.rowsAr[a]&&(this.rowsAr[a]=null);this.rowsCol=new dhtmlxArray;this.rowsAr={};this.entBox.innerHTML="";var c=function(){};this.setSizes=this._update_srnd_view=this.callEvent=this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=
this.entBox.onbeforedeactivate=this.entBox.onselectstart=c;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;if(this._fake)this.globalBox.innerHTML="",this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=c,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=c;for(b in this){if(this[b]&&this[b].m_obj)this[b].m_obj=null;this[b]=
null}this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null);return null},getSortingState:function(){var a=[];if(this.fldSorted)a[0]=this.fldSorted._cellIndex,a[1]=this.sortImg.src.indexOf("sort_desc.gif")!=-1?"des":"asc";return a},enableAutoHeight:function(a,b,c){this._ahgr=convertStringToBoolean(a);this._ahgrF=convertStringToBoolean(c);this._ahgrM=b||null;if(arguments.length==1)this.objBox.style.overflowY=a?"hidden":"auto";if(b=="auto")this._ahgrM=null,this._ahgrMA=!0,this._setAutoResize()},
enableStableSorting:function(a){this._sst=convertStringToBoolean(a);this.rowsCol.stablesort=function(a){for(var c=this.length-1,d=0;d<this.length-1;d++){for(var e=0;e<c;e++)if(a(this[e],this[e+1])>0){var g=this[e];this[e]=this[e+1];this[e+1]=g}c--}}},enableKeyboardSupport:function(a){this._htkebl=!convertStringToBoolean(a)},enableContextMenu:function(a){this._ctmndx=a},setScrollbarWidthCorrection:function(){},enableTooltips:function(a){this._enbTts=a.split(",");for(var b=0;b<this._enbTts.length;b++)this._enbTts[b]=
convertStringToBoolean(this._enbTts[b])},enableResizing:function(a){this._drsclmn=a.split(",");for(var b=0;b<this._drsclmn.length;b++)this._drsclmn[b]=convertStringToBoolean(this._drsclmn[b])},setColumnMinWidth:function(a,b){if(arguments.length==2){if(!this._drsclmW)this._drsclmW=[];this._drsclmW[b]=a}else this._drsclmW=a.split(",")},enableCellIds:function(a){this._enbCid=convertStringToBoolean(a)},lockRow:function(a,b){var c=this.getRowById(a);if(c)c._locked=convertStringToBoolean(b),this.cell&&
this.cell.parentNode.idd==a&&this.editStop()},_getRowArray:function(a){for(var b=[],c=0;c<a.childNodes.length;c++){var d=this.cells3(a,c);b[c]=d.getValue()}return b},_launchCommands:function(a){for(var b=0;b<a.length;b++){for(var c=[],d=0;d<a[b].childNodes.length;d++)if(a[b].childNodes[d].nodeType==1)c[c.length]=a[b].childNodes[d].firstChild.data;this[a[b].getAttribute("command")].apply(this,c)}},_parseHead:function(a){var b=this.xmlLoader.doXPath("./head",a);if(b.length){var c=this.xmlLoader.doXPath("./column",
b[0]),d=this.xmlLoader.doXPath("./settings",b[0]),e="setInitWidths",g=!1;if(d[0])for(var h=0;h<d[0].childNodes.length;h++)switch(d[0].childNodes[h].tagName){case "colwidth":d[0].childNodes[h].firstChild&&d[0].childNodes[h].firstChild.data=="%"&&(e="setInitWidthsP");break;case "splitat":g=d[0].childNodes[h].firstChild?d[0].childNodes[h].firstChild.data:!1}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",b[0]));if(c.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var f=[[],[],
[],[],[],[],[],[],[]],i=",width,type,align,sort,color,format,hidden,id".split(","),j=["",e,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],l=0;l<c.length;l++){for(var k=1;k<i.length;k++)f[k].push(c[l].getAttribute(i[k]));f[0].push((c[l].firstChild?c[l].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(f[0]);for(l=0;l<j.length;l++)if(j[l])this[j[l]](f[l].join(this.delim));for(l=0;l<c.length;l++)if(this.cellType[l].indexOf("co")==0||this.cellType[l]==
"clist"){var m=this.xmlLoader.doXPath("./option",c[l]);if(m.length){var n=[];if(this.cellType[l]=="clist"){for(k=0;k<m.length;k++)n[n.length]=m[k].firstChild?m[k].firstChild.data:"";this.registerCList(l,n)}else for(var o=this.getCombo(l),k=0;k<m.length;k++)o.put(m[k].getAttribute("value"),m[k].firstChild?m[k].firstChild.data:"")}}else f[6][l]&&(this.cellType[l].toLowerCase().indexOf("calendar")!=-1||this.fldSort[l]=="date"?this.setDateFormat(f[6][l]):this.setNumberFormat(f[6][l],l));this.init();var q=
f[7].join(this.delim);this.setColHidden&&q.replace(/,/g,"")!=""&&this.setColHidden(q);g&&this.splitAt&&this.splitAt(g)}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",b[0]))}var p=this.xmlLoader.doXPath("//rows/userdata",a);if(p.length>0){this.UserData.gridglobaluserdata||(this.UserData.gridglobaluserdata=new Hashtable);for(k=0;k<p.length;k++){for(var s="",r=0;r<p[k].childNodes.length;r++)s+=p[k].childNodes[r].nodeValue;this.UserData.gridglobaluserdata.put(p[k].getAttribute("name"),
s)}}},getCheckedRows:function(a){var b=[];this.forEachRowA(function(c){this.cells(c,a).getValue()!=0&&b.push(c)},!0);return b.join(",")},checkAll:function(){for(var a=arguments.length?arguments[0]:1,b=0;b<this.getColumnsNum();b++)this.getColType(b)=="ch"&&this.setCheckedRows(b,a)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(a,b){this.forEachRowA(function(c){this.cells(c,a).isCheckbox()&&this.cells(c,a).setValue(b)})},_drawTooltip:function(a){var b=this.grid.getFirstParentOfType(a?
a.target:event.srcElement,"TD");if(!b||this.grid.editor&&this.grid.editor.cell==b)return!0;var c=b.parentNode;if(c.idd&&c.idd!="__filler__"){var d=a?a.target:event.srcElement;if(c.idd==window.unknown)return!0;if(!this.grid.callEvent("onMouseOver",[c.idd,b._cellIndex,a||window.event]))return!0;if(this.grid._enbTts&&!this.grid._enbTts[b._cellIndex]){if(d.title)d.title="";return!0}if(!(b._cellIndex>=this.grid._cCount)){var e=this.grid.cells3(c,b._cellIndex);if(e&&e.cell&&e.cell._attrs){if(d._title)e.cell.title=
"";if(!e.cell._attrs.title)d._title=!0;if(e)d.title=e.cell._attrs.title||(e.getTitle?e.getTitle():(e.getValue()||"").toString().replace(/<[^>]*>/gi,""));return!0}}}},enableCellWidthCorrection:function(a){if(_isFF)this._wcorr=parseInt(a)},getAllRowIds:function(a){for(var b=[],c=0;c<this.rowsBuffer.length;c++)this.rowsBuffer[c]&&b.push(this.rowsBuffer[c].idd);return b.join(a||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},preventIECaching:function(a){this.no_cashe=convertStringToBoolean(a);
this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(a){this._eCAS=convertStringToBoolean(a)},_onHeaderDblClick:function(a){var b=this.grid,c=b.getFirstParentOfType(_isIE?event.srcElement:a.target,"TD");if(!b._eCAS)return!1;b.adjustColumnSize(c._cellIndexS)},adjustColumnSize:function(a,b){if(!this._hrrar||!this._hrrar[a]){this._notresize=!0;var c=0;this._setColumnSizeR(a,20);for(var d=1;d<this.hdr.rows.length;d++){var e=this.hdr.rows[d];if((e=e.childNodes[e._childIndexes?e._childIndexes[a]:
a])&&(!e.colSpan||e.colSpan<2)&&e._cellIndex==a)e.childNodes[0]&&e.childNodes[0].className=="hdrcell"&&(e=e.childNodes[0]),c=Math.max(c,e.scrollWidth)}for(var g=this.obj.rows.length,h=1;h<g;h++){var f=this.obj.rows[h];this.rowsAr[f.idd]&&!(f._childIndexes&&f._childIndexes[a]!=a)&&f.childNodes[a]&&(f=_isFF||_isOpera||b?f.childNodes[a].textContent.length*this.fontWidth:f.childNodes[a].scrollWidth,f>c&&(c=f))}c+=20+(b||0);this._setColumnSizeR(a,c);this._notresize=!1;this.setSizes()}},detachHeader:function(a,
b){var b=b||this.hdr,c=b.rows[a+1];c&&c.parentNode.removeChild(c);this.setSizes()},detachFooter:function(a){this.detachHeader(a,this.ftr)},attachHeader:function(a,b,c){typeof a=="string"&&(a=this._eSplit(a));typeof b=="string"&&(b=b.split(this.delim));c=c||"_aHead";if(this.hdr.rows.length)if(a)this._createHRow([a,b],this[c=="_aHead"?"hdr":"ftr"]);else{if(this[c])for(var d=0;d<this[c].length;d++)this.attachHeader.apply(this,this[c][d])}else this[c]||(this[c]=[]),this[c][this[c].length]=[a,b,c]},_createHRow:function(a,
b){if(!b){if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";var c=document.createElement("DIV");c.className="ftr";this.entBox.appendChild(c);var d=document.createElement("TABLE");d.cellPadding=d.cellSpacing=0;if(!_isIE||_isIE==8)d.width="100%",d.style.paddingRight="20px";d.style.marginRight="20px";d.style.tableLayout="fixed";c.appendChild(d);d.appendChild(document.createElement("TBODY"));this.ftr=b=d;for(var e=d.insertRow(0),g=this.hdrLabels.length<=1?a[0].length:this.hdrLabels.length,
h=0;h<g;h++)e.appendChild(document.createElement("TH")),e.childNodes[h]._cellIndex=h;_isIE&&_isIE<8?e.style.position="absolute":e.style.height="auto"}var f=a[1],c=document.createElement("TR");b.rows[0].parentNode.appendChild(c);for(h=0;h<a[0].length;h++)if(a[0][h]=="#cspan"){var i=c.cells[c.cells.length-1];i.colSpan=(i.colSpan||1)+1}else if(a[0][h]=="#rspan"&&b.rows.length>1){for(var j=b.rows.length-2,l=!1,i=null;!l;){for(var i=b.rows[j],k=0;k<i.cells.length;k++)if(i.cells[k]._cellIndex==h){l=k+1;
break}j--}i=i.cells[l-1];i.rowSpan=(i.rowSpan||1)+1}else{var m=document.createElement("TD");m._cellIndex=m._cellIndexS=h;if(this._hrrar&&this._hrrar[h]&&!_isIE)m.style.display="none";if(typeof a[0][h]=="object")m.appendChild(a[0][h]);else if(m.innerHTML=this.forceDivInHeader?"<div class='hdrcell'>"+(a[0][h]||"&nbsp;")+"</div>":a[0][h]||"&nbsp;",(a[0][h]||"").indexOf("#")!=-1)if(d=a[0][h].match(/(^|{)#([^}]+)(}|$)/)){var n="_in_header_"+d[2];if(this[n])this[n](this.forceDivInHeader?m.firstChild:m,
h,a[0][h].split(d[0]))}if(f)m.style.cssText=f[h];c.appendChild(m)}var o=b;if(_isKHTML)b._kTimer&&window.clearTimeout(b._kTimer),b._kTimer=window.setTimeout(function(){b.rows[1].style.display="none";window.setTimeout(function(){b.rows[1].style.display=""},1)},500)},forEachRow:function(a){for(var b in this.rowsAr)this.rowsAr[b]&&this.rowsAr[b].idd&&a.apply(this,[this.rowsAr[b].idd])},forEachRowA:function(a){for(var b=0;b<this.rowsBuffer.length;b++)this.rowsBuffer[b]&&a.call(this,this.render_row(b).idd)},
forEachCell:function(a,b){var c=this.getRowById(a);if(c)for(var d=0;d<this._cCount;d++)b(this.cells3(c,d),d)},enableAutoWidth:function(a,b,c){this._awdth=[convertStringToBoolean(a),parseInt(b||99999),parseInt(c||0)];if(arguments.length==1)this.objBox.style.overflowX=a?"hidden":"auto"},updateFromXML:function(a,b,c,d){typeof b=="undefined"&&(b=!0);this._refresh_mode=[!0,b,c];this.load(a,d)},_refreshFromXML:function(a){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree)eXcell_tree.prototype.setValueX=
eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.valTag?this.setLabel(a):this.setValueX(a)};var b=this.cellType._dhx_find("tree");a.getXMLTopNode("rows");var c=a.doXPath("//rows")[0].getAttribute("parent")||0,d={};this._refresh_mode[2]&&(b!=-1?this._h2.forEachChild(c,function(a){d[a.id]=!0},this):this.forEachRow(function(a){d[a]=!0}));for(var e=a.doXPath("//row"),g=0;g<e.length;g++){var h=e[g],f=h.getAttribute("id");
d[f]=!1;c=h.parentNode.getAttribute("id")||c;if(this.rowsAr[f]&&this.rowsAr[f].tagName!="TR")this._h2?this._h2.get[f].buff.data=h:this.rowsBuffer[this.getRowIndex(f)].data=h,this.rowsAr[f]=h;else if(this.rowsAr[f])this._process_xml_row(this.rowsAr[f],h,-1),this._postRowProcessing(this.rowsAr[f],!0);else if(this._refresh_mode[1]){var i={idd:f,data:h,_parser:this._process_xml_row,_locator:this._get_xml_data},j=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(i),j=0):this.rowsBuffer.push(i);
if(this._h2)reset=!0,this._h2.add(f,h.parentNode.getAttribute("id")||h.parentNode.getAttribute("parent")).buff=this.rowsBuffer[this.rowsBuffer.length-1];this.rowsAr[f]=h;h=this.render_row(j);this._insertRowAt(h,j?-1:0)}}if(this._refresh_mode[2])for(f in d)d[f]&&this.rowsAr[f]&&this.deleteRow(f);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;reset&&this._renderSort();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.filterByAll()},getCustomCombo:function(a,
b){var c=this.cells(a,b).cell;if(!c._combo)c._combo=new dhtmlXGridComboObject;return c._combo},setTabOrder:function(a){var b=a.split(this.delim);this._tabOrder=[];for(var c=this._cCount||a.length,d=0;d<c;d++)b[d]={c:parseInt(b[d]),ind:d};b.sort(function(a,b){return a.c>b.c?1:-1});for(d=0;d<c;d++)this._tabOrder[b[d].ind]=!b[d+1]||typeof b[d].c=="undefined"?(b[0].ind+1)*-1:b[d+1].ind},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{/* MARIS- *//*
																																																																																																																								 * k13_1_0:function(){var
																																																																																																																								 * a=this.rowsCol._dhx_find(this.row);
																																																																																																																								 * this.selectCell(this.rowsCol[a+1],this.cell._cellIndex,!0)},k13_0_1:function(){var
																																																																																																																								 * a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a-1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[!0]))return!0;var
																																																																																																																								 * a=this._getNextCell(null,1);if(a)this.selectCell(a.parentNode,a._cellIndex,this.row!=a.parentNode,
																																																																																																																								 * !1,!0),this._still_active=!0},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[!1]))return!1;var
																																																																																																																								 * a=this._getNextCell(null,-1);if(a)this.selectCell(a.parentNode,a._cellIndex,this.row!=a.parentNode,!1,!0),this._still_active=!0},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var
																																																																																																																								 * a=this.cells4(this.cell);if(!a.changeState||a.changeState()===!1)return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},
																																																																																																																								 * k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(!this.editor&&this.isTreeGrid())this.collapseKids(this.row);else
																																																																																																																								 * return!1},k39_0_0:function(){if(!this.editor&&this.isTreeGrid())this.expandKids(this.row);else
																																																																																																																								 * return!1},k40_0_0:function(){var
																																																																																																																								 * a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var
																																																																																																																								 * b=Math.max(a._r_select||0,this.getRowIndex(this.row.idd)),c=this._nextRow(b,
																																																																																																																								 * 1);if(c)a._r_select=null,this.selectCell(c,this.cell._cellIndex,!0),a.pagingOn&&a.showRow(c.idd);else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[]);this.pagingOn&&this.rowsCol[b+1]&&this.selectCell(b+1,0,!0)}}this._still_active=!0},k38_0_0:function(){var
																																																																																																																								 * a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var
																																																																																																																								 * b=this.getRowIndex(this.row.idd)+1;if(b!=-1&&(!this.pagingOn||b!=1)){var
																																																																																																																								 * c=this._nextRow(b-
																																																																																																																								 * 1,-1);this.selectCell(c,this.cell._cellIndex,!0);a.pagingOn&&c&&a.showRow(c.idd)}else
																																																																																																																								 * this._key_events.k33_0_0.apply(this,[])}this._still_active=!0}
																																																																																																																								 */
// key_ctrl_shift

k9_0_0:function(){this.editStop();this.callEvent("onTab",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k9_0_1:function(){this.editStop();this.callEvent("onShiftTab",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k13_0_0:function(){this.editStop();this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k32_0_0:function(){var a=this.cells4(this.cell);if(!a.changeState||a.changeState()===!1)return!1},k27_0_0:function(){this.editStop(!0)},
k112_0_0:function(){this.editStop();this.callEvent("onF1",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k113_0_0:function(){this.editStop();this.callEvent("onF2",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k114_0_0:function(){this.editStop();this.callEvent("onF3",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k115_0_0:function(){this.editStop();this.callEvent("onF4",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k116_0_0:function(){this.editStop();this.callEvent("onF5",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k117_0_0:function(){this.editStop();this.callEvent("onF6",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k118_0_0:function(){this.editStop();this.callEvent("onF7",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k119_0_0:function(){this.editStop();this.callEvent("onF8",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k120_0_0:function(){this.editStop();this.callEvent("onF9",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k121_0_0:function(){this.editStop();this.callEvent("onF10",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k122_0_0:function(){this.editStop();this.callEvent("onF11",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},
k123_0_0:function(){this.editStop();this.callEvent("onF12",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},

k40_0_0:function(){var a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var b=Math.max(a._r_select||0,this.getRowIndex(this.row.idd)),c=this._nextRow(b,1);if(c)a._r_select=null,this.selectCell(c,this.cell._cellIndex,!0),a.pagingOn&&a.showRow(c.idd);else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[]);this.pagingOn&&this.rowsCol[b+1]&&this.selectCell(b+1,0,!0)}}this._still_active=!0},
k38_0_0:function(){var a=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var b=this.getRowIndex(this.row.idd)+1;if(b!=-1&&(!this.pagingOn||b!=1)){var c=this._nextRow(b-1,-1);this.selectCell(c,this.cell._cellIndex,!0);a.pagingOn&&c&&a.showRow(c.idd)}else this._key_events.k33_0_0.apply(this,[])}this._still_active=!0}





},/* VENKATESAN N-CHN-19-JUN-2014-BEG */attachFooter:function(a,c){this.attachHeader(a,c,"_aFoot")},/*
																									 * VENKATESAN
																									 * N-CHN-19-JUN-2014-END
																									 */_build_master_row:function(){for(var a=document.createElement("DIV"),b=["<table><tr>"],c=0;c<this._cCount;c++)b.push("<td></td>");b.push("</tr></table>");a.innerHTML=b.join("");this._master_row=a.firstChild.rows[0]},_prepareRow:function(a){this._master_row||this._build_master_row();for(var b=this._master_row.cloneNode(!0),c=0;c<b.childNodes.length;c++){b.childNodes[c]._cellIndex=
c;if(this._enbCid)b.childNodes[c].id="c_"+a+"_"+c;this.dragAndDropOff&&this.dragger.addDraggableItem(b.childNodes[c],this)}b.idd=a;b.grid=this;return b},_process_jsarray_row:function(a,b){a._attrs={};for(var c=0;c<a.childNodes.length;c++)a.childNodes[c]._attrs={};this._fillRow(a,this._c_order?this._swapColumns(b):b);return a},_get_jsarray_data:function(a,b){return a[b]},_process_json_row:function(a,b){b=this._c_order?this._swapColumns(b.data):b.data;return this._process_some_row(a,b)},_process_some_row:function(a,
b){a._attrs={};for(var c=0;c<a.childNodes.length;c++)a.childNodes[c]._attrs={};this._fillRow(a,b);return a},_get_json_data:function(a,b){return a.data[b]},_process_js_row:function(a,b){for(var c=[],d=0;d<this.columnIds.length;d++)c[d]=b[this.columnIds[d]],!c[d]&&c[d]!==0&&(c[d]="");this._process_some_row(a,c);a._attrs=b;return a},_get_js_data:function(a,b){return a[this.columnIds[b]]},_process_csv_row:function(a,b){a._attrs={};for(var c=0;c<a.childNodes.length;c++)a.childNodes[c]._attrs={};this._fillRow(a,
this._c_order?this._swapColumns(b.split(this.csv.cell)):b.split(this.csv.cell));return a},_get_csv_data:function(a,b){return a.split(this.csv.cell)[b]},_process_store_row:function(a,b){for(var c=[],d=0;d<this.columnIds.length;d++)c[d]=b[this.columnIds[d]];for(var e=0;e<a.childNodes.length;e++)a.childNodes[e]._attrs={};a._attrs=b;this._fillRow(a,c)},

/*
 * _process_xml_row:function(a,b){var
 * c=this.xmlLoader.doXPath(this.xml.cell,b),d=[];a._attrs=this._xml_attrs(b);if(this._ud_enabled)for(var
 * e=this.xmlLoader.doXPath("./userdata", b),g=e.length-1;g>=0;g--){for(var
 * h="",f=0;f<e[g].childNodes.length;f++)h+=e[g].childNodes[f].nodeValue;this.setUserData(a.idd,e[g].getAttribute("name"),h)}for(f=0;f<c.length;f++){var
 * i=c[this._c_order?this._c_order[f]:f];if(i){var
 * j=a._childIndexes?a._childIndexes[f]:f,l=i.getAttribute("type");if(a.childNodes[j]){if(l)a.childNodes[j]._cellType=l;a.childNodes[j]._attrs=this._xml_attrs(i)}i.getAttribute("xmlcontent")||(i=i.firstChild?i.firstChild.data:"");d.push(i)}}for(;f<a.childNodes.length;f++)a.childNodes[f]._attrs=
 * {};a.parentNode&&a.parentNode.tagName=="row"&&(a._attrs.parent=a.parentNode.getAttribute("idd"));this._fillRow(a,d);return
 * a}
 */
_process_xml_row:function(a,b){var d=[];if(b.firstChild.tagName == "cell"){var c=this.xmlLoader.doXPath(this.xml.cell,b);a._attrs=this._xml_attrs(b);if(this._ud_enabled)for(var e=this.xmlLoader.doXPath("./userdata",
b),g=e.length-1;g>=0;g--){for(var h="",f=0;f<e[g].childNodes.length;f++)h+=e[g].childNodes[f].nodeValue;this.setUserData(a.idd,e[g].getAttribute("name"),h)}for(f=0;f<c.length;f++){var i=c[this._c_order?this._c_order[f]:f];if(i){var j=a._childIndexes?a._childIndexes[f]:f,l=i.getAttribute("type");if(a.childNodes[j]){if(l)a.childNodes[j]._cellType=l;a.childNodes[j]._attrs=this._xml_attrs(i)}i.getAttribute("xmlcontent")||(i=i.firstChild?i.firstChild.data:"");d.push(i)}}for(;f<a.childNodes.length;f++)a.childNodes[f]._attrs=
{};a.parentNode&&a.parentNode.tagName=="row"&&(a._attrs.parent=a.parentNode.getAttribute("idd"));this._fillRow(a,d);return a;}
else{for (var idx = 0 ; idx < b.childNodes.length ; idx++){
var c=this.xmlLoader.doXPath(this.xml.cell+idx,b);a._attrs=this._xml_attrs(b);if(this._ud_enabled)for(var e=this.xmlLoader.doXPath("./userdata",
b),g=e.length-1;g>=0;g--){for(var h="",f=0;f<e[g].childNodes.length;f++)h+=e[g].childNodes[f].nodeValue;this.setUserData(a.idd,e[g].getAttribute("name"),h)}for(f=0;f<c.length;f++){var i=c[this._c_order?this._c_order[f]:f];if(i){var j=a._childIndexes?a._childIndexes[f]:f,l=i.getAttribute("type");if(a.childNodes[j]){if(l)a.childNodes[j]._cellType=l;a.childNodes[j]._attrs=this._xml_attrs(i)}i.getAttribute("xmlcontent")||(i=i.firstChild?i.firstChild.data:"");d.push(i)}}for(;f<a.childNodes.length;f++)a.childNodes[f]._attrs=
{};a.parentNode&&a.parentNode.tagName=="row"&&(a._attrs.parent=a.parentNode.getAttribute("idd"));}this._fillRow(a,d);return a;
}
}

,_get_xml_data:function(a,b){for(a=a.firstChild;;){if(!a)return"";a.tagName=="cell"&&b--;if(b<0)break;a=a.nextSibling}return a.firstChild?a.firstChild.data:""},_fillRow:function(a,b){this.editor&&this.editStop();for(var c=0;c<a.childNodes.length;c++)if(c<b.length||this.defVal[c]){var d=a.childNodes[c]._cellIndex,e=b[d],g=this.cells4(a.childNodes[c]);if(this.defVal[d]&&(e==""||
typeof e=="undefined"))e=this.defVal[d];g&&g.setValue(e)}else a.childNodes[c].innerHTML="&nbsp;",a.childNodes[c]._clearCell=!0;return a},_postRowProcessing:function(a,b){if(a._attrs["class"])a._css=a.className=a._attrs["class"];if(a._attrs.locked)a._locked=!0;if(a._attrs.bgColor)a.bgColor=a._attrs.bgColor;for(var c=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d],g=e._cellIndex,h=e._attrs.style||a._attrs.style;h&&(e.style.cssText+=";"+h);if(e._attrs["class"])e.className=e._attrs["class"];if(h=
e._attrs.align||this.cellAlign[g])e.align=h;e.vAlign=e._attrs.valign||this.cellVAlign[g];var f=e._attrs.bgColor||this.columnColor[g];if(f)e.bgColor=f;e._attrs.colspan&&!b&&(this.setColspan(a.idd,d+c,e._attrs.colspan),c+=e._attrs.colspan-1);if(this._hrrar&&this._hrrar[g]&&!b)e.style.display="none"}this.callEvent("onRowCreated",[a.idd,a,null])},load:function(a,b,c){this.callEvent("onXLS",[this]);arguments.length==2&&typeof b!="function"&&(c=b,b=null);c=c||"xml";if(!this.xmlFileUrl)this.xmlFileUrl=a;
this._data_type=c;this.xmlLoader.onloadAction=function(a,e,g,h,f){a.callEvent&&(f=a["_process_"+c](f),a._contextCallTimer||a.callEvent("onXLE",[a,0,0,f]),b&&(b(),b=null))};this.xmlLoader.loadXML(a)},loadXML:function(a,b){this.load(a,b,"xml")},parse:function(a,b,c){arguments.length==2&&typeof b!="function"&&(c=b,b=null);this._data_type=c=c||"xml";a=this["_process_"+c](a);this._contextCallTimer||this.callEvent("onXLE",[this,0,0,a]);b&&b()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",
row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(a){var b={};if(a.attributes.length)for(var c=0;c<a.attributes.length;c++)b[a.attributes[c].name]=a.attributes[c].value;return b},_process_xml:function(a){if(!a.doXPath){var b=new dtmlXMLLoaderObject(function(){});typeof a=="string"?b.loadXMLString(a):(b.xmlDoc=a.responseXML?a:{},b.xmlDoc.responseXML=a);a=b}if(this._refresh_mode)return this._refreshFromXML(a);this._parsing=!0;var c=a.getXMLTopNode(this.xml.top);if(c.tagName==this.xml.top){var d=
c.getAttribute("dhx_security");if(d)dhtmlx.security_key=d;this._parseHead(c);var e=a.doXPath(this.xml.row,c),g=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),h=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0),h=Math.min(h,32E6/this._srdh),f=!1;h&&h!=this.rowsBuffer.length&&(this.rowsBuffer[h-1]||(this.rowsBuffer.length&&(f=!0),this.rowsBuffer[h-1]=null),h<this.rowsBuffer.length&&(this.rowsBuffer.splice(h,this.rowsBuffer.length-h),f=!0));if(this.isTreeGrid())return this._process_tree_xml(a);
for(var i=0;i<e.length;i++)if(!this.rowsBuffer[i+g]){var j=e[i].getAttribute("id")||i+g+1;this.rowsBuffer[i+g]={idd:j,data:e[i],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[j]=e[i]}this.callEvent("onDataReady",[]);if(f&&this._srnd){var l=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=l}else this.render_dataset();this._parsing=!1;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc}},_process_jsarray:function(a){this._parsing=!0;if(a&&a.xmlDoc)eval("dhtmlx.temp="+
a.xmlDoc.responseText+";"),a=dhtmlx.temp;for(var b=0;b<a.length;b++){var c=b+1;this.rowsBuffer.push({idd:c,data:a[b],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[c]=a[b]}this.render_dataset();this._parsing=!1},_process_csv:function(a){this._parsing=!0;if(a.xmlDoc)a=a.xmlDoc.responseText;a=a.replace(/\r/g,"");a=a.split(this.csv.row);if(this._csvHdr){this.clearAll();var b=a.splice(0,1)[0].split(this.csv.cell);this._csvAID||b.splice(0,1);this.setHeader(b.join(this.delim));
this.init()}for(var c=0;c<a.length;c++)if(a[c]||c!=a.length-1){if(this._csvAID){var d=c+1;this.rowsBuffer.push({idd:d,data:a[c],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var e=a[c].split(this.csv.cell),d=e.splice(0,1)[0];this.rowsBuffer.push({idd:d,data:e,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[d]=a[c]}this.render_dataset();this._parsing=!1},_process_js:function(a){return this._process_json(a,"js")},_process_json:function(a,b){this._parsing=
!0;if(a&&a.xmlDoc)eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp;if(b=="js"){if(a.data)a=a.data;for(var c=0;c<a.length;c++){var d=a[c],e=d.id||c+1;this.rowsBuffer.push({idd:e,data:d,_parser:this._process_js_row,_locator:this._get_js_data});this.rowsAr[e]=a[c]}}else for(c=0;c<a.rows.length;c++)e=a.rows[c].id,this.rowsBuffer.push({idd:e,data:a.rows[c],_parser:this._process_json_row,_locator:this._get_json_data}),this.rowsAr[e]=a.rows[c];if(a.dhx_security)dhtmlx.security_key=a.dhx_security;
this.render_dataset();this._parsing=!1},render_dataset:function(a,b){if(this._srnd){if(this._fillers)return this._update_srnd_view();b=Math.min(this._get_view_size()+(this._srnd_pr||0),this.rowsBuffer.length)}this.pagingOn?(a=Math.max(a||0,(this.currentPage-1)*this.rowsBufferOutSize),b=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)):(a=a||0,b=b||this.rowsBuffer.length);for(var c=a;c<b;c++){var d=this.render_row(c);if(d==-1){if(this.xmlFileUrl&&this.callEvent("onDynXLS",[c,
this._dpref?this._dpref:b-c]))this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+c+"&count="+(this._dpref?this._dpref:b-c),this._data_type);b=c;break}if(!d.parentNode||!d.parentNode.tagName)if(this._insertRowAt(d,c),d._attrs.selected||d._attrs.select)this.selectRow(d,d._attrs.call?!0:!1,!0),d._attrs.selected=d._attrs.select=null;if(this._ads_count&&c-a==this._ads_count){var e=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){e._contextCallTimer=
null;e.render_dataset(c,b);if(!e._contextCallTimer)e._context_parsing?e.callEvent("onXLE",[]):e._fixAlterCss(),e.callEvent("onDistributedEnd",[]),e._context_parsing=!1},this._ads_time)}}if(this._srnd&&!this._fillers){var g=this.rowsBuffer.length-b;for(this._fillers=[];g>0;){var h=_isIE||window._FFrv?Math.min(g,5E4):g,f=this._add_filler(b,h);f&&this._fillers.push(f);g-=h;b+=h}}this.setSizes()},render_row:function(a){if(!this.rowsBuffer[a])return-1;if(this.rowsBuffer[a]._parser){var b=this.rowsBuffer[a];
if(this.rowsAr[b.idd]&&this.rowsAr[b.idd].tagName=="TR")return this.rowsBuffer[a]=this.rowsAr[b.idd];var c=this._prepareRow(b.idd);this.rowsBuffer[a]=c;this.rowsAr[b.idd]=c;b._parser.call(this,c,b.data);this._postRowProcessing(c);return c}return this.rowsBuffer[a]},_get_cell_value:function(a,b,c){return a._locator?(this._c_order&&(b=this._c_order[b]),a._locator.call(this,a.data,b)):this.cells3(a,b)[c?c:"getValue"]()},sortRows:function(a,b,c){c=(c||"asc").toLowerCase();b=b||this.fldSort[a];a=a||0;
if(this.isTreeGrid())this.sortTreeRows(a,b,c);else{var d={},e=this.cellType[a],g="getValue";e=="link"&&(g="getContent");if(e=="dhxCalendar"||e=="dhxCalendarA")g="getDate";for(var h=0;h<this.rowsBuffer.length;h++)d[this.rowsBuffer[h].idd]=this._get_cell_value(this.rowsBuffer[h],a,g);this._sortRows(a,b,c,d)}this.callEvent("onAfterSorting",[a,b,c])},_sortCore:function(a,b,c,d,e){var g="sort";if(this._sst)e.stablesort=this.rowsCol.stablesort,g="stablesort";if(b=="str")e[g](function(a,b){return c=="asc"?
d[a.idd]>d[b.idd]?1:d[a.idd]<d[b.idd]?-1:0:d[a.idd]<d[b.idd]?1:d[a.idd]>d[b.idd]?-1:0});else if(b=="int")e[g](function(a,b){var e=parseFloat(d[a.idd]),e=isNaN(e)?-99999999999999:e,g=parseFloat(d[b.idd]),g=isNaN(g)?-99999999999999:g;return c=="asc"?e-g:g-e});else if(b=="date")e[g](function(a,b){var e=Date.parse(d[a.idd])||Date.parse("01/01/1900"),g=Date.parse(d[b.idd])||Date.parse("01/01/1900");return c=="asc"?e-g:g-e})},_sortRows:function(a,b,c,d){this._sortCore(a,b,c,d,this.rowsBuffer);this._reset_view();
this.callEvent("onGridReconstructed",[])},_reset_view:function(a){if(this.obj.rows[0]){this._lahRw&&this._unsetRowHover(0,!0);this.callEvent("onResetView",[]);var b=this.obj.rows[0].parentNode,c=b.removeChild(b.childNodes[0],!0);if(_isKHTML)for(var d=b.parentNode.childNodes.length-1;d>=0;d--)b.parentNode.childNodes[d].tagName=="TR"&&b.parentNode.removeChild(b.parentNode.childNodes[d],!0);else if(_isIE)for(d=b.childNodes.length-1;d>=0;d--)b.childNodes[d].removeNode(!0);else b.innerHTML="";b.appendChild(c);
this.rowsCol=dhtmlxArray();this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;a||this.render_dataset()}},deleteRow:function(a,b){b||(b=this.getRowById(a));if(b){this.editStop();if(!this._realfake&&this.callEvent("onBeforeRowDeleted",[a])==!1)return!1;var c=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake)c=this._h2.get[a].parent.id,this._removeTrGrRow(b);else{b.parentNode&&b.parentNode.removeChild(b);var d=this.rowsCol._dhx_find(b);d!=-1&&this.rowsCol._dhx_removeAt(d);for(var e=
0;e<this.rowsBuffer.length;e++)if(this.rowsBuffer[e]&&this.rowsBuffer[e].idd==a){this.rowsBuffer._dhx_removeAt(e);d=e;break}}this.rowsAr[a]=null;for(e=0;e<this.selectedRows.length;e++)this.selectedRows[e].idd==a&&this.selectedRows._dhx_removeAt(e);if(this._srnd){for(e=0;e<this._fillers.length;e++){var g=this._fillers[e];g&&this._update_fillers(e,g[1]>=d?-1:0,g[0]>=d?-1:0)}this._update_srnd_view()}this.pagingOn&&this.changePage();this._realfake||this.callEvent("onAfterRowDeleted",[a,c]);this.callEvent("onGridReconstructed",
[]);this._ahgr&&this.setSizes();return!0}},_addRow:function(a,b,c){if(c==-1||typeof c=="undefined")c=this.rowsBuffer.length;typeof b=="string"&&(b=b.split(this.delim));var d=this._prepareRow(a);d._attrs={};for(var e=0;e<d.childNodes.length;e++)d.childNodes[e]._attrs={};this.rowsAr[d.idd]=d;if(this._h2)this._h2.get[d.idd].buff=d;this._fillRow(d,b);this._postRowProcessing(d);if(this._skipInsert)return this._skipInsert=!1,this.rowsAr[d.idd]=d;if(this.pagingOn)return this.rowsBuffer._dhx_insertAt(c,d),
this.rowsAr[d.idd]=d;if(this._fillers){this.rowsCol._dhx_insertAt(c,null);this.rowsBuffer._dhx_insertAt(c,d);this._fake&&this._fake.rowsCol._dhx_insertAt(c,null);this.rowsAr[d.idd]=d;for(var g=!1,h=0;h<this._fillers.length;h++){var f=this._fillers[h];if(f&&f[0]<=c&&f[0]+f[1]>=c){f[1]+=1;var i=f[2].firstChild.style.height=parseInt(f[2].firstChild.style.height)+this._srdh+"px",g=!0;if(this._fake)this._fake._fillers[h][1]++,this._fake._fillers[h][2].firstChild.style.height=i}f&&f[0]>c&&(f[0]+=1,this._fake&&
this._fake._fillers[h][0]++)}g||this._fillers.push(this._add_filler(c,1,c==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.rowsCol[1]}:this.rowsCol[c-1]));return d}this.rowsBuffer._dhx_insertAt(c,d);return this._insertRowAt(d,c)},addRow:function(a,b,c){var d=this._addRow(a,b,c);this.dragContext||this.callEvent("onRowAdded",[a]);this.pagingOn&&this.changePage(this.currentPage);this._srnd&&this._update_srnd_view();d._added=!0;this._ahgr&&this.setSizes();this.callEvent("onGridReconstructed",
[]);return d},_insertRowAt:function(a,b,c){this.rowsAr[a.idd]=a;if(this._skipInsert)return this._skipInsert=!1,a;if(b<0||!b&&parseInt(b)!==0)b=this.rowsCol.length;else if(b>this.rowsCol.length)b=this.rowsCol.length;if(this._cssEven){var d=a.className.replace(this._cssUnEven,"");a.className+=(this._cssSP?this.getLevel(a.idd):b)%2==1?d+" "+this._cssUnEven+(this._cssSU?" "+this._cssUnEven+"_"+this.getLevel(a.idd):""):d+" "+this._cssEven+(this._cssSU?" "+this._cssEven+"_"+this.getLevel(a.idd):"")}c||
(b==this.obj.rows.length-1||!this.rowsCol[b]?_isKHTML?this.obj.appendChild(a):this.obj.firstChild.appendChild(a):this.rowsCol[b].parentNode.insertBefore(a,this.rowsCol[b]));this.rowsCol._dhx_insertAt(b,a);this.callEvent("onRowInserted",[a,b]);return a},getRowById:function(a){var b=this.rowsAr[a];if(b){if(b.tagName!="TR"){for(var c=0;c<this.rowsBuffer.length;c++)if(this.rowsBuffer[c]&&this.rowsBuffer[c].idd==a)return this.render_row(c);if(this._h2)return this.render_row(null,b.idd)}return b}return null},
cellById:function(a,b){return this.cells(a,b)},cells:function(a,b){if(arguments.length==0)return this.cells4(this.cell);else var c=this.getRowById(a);var d=c._childIndexes?c.childNodes[c._childIndexes[b]]:c.childNodes[b];!d&&c._childIndexes&&(d=c.firstChild||{});return this.cells4(d)},cellByIndex:function(a,b){return this.cells2(a,b)},cells2:function(a,b){var c=this.render_row(a),d=c._childIndexes?c.childNodes[c._childIndexes[b]]:c.childNodes[b];!d&&c._childIndexes&&(d=c.firstChild||{});return this.cells4(d)},
cells3:function(a,b){var c=a._childIndexes?a.childNodes[a._childIndexes[b]]:a.childNodes[b];return this.cells4(c)},cells4:function(a){var b=window["eXcell_"+(a._cellType||this.cellType[a._cellIndex])];if(b)return new b(a)},cells5:function(a,b){b=b||a._cellType||this.cellType[a._cellIndex];if(!this._ecache[b]){var c=window["eXcell_"+b]?window["eXcell_"+b]:eXcell_ro;this._ecache[b]=new c(a)}this._ecache[b].cell=a;return this._ecache[b]},dma:function(a){if(!this._ecache)this._ecache={};if(a&&!this._dma)this._dma=
this.cells4,this.cells4=this.cells5;else if(!a&&this._dma)this.cells4=this._dma,this._dma=null},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(a){this.smartTabOrder=arguments.length>0?convertStringToBoolean(a):!0},setExternalTabOrder:function(a,b){var c=this;this.tabStart=typeof a=="object"?a:document.getElementById(a);var d=this.tabStart.onkeydown;this.tabStart.onkeydown=function(a){d&&d.call(this,a);var b=a||window.event;if(b.keyCode==9&&!b.shiftKey)return b.cancelBubble=
!0,c.selectCell(0,0,0,0,1),c.smartTabOrder&&c.cells2(0,0).isDisabled()&&c._key_events.k9_0_0.call(c),this.blur(),!1};if(_isOpera)this.tabStart.onkeypress=this.tabStart.onkeydown;this.tabEnd=typeof b=="object"?b:document.getElementById(b);var e=this.tabEnd.onkeydown;this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(a){e&&e.call(this,a);var b=a||window.event;if(b.keyCode==9&&b.shiftKey)return b.cancelBubble=!0,c.selectCell(c.getRowsNum()-1,c.getColumnCount()-1,0,0,1),c.smartTabOrder&&c.cells2(c.getRowsNum()-
1,c.getColumnCount()-1).isDisabled()&&c._key_events.k9_0_1.call(c),this.blur(),!1};if(_isOpera)this.tabEnd.onkeypress=this.tabEnd.onkeydown},uid:function(){if(!this._ui_seed)this._ui_seed=(new Date).valueOf();return this._ui_seed++},clearAndLoad:function(){var a=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=a;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var a=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,a,Math.min(a+this.rowsBufferOutSize,
this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};
(function(){function a(a,b){this[a]=b}function b(a,b){this[a].call(this,b)}function c(a,b){this[a].call(this,b.join(this.delim))}function d(a,b){for(var c=0;c<b.length;c++)if(typeof b[c]=="object"){var d=this.getCombo(c),e;for(e in b[c])d.put(e,b[c][e])}}function e(a,b){function c(a,b,d){e[b]||(e[b]=[]);if(typeof d=="object")d.toString=function(){return this.text};e[b][a]=d}for(var d=1,e=[],k=0;k<b.length;k++)if(typeof b[k]=="object"&&b[k].length)for(var g=0;g<b[k].length;g++)c(k,g,b[k][g]);else c(k,
0,b[k]);for(k=0;k<e.length;k++)for(g=0;g<e[0].length;g++){var n=e[k][g];e[k][g]=(n||"").toString()||"&nbsp;";if(n&&n.colspan)for(var o=1;o<n.colspan;o++)c(g+o,k,"#cspan");if(n&&n.rowspan)for(o=1;o<n.rowspan;o++)c(g,k+o,"#rspan")}this.setHeader(e[0]);for(k=1;k<e.length;k++)this.attachHeader(e[k])}var g=[{name:"label",def:"&nbsp;",operation:"setHeader",type:e},{name:"id",def:"",operation:"columnIds",type:a},{name:"width",def:"*",operation:"setInitWidths",type:c},{name:"align",def:"left",operation:"cellAlign",
type:a},{name:"valign",def:"middle",operation:"cellVAlign",type:a},{name:"sort",def:"na",operation:"fldSort",type:a},{name:"type",def:"ro",operation:"setColTypes",type:c},{name:"options",def:"",operation:"",type:d}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(a){return[a.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",
save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",
mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",
drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(a){for(var c=0;c<g.length;c++){for(var d=[],e=0;e<a.length;e++)d[e]=a[e][g[c].name]||g[c].def;var l=g[c].type||b;l.call(this,g[c].operation,d,a)}this.init()},rows:function(){},headers:function(a){for(var b=0;b<a.length;b++)this.attachHeader(a[b])}})})();
dhtmlXGridObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(a,c){this.obj._h2?this.obj.addRow(c,d,null,parent):this.obj.addRow(c,[],0);var d=this.obj.getRowById(c);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj._postRowProcessing(d))});a.attachEvent("updateCallback",function(a,c){var d=this.obj.getRowById(c);d&&(this.obj._process_xml_row(d,a.firstChild),this.obj._postRowProcessing(d))});a.attachEvent("deleteCallback",function(a,c){this.obj.setUserData(c,this.action_param,
"true_deleted");this.obj.deleteRow(c)});a._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(b,c,d){if(a._columns&&!a._columns[d])return!0;var e=this.cells(c,d);b==1?e.isCheckbox()&&a.setUpdated(c,!0):b==2&&e.wasChanged()&&a.setUpdated(c,!0);return!0});this.attachEvent("onRowPaste",function(b){a.setUpdated(b,!0)});this.attachEvent("onUndo",function(b){a.setUpdated(b,!0)});this.attachEvent("onRowIdChange",function(b,c){var d=a.findRow(b);
d<a.updatedRows.length&&(a.updatedRows[d]=c)});this.attachEvent("onSelectStateChanged",function(){a.updateMode=="row"&&a.sendData();return!0});this.attachEvent("onEnter",function(){a.updateMode=="row"&&a.sendData();return!0});this.attachEvent("onBeforeRowDeleted",function(b){if(!this.rowsAr[b])return!0;if(this.dragContext&&a.dnd)return window.setTimeout(function(){a.setUpdated(b,!0)},1),!0;var c=a.getState(b);this._h2&&this._h2.forEachChild(b,function(b){a.setUpdated(b.id,!1);a.markRow(b.id,!0,"deleted")},
this);if(c=="inserted")return a.set_invalid(b,!1),a.setUpdated(b,!1),!0;if(c=="deleted")return!1;if(c=="true_deleted")return a.setUpdated(b,!1),!0;a.setUpdated(b,!0,"deleted");return!1});this.attachEvent("onBindUpdate",function(b){if(typeof b=="object")b=b.id;a.setUpdated(b,!0)});this.attachEvent("onRowAdded",function(b){if(this.dragContext&&a.dnd)return!0;a.setUpdated(b,!0,"inserted");return!0});a._getRowData=function(a){var c=[];c.gr_id=a;this.obj.isTreeGrid()&&(c.gr_pid=this.obj.getParentId(a));
for(var d=this.obj.getRowById(a),e=0;e<this.obj._cCount;e++){var g=this.obj._c_order?this.obj._c_order[e]:e,h=this.obj.cells(d.idd,e);if(!this._changed||h.wasChanged())this._endnm?c[this.obj.getColumnId(e)]=h.getValue():c["c"+g]=h.getValue()}var f=this.obj.UserData[a];if(f)for(var i=0;i<f.keys.length;i++)f.keys[i]&&f.keys[i].indexOf("__")!=0&&(c[f.keys[i]]=f.values[i]);if(f=this.obj.UserData.gridglobaluserdata)for(i=0;i<f.keys.length;i++)c[f.keys[i]]=f.values[i];return c};a._clearUpdateFlag=function(a){var c=
this.obj.getRowById(a);if(c)for(var d=0;d<this.obj._cCount;d++)this.obj.cells(a,d).cell.wasChanged=!1};a.checkBeforeUpdate=function(a){for(var c=!0,d=[],e=0;e<this.obj._cCount;e++)if(this.mandatoryFields[e]){var g=this.mandatoryFields[e].call(this.obj,this.obj.cells(a,e).getValue(),a,e);typeof g=="string"?(this.messages.push(g),c=!1):(c&=g,d[e]=!g)}c||(this.set_invalid(a,"invalid",d),this.setUpdated(a,!1));return c}};
function dhtmlXGridCellObject(a){this.destructor=function(){return this.base=this.grid=this.cell=this.cell.obj=null};this.cell=a;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell.innerHTML._dhx_trim()};this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()};this.getFont=function(){arOut=Array(3);if(this.cell.style.fontFamily)arOut[0]=this.cell.style.fontFamily;if(this.cell.style.fontWeight==
"bold"||this.cell.parentNode.style.fontWeight=="bold")arOut[1]="bold";if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic")arOut[1]+="italic";arOut[2]=this.cell.style.fontSize?this.cell.style.fontSize:"";return arOut.join("-")};this.getTextColor=function(){return this.cell.style.color?this.cell.style.color:"#000000"};this.getBgColor=function(){return this.cell.bgColor?this.cell.bgColor:"#FFFFFF"};this.getHorAlign=function(){return this.cell.style.textAlign?this.cell.style.textAlign:
this.cell.style.textAlign?this.cell.style.textAlign:"left"};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(a){fntAr=a.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1]))this.cell.style.fontWeight="bold";if(/italic/.test(fntAr[1]))this.cell.style.fontStyle="italic";if(/underline/.test(fntAr[1]))this.cell.style.textDecoration="underline"}};this.setTextColor=function(a){this.cell.style.color=
a};this.setBgColor=function(a){a==""&&(a=null);this.cell.bgColor=a};this.setHorAlign=function(a){this.cell.style.textAlign=a.length==1?a=="c"?"center":a=="l"?"left":"right":a};this.wasChanged=function(){return this.cell.wasChanged?!0:!1};this.isCheckbox=function(){var a=this.cell.firstChild;return a&&a.tagName=="INPUT"?(type=a.type,type=="radio"||type=="checkbox"?!0:!1):!1};this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked};this.isDisabled=function(){return this.cell._disabled};
this.setChecked=function(a){if(this.isCheckbox())a!="true"&&a!=1&&(a=!1),this.cell.firstChild.checked=a};this.setDisabled=function(a){a!="true"&&a!=1&&(a=!1);if(this.isCheckbox())this.cell.firstChild.disabled=a,this.disabledF&&this.disabledF(a);this.cell._disabled=a}}
dhtmlXGridCellObject.prototype={getAttribute:function(a){return this.cell._attrs[a]},setAttribute:function(a,b){this.cell._attrs[a]=b},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA"))return this.obj;var a=(this.obj||this.cell).getElementsByTagName("TEXTAREA");a.length||(a=(this.obj||this.cell).getElementsByTagName("INPUT"));return a[0]}};
dhtmlXGridCellObject.prototype.setValue=function(a){typeof a!="number"&&(!a||a.toString()._dhx_trim()=="")?(a="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCValue(a)};dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent};dhtmlXGridCellObject.prototype.setCValue=function(a){this.cell.innerHTML=a};dhtmlXGridCellObject.prototype.setCTxtValue=function(a){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(a))};
dhtmlXGridCellObject.prototype.setLabel=function(a){this.cell.innerHTML=a};dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()};function eXcell(){this.val=this.obj=null;this.changeState=function(){return!1};this.edit=function(){this.val=this.getValue()};this.detach=function(){return!1};this.getPosition=function(a){for(var b=a,c=0,d=0;b.tagName!="BODY";)c+=b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;return[c,d]}}eXcell.prototype=new dhtmlXGridCellObject;
function eXcell_ed(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=this.cell.offsetHeight-(_isIE?4:4)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(a){(a||event).cancelBubble=
!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(a){a||(a=event);return a.cancelBubble=!0};_isIE&&(this.obj.focus(),this.obj.blur());this.obj.focus()};this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);
return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(a){!a||a.toString()._dhx_trim()==""?(a=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(a)}}
eXcell_edtxt.prototype=new eXcell_ed;
function eXcell_ch(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.disabledF=function(a){this.cell.innerHTML=a==!0||a==1?this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis."):this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")};this.changeState=function(a){a===!0&&!this.grid.isActive&&(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive&&
window.globalActiveDHTMLGridObject.setActive(!1),this.grid.setActive(!0));if(this.grid.isEditable&&!this.cell.parentNode._locked&&!this.isDisabled())this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!=
"1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return!0};this.isChecked=function(){return this.getValue()=="1"?!0:!1};this.setChecked=function(a){this.setValue(a.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;
eXcell_ch.prototype.setValue=function(a){this.cell.style.verticalAlign="middle";if(a&&(a=a.toString()._dhx_trim(),a=="false"||a=="0"))a="";a?(a="1",this.cell.chstate="1"):(a="0",this.cell.chstate="0");var b=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+a+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)};
function eXcell_ra(a){this.base=eXcell_ch;this.base(a);this.grid=a.parentNode.grid;this.disabledF=function(a){this.cell.innerHTML=a==!0||a==1?this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis."):this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")};this.changeState=function(a){if(!(a===!1&&this.getValue()==1)&&this.grid.isEditable&&!this.cell.parentNode._locked)this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,
this.cell._cellIndex])!=!1?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null};this.edit=null}eXcell_ra.prototype=new eXcell_ch;
eXcell_ra.prototype.setValue=function(a){this.cell.style.verticalAlign="middle";if(a&&(a=a.toString()._dhx_trim(),a=="false"||a=="0"))a="";if(a){if(!this.grid._RaSeCol)this.grid._RaSeCol=[];if(this.grid._RaSeCol[this.cell._cellIndex]){var b=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);b.setValue("0");this.grid.rowsAr[b.cell.parentNode.idd]&&this.grid.callEvent("onEditCell",[1,b.cell.parentNode.idd,b.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell;a="1";this.cell.chstate=
"1"}else a="0",this.cell.chstate="0";this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+a+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};
function eXcell_txt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(a){(a||event).cancelBubble=!0};var a=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var c=document.createElement("DIV");c.appendChild(this.obj);c.style.overflow="auto";c.className=
"dhx_textarea";this.obj.style.margin="0px 0px 0px 0px";this.obj.style.border="0px";this.obj=c}document.body.appendChild(this.obj);if(_isOpera)this.obj.onkeypress=function(a){if(a.keyCode==9)return!1};this.obj.onkeydown=function(a){var b=a||event;if(b.keyCode==9)return globalActiveDHTMLGridObject.entBox.focus(),globalActiveDHTMLGridObject.doKey({keyCode:b.keyCode,shiftKey:b.shiftKey,srcElement:"0"}),!1};this.obj.style.left=a[0]+"px";this.obj.style.top=a[1]+this.cell.offsetHeight+"px";var d=this.cell.offsetWidth<
200?200:this.cell.offsetWidth;this.obj.style.width=d+(_isFF?18:16)+"px";if(_isFF)this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px",this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px";if(_isIE)this.obj.select(),this.obj.value=this.obj.value;_isFF?this.obj.firstChild.focus():this.obj.focus()};this.detach=function(){var a="",a=_isFF?this.obj.firstChild.value:this.obj.value;this.cell._clearCell=a==""?!0:!1;this.setValue(a);document.body.removeChild(this.obj);this.obj=null;
return this.val!=this.getValue()};this.getValue=function(){return this.obj?_isFF?this.obj.firstChild.value:this.obj.value:this.cell._clearCell?"":typeof this.cell._brval!="undefined"?this.cell._brval:this.grid.multiLine?this.cell._brval||this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim():this.cell._brval||this.cell.innerHTML}}eXcell_txt.prototype=new eXcell;
function eXcell_txttxt(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":!this.grid.multiLine&&this.cell._brval?this.cell._brval:_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(a){this.cell._brval=a;!a||a.toString()._dhx_trim()==""?(a=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(a)}}
eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(a){this.cell._brval=a;!a||a.toString()._dhx_trim()==""?(a="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;!this.grid.multiLine||this.cell._clearCell?this.setCValue(a,this.cell._brval):this.setCValue(a.replace(/\n/g,"<br/>"),a)};
function eXcell_co(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid,this.combo=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),this.editable=!0;this.shiftNext=function(){var a=this.list.options[this.list.selectedIndex+1];if(a)a.selected=!0;this.obj.value=this.list.options[this.list.selectedIndex].text;return!0};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var a=this.list.options[this.list.selectedIndex-1];if(a)a.selected=!0;this.obj.value=this.list.options[this.list.selectedIndex].text}return!0};
this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var a=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=this.cell.offsetHeight-4+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(a){(a||event).cancelBubble=!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.text;this.obj.onselectstart=function(a){a||
(a=event);return a.cancelBubble=!0};var c=this;this.obj.onkeyup=function(a){var b=(a||event).keyCode;if(!(b==38||b==40||b==9))for(var d=this.readonly?String.fromCharCode(b):this.value,e=c.list.options,f=0;f<e.length;f++)if(e[f].text.indexOf(d)==0)return e[f].selected=!0};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=a[0]+"px";this.list.style.top=a[1]+this.cell.offsetHeight+"px";this.list.onclick=
function(a){var b=a||window.event,d=b.target||b.srcElement;if(d.tagName=="OPTION")d=d.parentNode;c.editable=!1;c.grid.editStop();b.cancelBubble=!0};for(var d=this.combo.getKeys(),e=!1,g=0,h=0;h<d.length;h++){var f=this.combo.get(d[h]);this.list.options[this.list.options.length]=new Option(f,d[h]);d[h]==this.val&&(g=this.list.options.length-1,e=!0)}e==!1&&(this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val),g=this.list.options.length-1);document.body.appendChild(this.list);
this.list.size="6";this.cstate=1;this.editable?this.cell.innerHTML="":(this.obj.style.width="1px",this.obj.style.height="1px");this.cell.appendChild(this.obj);this.list.options[g].selected=!0;if(!_isFF||this.editable)this.obj.focus(),this.obj.focus();if(!this.editable)this.obj.style.visibility="hidden",this.list.focus(),this.list.onkeydown=function(a){a=a||window.event;c.grid.setActive(!0);if(a.keyCode<30)return c.grid.doKey({target:c.cell,keyCode:a.keyCode,shiftKey:a.shiftKey,ctrlKey:a.ctrlKey})}};
this.getValue=function(){return this.cell.combo_value==window.undefined?"":this.cell.combo_value};this.detach=function(){if(this.val!=this.getValue())this.cell.wasChanged=!0;if(this.list.parentNode!=null)if(this.editable){var a=this.list.options[this.list.selectedIndex];if(a&&a.text==this.obj.value)this.setValue(this.list.value);else{var c=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),d=c.values._dhx_find(this.obj.value);d!=-1?this.setValue(c.keys[d]):this.setCValue(this.cell.combo_value=
this.obj.value)}}else this.setValue(this.list.value);this.list.parentNode&&this.list.parentNode.removeChild(this.list);this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};
eXcell_co.prototype.setValue=function(a){if(typeof a=="object"){var b=this.grid.xmlLoader.doXPath("./option",a);if(b.length)this.cell._combo=new dhtmlXGridComboObject;for(var c=0;c<b.length;c++)this.cell._combo.put(b[c].getAttribute("value"),b[c].firstChild?b[c].firstChild.data:"");a=a.firstChild.data}if((a||"").toString()._dhx_trim()=="")a=null;this.cell.combo_value=a;if(a!==null){var d=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(a);this.setCValue(d===null?a:d,a)}else this.setCValue("&nbsp;",
a)};function eXcell_coro(a){this.base=eXcell_co;this.base(a);this.editable=!1}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(a){this.base=eXcell_co;this.base(a)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return _isIE?this.cell.innerText:this.cell.textContent};
eXcell_cotxt.prototype.setValue=function(a){if(typeof a=="object"){var b=this.grid.xmlLoader.doXPath("./option",a);if(b.length)this.cell._combo=new dhtmlXGridComboObject;for(var c=0;c<b.length;c++)this.cell._combo.put(b[c].getAttribute("value"),b[c].firstChild?b[c].firstChild.data:"");a=a.firstChild.data}if((a||"").toString()._dhx_trim()=="")a=null;a!==null?this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(a)||a,a):this.setCTxtValue(" ",a);this.cell.combo_value=a};
function eXcell_corotxt(a){this.base=eXcell_co;this.base(a);this.editable=!1}eXcell_corotxt.prototype=new eXcell_cotxt;
function eXcell_cp(a){try{this.cell=a,this.grid=this.cell.parentNode.grid}catch(b){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var a=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=a[0]+"px";this.obj.style.zIndex=1E3;this.obj.style.top=a[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(a){a.length==1&&(a="0"+
a);return a};this.colorPanel=function(a,b){var e=document.createElement("TABLE");b.appendChild(e);e.cellSpacing=0;e.editor_obj=this;e.style.cursor="default";e.onclick=function(a){var b=a||window.event,c=b.target||b.srcElement,d=c.parentNode.parentNode.parentNode.editor_obj;d.setValue(c._bg);d.grid.editStop()};for(var g=256/a,h=0;h<=256/g;h++)for(var f=e.insertRow(h),i=0;i<=256/g;i++)for(var j=0;j<=256/g;j++){R=new Number(g*h)-(h==0?0:1);G=new Number(g*i)-(i==0?0:1);B=new Number(g*j)-(j==0?0:1);var l=
this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16)),k=f.insertCell(i);k.width="10px";k.innerHTML="&nbsp;";k.title=l.toUpperCase();k.style.backgroundColor="#"+l;k._bg="#"+l;if(this.val!=null&&"#"+l.toUpperCase()==this.val.toUpperCase())k.style.border="2px solid white"}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,
2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){this.obj.offsetParent!=null&&document.body.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(a){this.setCValue("<div style='width:100%;height:"+(this.grid.multiLine?this.cell.offsetHeight-2:16)+";background-color:"+(a||"")+";border:0px;'>&nbsp;</div>",a);this.cell.firstChild._bg=a};
function eXcell_img(a){try{this.cell=a,this.grid=this.cell.parentNode.grid}catch(b){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG")return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");else if(this.cell.firstChild.tagName=="A"){var a=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");a+="^"+this.cell.lnk;this.cell.trg&&(a+="^"+this.cell.trg);return a}};this.isDisabled=function(){return!0}}eXcell_img.prototype=new eXcell;
eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(a){var b=a;if(a.indexOf("^")!=-1){var c=a.split("^"),a=c[0],b=this.cell._attrs.title||c[1];if(c.length>2&&(this.cell.lnk=c[2],c[3]))this.cell.trg=c[3];this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(a||"")._dhx_trim()+"' border='0'>",a);if(this.cell.lnk)this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>";this.cell._brval=b};

function eXcell_amount(cell){
	if (cell){
		this.cell = cell;
		this.grid = this.cell.parentNode.grid;
		eXcell_ed.call(this);
	}
	this.setAttribute("style", "text-align:right");
	this.setValue=function(val){
		isNaN(parseFloat(val))&&(val=this.val||0);
		if(val == 0) val = '';
		var b="green";val<0&&(b="red");
		if(val == ''){
			this.setCValue("<span style='padding-right:2px;text-align:right;color:"+b+";'>"+val+"</span>",val);
		}else{
			this.setCValue("<span style='padding-right:2px;text-align:right;color:"+b+";'>"+formatNumbercurr(val,3)+"</span>",val);
		}
};
this.getValue=function(){
	return unFormat(this.cell.childNodes[0].innerHTML);
};
};
eXcell_amount.prototype = new eXcell;

function eXcell_kxamount(cell){
	if (cell){
		this.cell = cell;
		this.grid = this.cell.parentNode.grid;
		eXcell_ed.call(this);
	}
	this.setAttribute("style", "text-align:right");
	this.setValue=function(val){
		isNaN(parseFloat(val))&&(val=this.val||0);
		if(val == 0) val = '';
		var b="green";val<0&&(b="red");
		if(val == ''){
			this.setCValue("<span style='padding-right:2px;text-align:right;color:"+b+";'>"+val+"</span>",val);
		}else{
			this.setCValue("<span style='padding-right:2px;text-align:right;color:"+b+";'>"+formatNumbercurr(val,4)+"</span>",val);
		}
};
this.getValue=function(){
	return unFormat(this.cell.childNodes[0].innerHTML);
};
};
eXcell_kxamount.prototype = new eXcell;


// function to set the max length of the field and validate it

// function to set the max length of the field and validate it

function eXcell_price(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){return this.cell.childNodes.length>1?this.cell.childNodes[1].innerHTML.toString()._dhx_trim():"0"}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(a){isNaN(parseFloat(a))&&(a=this.val||0);var b="green";a<0&&(b="red");this.setCValue("<span>$</span><span style='padding-right:2px;color:"+b+";'>"+a+"</span>",a)};
function eXcell_dyn(a){this.base=eXcell_ed;this.base(a);this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}eXcell_dyn.prototype=new eXcell_ed;
eXcell_dyn.prototype.setValue=function(a){if(!a||isNaN(Number(a)))a!==""&&(a=0);if(a>0)var b="green",c="dyn_up.gif";else a==0?(b="black",c="dyn_.gif"):(b="red",c="dyn_down.gif");this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+""+c+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+b+";'>"+a+"</span></div>",a)};
function eXcell_ro(a){if(a)this.cell=a,this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;
function eXcell_ron(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex).toString()}}eXcell_ron.prototype=new eXcell;
eXcell_ron.prototype.setValue=function(a){if(a!==0&&(!a||a.toString()._dhx_trim()==""))return this.setCValue("&nbsp;"),this.cell._clearCell=!0;this.cell._clearCell=!1;this.setCValue(a?this.grid._aplNF(a,this.cell._cellIndex):"0")};
function eXcell_rotxt(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return!0};this.setValue=function(a){a?this.cell._clearCell=!1:(a=" ",this.cell._clearCell=!0);this.setCTxtValue(a)};this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}eXcell_rotxt.prototype=new eXcell;
function dhtmlXGridComboObject(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;this.put=function(a,b){for(var c=0;c<this.keys.length;c++)if(this.keys[c]==a)return this.values[c]=b,!0;this.values[this.values.length]=b;this.keys[this.keys.length]=a};this.get=function(a){for(var b=0;b<this.keys.length;b++)if(this.keys[b]==a)return this.values[b];return null};this.clear=function(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray};this.remove=function(a){for(var b=0;b<this.keys.length;b++)if(this.keys[b]==
a)return this.keys._dhx_removeAt(b),this.values._dhx_removeAt(b),!0};this.size=function(){for(var a=0,b=0;b<this.keys.length;b++)this.keys[b]!=null&&a++;return a};this.getKeys=function(){for(var a=[],b=0;b<this.keys.length;b++)this.keys[b]!=null&&(a[a.length]=this.keys[b]);return a};this.save=function(){this._save=[];for(var a=0;a<this.keys.length;a++)this._save[a]=[this.keys[a],this.values[a]]};this.restore=function(){if(this._save){this.keys[a]=[];this.values[a]=[];for(var a=0;a<this._save.length;a++)this.keys[a]=
this._save[a][0],this.values[a]=this._save[a][1]}};return this}function Hashtable(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;return this}Hashtable.prototype=new dhtmlXGridComboObject;
dhtmlXGridObject.prototype.filterBy=function(a,b,c){if(this.isTreeGrid())return this.filterTreeBy(a,b,c);if(this._f_rowsBuffer){if(!c&&(this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer)),this._fake))this._fake.rowsBuffer=this.rowsBuffer}else this._f_rowsBuffer=[].concat(this.rowsBuffer);if(this.rowsBuffer.length){var d=!0;this.dma(!0);if(typeof a=="object")for(var e=0;e<b.length;e++)this._filterA(a[e],b[e]);else this._filterA(a,b);this.dma(!1);this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<
this.currentPage-1&&this.changePage(0);this._reset_view();this.callEvent("onGridReconstructed",[])}};dhtmlXGridObject.prototype._filterA=function(a,b){if(b!=""){var c=!0;typeof b=="function"?c=!1:b=(b||"").toString().toLowerCase();if(this.rowsBuffer.length)for(var d=this.rowsBuffer.length-1;d>=0;d--)(c?this._get_cell_value(this.rowsBuffer[d],a).toString().toLowerCase().indexOf(b)==-1:!b.call(this,this._get_cell_value(this.rowsBuffer[d],a),this.rowsBuffer[d].idd))&&this.rowsBuffer.splice(d,1)}};
dhtmlXGridObject.prototype.getFilterElement=function(a){if(this.filters){for(var b=0;b<this.filters.length;b++)if(this.filters[b][1]==a)return this.filters[b][0].combo||this.filters[b][0];return null}};
dhtmlXGridObject.prototype.collectValues=function(a){var b=this.callEvent("onCollectValues",[a]);if(b!==!0)return b;if(this.isTreeGrid())return this.collectTreeValues(a);this.dma(!0);this._build_m_order();for(var a=this._m_order?this._m_order[a]:a,c={},d=[],e=this._f_rowsBuffer||this.rowsBuffer,g=0;g<e.length;g++){var h=this._get_cell_value(e[g],a);if(h&&(!e[g]._childIndexes||e[g]._childIndexes[a]!=e[g]._childIndexes[a-1]))c[h]=!0}this.dma(!1);var f=this.combos[a]||(this._col_combos?this._col_combos[a]:
!1),i;for(i in c)if(c[i]===!0){if(f)if(f.get&&f.get(i))i=f.get(i);else if(f.getOption&&f.getOption(i))i=f.getOption(i).text;d.push(i)}return d.sort()};dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var a=0;a<this._c_order.length;a++)this._m_order[this._c_order[a]]=a}};
dhtmlXGridObject.prototype.filterByAll=function(){var a=[],b=[];this._build_m_order();for(var c=0;c<this.filters.length;c++)if(!(c>=this._cCount)){var d=this._m_order?this._m_order[this.filters[c][1]]:this.filters[c][1];b.push(d);var e=this.filters[c][0].old_value=this.filters[c][0].value;this.filters[c][0]._filter&&(e=this.filters[c][0]._filter());var g;if(typeof e!="function"&&(g=this.combos[d]||(this._col_combos?this._col_combos[d]:!1)))g.values?(d=g.values._dhx_find(e),e=d==-1?e:g.keys[d]):g.getOptionByLabel&&
(e=g.getOptionByLabel(e)?g.getOptionByLabel(e).value:e);a.push(e)}if(this.callEvent("onFilterStart",[b,a])&&(this.filterBy(b,a),this._cssEven&&this._fixAlterCss(),this.callEvent("onFilterEnd",[this.filters]),this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length))this._f_rowsBuffer=null};
dhtmlXGridObject.prototype.makeFilter=function(a,b){if(!this.filters)this.filters=[];typeof a!="object"&&(a=document.getElementById(a));if(a){var c=this;if(!a.style.width)a.style.width="90%";if(a.tagName=="SELECT"){this.filters.push([a,b]);this._loadSelectOptins(a,b);a.onchange=function(){c.filterByAll()};if(_isIE)a.style.marginTop="1px";this.attachEvent("onEditCell",function(c,d,h){this._build_m_order();c==2&&this.filters&&(this._m_order?h==this._m_order[b]:h==b)&&this._loadSelectOptins(a,b);return!0})}else if(a.tagName==
"INPUT")this.filters.push([a,b]),a.old_value=a.value="",a.onkeydown=function(){this._timer&&window.clearTimeout(this._timer);this._timer=window.setTimeout(function(){if(a.value!=a.old_value)c.filterByAll(),a.old_value=a.value},500)};else if(a.tagName=="DIV"&&a.className=="combo"){this.filters.push([a,b]);a.style.padding="0px";a.style.margin="0px";if(!window.dhx_globalImgPath)window.dhx_globalImgPath=this.imgURL;var d=new dhtmlXCombo(a,"_filter","90%");d.filterSelfA=d.filterSelf;d.filterSelf=function(){this.getSelectedIndex()==
0&&this.setComboText("");this.filterSelfA.apply(this,arguments);this.optionsArr[0].hide(!1)};d.enableFilteringMode(!0);a.combo=d;a.value="";this._loadComboOptins(a,b);d.attachEvent("onChange",function(){a.value=d.getSelectedValue();if(a.value===null)a.value="";c.filterByAll()})}a.parentNode&&(a.parentNode.className+=" filter");this._filters_ready()}};
dhtmlXGridObject.prototype.findCell=function(a,b,c,d){d=d||function(a,b){return b.toString().toLowerCase().indexOf(a)!=-1};d===!0&&(d=function(a,b){return b.toString().toLowerCase()==a});var e=[],a=a.toString().toLowerCase();typeof c!="number"&&(c=c?1:0);if(!this.rowsBuffer.length)return e;for(var g=b||0;g<this._cCount;g++){if(this._h2)this._h2.forEachChild(0,function(b){if(c&&e.length==c)return e;d(a,this._get_cell_value(b.buff,g))&&e.push([b.id,g])},this);else for(var h=0;h<this.rowsBuffer.length;h++)if(d(a,
this._get_cell_value(this.rowsBuffer[h],g))&&(e.push([this.rowsBuffer[h].idd,g]),c&&e.length==c))return e;if(typeof b!="undefined")break}return e};
dhtmlXGridObject.prototype.makeSearch=function(a,b,c){typeof a!="object"&&(a=document.getElementById(a));if(a){var d=this;if(a.tagName=="INPUT")a.onkeypress=function(){this._timer&&window.clearTimeout(this._timer);this._timer=window.setTimeout(function(){if(a.value!=""){var e=d.findCell(a.value,b,!0,c);e.length&&(d._h2&&d.openItem(e[0][0]),d.selectCell(d.getRowIndex(e[0][0]),b||0))}},500)};a.parentNode&&(a.parentNode.className+=" filter")}};
dhtmlXGridObject.prototype._loadSelectOptins=function(a,b){var c=this.collectValues(b),d=a.value;a.innerHTML="";a.options[0]=new Option("","");for(var e=this._filter_tr?this._filter_tr[b]:null,g=0;g<c.length;g++)a.options[a.options.length]=new Option(e?e(c[g]):c[g],c[g]);a.value=d};dhtmlXGridObject.prototype.setSelectFilterLabel=function(a,b){if(!this._filter_tr)this._filter_tr=[];this._filter_tr[a]=b};
dhtmlXGridObject.prototype._loadComboOptins=function(a,b){if(a.combo){var c=this.collectValues(b);a.combo.clearAll();a.combo.render(!1);for(var d=[["","&nbsp;"]],e=0;e<c.length;e++)d.push([c[e],c[e]]);a.combo.addOption(d);a.combo.render(!0)}};
dhtmlXGridObject.prototype.refreshFilters=function(){if(this.filters)for(var a=0;a<this.filters.length;a++)switch(this.filters[a][0].tagName.toLowerCase()){case "select":this._loadSelectOptins.apply(this,this.filters[a]);break;case "div":this._loadComboOptins.apply(this,this.filters[a])}};
dhtmlXGridObject.prototype._filters_ready=function(){this.attachEvent("onXLE",this.refreshFilters);this.attachEvent("onRowCreated",function(a,b){if(this._f_rowsBuffer)for(var c=0;c<this._f_rowsBuffer.length;c++)if(this._f_rowsBuffer[c].idd==a)return this._f_rowsBuffer[c]=b});this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null;if(!this.hdr.rows.length)this.filters=[]});window.dhtmlXCombo&&this.attachEvent("onScroll",dhtmlXCombo.prototype.closeAll);this._filters_ready=function(){}};
dhtmlXGridObject.prototype._in_header_text_filter=function(a,b){a.innerHTML="<input type='text'>";a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};a.onselectstart=function(){return event.cancelBubble=!0};this.makeFilter(a.firstChild,b)};
dhtmlXGridObject.prototype._in_header_text_filter_inc=function(a,b){a.innerHTML="<input type='text'>";a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};a.onselectstart=function(){return event.cancelBubble=!0};this.makeFilter(a.firstChild,b);a.firstChild._filter=function(){return a.firstChild.value==""?"":function(b){return b.toString().toLowerCase().indexOf(a.firstChild.value.toLowerCase())==0}};this._filters_ready()};
dhtmlXGridObject.prototype._in_header_select_filter=function(a,b){a.innerHTML="<select></select>";a.onclick=function(a){(a||event).cancelBubble=!0;return!1};this.makeFilter(a.firstChild,b)};
dhtmlXGridObject.prototype._in_header_select_filter_strict=function(a,b){a.innerHTML="<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>";a.onclick=function(a){(a||event).cancelBubble=!0;return!1};this.makeFilter(a.firstChild,b);var c=this.combos;a.firstChild._filter=function(){var d=a.firstChild.value;if(!d)return"";c[b]&&(d=c[b].keys[c[b].values._dhx_find(d)]);d=d.toLowerCase();return function(a){return a.toString().toLowerCase()==d}};this._filters_ready()};
dhtmlXGridObject.prototype._in_header_combo_filter=function(a,b){a.innerHTML="<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>";a.onselectstart=function(){return event.cancelBubble=!0};a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};this.makeFilter(a.firstChild,b)};
dhtmlXGridObject.prototype._search_common=function(a){a.innerHTML="<input type='text' style='width:90%; '>";a.onclick=a.onmousedown=function(a){return(a||event).cancelBubble=!0};a.onselectstart=function(){return event.cancelBubble=!0}};dhtmlXGridObject.prototype._in_header_text_search=function(a,b){this._search_common(a,b);this.makeSearch(a.firstChild,b)};dhtmlXGridObject.prototype._in_header_text_search_strict=function(a,b){this._search_common(a,b);this.makeSearch(a.firstChild,b,!0)};
dhtmlXGridObject.prototype._in_header_numeric_filter=function(a,b){this._in_header_text_filter.call(this,a,b);a.firstChild._filter=function(){var a=this.value,b,e="==",g=parseFloat(a.replace("=","")),h=null;if(a){if(a.indexOf("..")!=-1)return a=a.split(".."),g=parseFloat(a[0]),h=parseFloat(a[1]),function(a){return a>=g&&a<=h?!0:!1};if(b=a.match(/>=|<=|>|</))e=b[0],g=parseFloat(a.replace(e,""));return Function("v"," if (v "+e+" "+g+" ) return true; return false;")}return""}};
dhtmlXGridObject.prototype._in_header_master_checkbox=function(a,b,c){a.innerHTML=c[0]+"<input type='checkbox' />"+c[1];var d=this;a.getElementsByTagName("input")[0].onclick=function(a){d._build_m_order();var c=d._m_order?d._m_order[b]:b,h=this.checked?1:0;d.forEachRowA(function(a){var b=this.cells(a,c);if(b.isCheckbox())b.setValue(h),b.cell.wasChanged=!0;this.callEvent("onEditCell",[1,a,c,h]);this.callEvent("onCheckbox",[a,c,h])});(a||event).cancelBubble=!0}};
dhtmlXGridObject.prototype._in_header_stat_total=function(a,b,c){var d=function(){var a=0;this._build_m_order();for(var c=this._m_order?this._m_order[b]:b,d=0;d<this.rowsBuffer.length;d++){var f=parseFloat(this._get_cell_value(this.rowsBuffer[d],c));a+=isNaN(f)?0:f}return this._maskArr[c]?this._aplNF(a,c):Math.round(a*100)/100};this._stat_in_header(a,d,b,c,c)};
dhtmlXGridObject.prototype._in_header_stat_multi_total=function(a,b,c){var d=c[1].split(":");c[1]="";for(var e=0;e<d.length;e++)d[e]=parseInt(d[e]);for(var g=function(){for(var a=0,c=0;c<this.rowsBuffer.length;c++){for(var e=1,k=0;k<d.length;k++)e*=parseFloat(this._get_cell_value(this.rowsBuffer[c],d[k]));a+=isNaN(e)?0:e}return this._maskArr[b]?this._aplNF(a,b):Math.round(a*100)/100},h=[],f=0;f<d.length;f++)h[d[f]]=!0;this._stat_in_header(a,g,h,c,c)};
dhtmlXGridObject.prototype._in_header_stat_max=function(a,b,c){var d=function(){this._build_m_order();var a=this._m_order?this._m_order[b]:b,c=-999999999;if(this.getRowsNum()==0)return"&nbsp;";for(var d=0;d<this.rowsBuffer.length;d++)c=Math.max(c,parseFloat(this._get_cell_value(this.rowsBuffer[d],a)));return this._maskArr[b]?this._aplNF(c,b):c};this._stat_in_header(a,d,b,c)};
dhtmlXGridObject.prototype._in_header_stat_min=function(a,b,c){var d=function(){this._build_m_order();var a=this._m_order?this._m_order[b]:b,c=999999999;if(this.getRowsNum()==0)return"&nbsp;";for(var d=0;d<this.rowsBuffer.length;d++)c=Math.min(c,parseFloat(this._get_cell_value(this.rowsBuffer[d],a)));return this._maskArr[b]?this._aplNF(c,b):c};this._stat_in_header(a,d,b,c)};
dhtmlXGridObject.prototype._in_header_stat_average=function(a,b,c){var d=function(){this._build_m_order();var a=this._m_order?this._m_order[b]:b,c=0,d=0;if(this.getRowsNum()==0)return"&nbsp;";for(var f=0;f<this.rowsBuffer.length;f++){var i=parseFloat(this._get_cell_value(this.rowsBuffer[f],a));c+=isNaN(i)?0:i;d++}return this._maskArr[b]?this._aplNF(c/d,b):Math.round(c/d*100)/100};this._stat_in_header(a,d,b,c)};
dhtmlXGridObject.prototype._in_header_stat_count=function(a,b,c){var d=function(){return this.getRowsNum()};this._stat_in_header(a,d,b,c)};
dhtmlXGridObject.prototype._stat_in_header=function(a,b,c,d){var e=this,g=function(){this.dma(!0);a.innerHTML=(d[0]?d[0]:"")+b.call(this)+(d[1]?d[1]:"");this.dma(!1);this.callEvent("onStatReady",[])};if(!this._stat_events)this._stat_events=[],this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var a=0;a<this._stat_events.length;a++)for(var b=0;b<4;b++)this.detachEvent(this._stat_events[a][b]);this._stat_events=[]}});this._stat_events.push([this.attachEvent("onGridReconstructed",g),
this.attachEvent("onXLE",g),this.attachEvent("onFilterEnd",g),this.attachEvent("onEditCell",function(a,b,d){a==2&&(d==c||c&&c[d])&&g.call(this);return!0})]);a.innerHTML=""};dhtmlXGridObject.prototype.enableDragAndDrop=function(a){a=="temporary_disabled"?(this.dADTempOff=!1,a=!0):this.dADTempOff=!0;this.dragAndDropOff=convertStringToBoolean(a);this._drag_validate=!0;if(a)this.objBox.ondragstart=function(a){(a||event).cancelBubble=!0;return!1}};
dhtmlXGridObject.prototype.setDragBehavior=function(a){this.dadmodec=this.dadmodefix=0;switch(a){case "child":this.dadmode=0;this._sbmod=!1;break;case "sibling":this.dadmode=1;this._sbmod=!1;break;case "sibling-next":this.dadmode=1;this._sbmod=!0;break;case "complex":this.dadmode=2;this._sbmod=!1;break;case "complex-next":this.dadmode=2,this._sbmod=!0}};dhtmlXGridObject.prototype.enableDragOrder=function(a){this._dndorder=convertStringToBoolean(a)};
dhtmlXGridObject.prototype._checkParent=function(a,b){var c=this._h2.get[a.idd].parent;if(c.parent){for(var d=0;d<b.length;d++)if(b[d]==c.id)return!0;return this._checkParent(this.rowsAr[c.id],b)}};
dhtmlXGridObject.prototype._createDragNode=function(a,b){this.editStop();if(window.dhtmlDragAndDrop.dragNode)return null;if(!this.dADTempOff)return null;a.parentObject={};a.parentObject.treeNod=this;var c=this.callEvent("onBeforeDrag",[a.parentNode.idd,a._cellIndex,b]);if(!c)return null;var d=[];d[this.selMultiRows?d.length:0]=a.parentNode.idd;if(this.isTreeGrid())for(var e=d.length-1;e>=0;e--)this._checkParent(this.rowsAr[d[e]],d)&&d.splice(e,1);var g=this;d.length&&this._dndorder&&d.sort(function(a,
b){return g.rowsAr[a].rowIndex>g.rowsAr[b].rowIndex?1:-1});var h=this.getFirstParentOfType(_isIE?b.srcElement:b.target,"TD");if(h)this._dndExtra=h._cellIndex;this._dragged=[];for(e=0;e<d.length;e++)if(this.rowsAr[d[e]])this._dragged[this._dragged.length]=this.rowsAr[d[e]],this.rowsAr[d[e]].treeNod=this;a.parentObject.parentNode=a.parentNode;var f=document.createElement("div");f.innerHTML=c!==!0?c:this.rowToDragElement(a.parentNode.idd);f.style.position="absolute";f.className="dragSpanDiv";return f};
dhtmlXGridObject.prototype._createSdrgc=function(){this._sdrgc=document.createElement("DIV");this._sdrgc.innerHTML="&nbsp;";this._sdrgc.className="gridDragLine";this.objBox.appendChild(this._sdrgc)};function dragContext(a,b,c,d,e,g,h,f,i,j){this.source=a||"grid";this.target=b||"grid";this.mode=c||"move";this.dropmode=d||"child";this.sid=e||0;this.tid=g;this.sobj=h||null;this.tobj=f||null;this.sExtra=i||null;this.tExtra=j||null;return this}
dragContext.prototype.valid=function(){if(this.sobj!=this.tobj)return!0;if(this.sid==this.tid)return!1;if(this.target=="treeGrid")for(var a=this.tid;a=this.tobj.getParentId(a);)if(this.sid==a)return!1;return!0};dragContext.prototype.close=function(){this.tobj=this.sobj=null};dragContext.prototype.copy=function(){return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra)};dragContext.prototype.set=function(a,b){this[a]=b;return this};
dragContext.prototype.uid=function(){for(this.nid=this.sid;this.tobj.rowsAr[this.nid];)this.nid+=(new Date).valueOf();return this};dragContext.prototype.data=function(){return this.sobj==this.tobj?this.sobj._getRowArray(this.sobj.rowsAr[this.sid]):this.source=="tree"?this.tobj.treeToGridElement(this.sobj,this.sid,this.tid):this.tobj.gridToGrid(this.sid,this.sobj,this.tobj)};dragContext.prototype.attrs=function(){return this.source=="tree"?{}:this.sobj.rowsAr[this.sid]._attrs};
dragContext.prototype.childs=function(){return this.source=="treeGrid"?this.sobj._h2.get[this.sid]._xml_await?this.sobj._h2.get[this.sid].has_kids:null:null};
dragContext.prototype.pid=function(){if(!this.tid)return 0;if(!this.tobj._h2)return 0;if(this.target=="treeGrid")if(this.dropmode=="child")return this.tid;else{var a=this.tobj.rowsAr[this.tid],b=this.tobj._h2.get[a.idd].parent.id;if(this.alfa&&this.tobj._sbmod&&a.nextSibling){var c=this.tobj._h2.get[a.nextSibling.idd].parent.id;if(c==this.tid)return this.tid;if(c!=b)return c}return b}};
dragContext.prototype.ind=function(){if(this.tid==window.unknown)return this.tobj.rowsBuffer.length;this.target=="treeGrid"&&(this.dropmode=="child"?this.tobj.openItem(this.tid):this.tobj.openItem(this.tobj.getParentId(this.tid)));var a=this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);if(this.alfa&&this.tobj._sbmod&&this.dropmode=="sibling"){var b=this.tobj.rowsAr[this.tid];if(b.nextSibling&&this._h2.get[b.nextSibling.idd].parent.id==this.tid)return a+1}return a+1+(this.target=="treeGrid"&&
a>=0&&this.tobj._h2.get[this.tobj.rowsBuffer[a].idd].state=="minus"?this.tobj._getOpenLenght(this.tobj.rowsBuffer[a].idd,0):0)};dragContext.prototype.img=function(){return this.target!="grid"&&this.sobj._h2?this.sobj.getItemImage(this.sid):null};dragContext.prototype.slist=function(){for(var a=[],b=0;b<this.sid.length;b++)a[a.length]=this.sid[b][this.source=="tree"?"id":"idd"];return a.join(",")};
dhtmlXGridObject.prototype._drag=function(a,b,c,d){if(this._realfake)return this._fake._drag();var e=this.lastLanding;this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer);var g=c.parentNode,h=a.parentObject;if(!g.idd)g.grid=this,this.dadmodefix=0;var f=new dragContext(0,0,0,g.grid.dadmode==1||g.grid.dadmodec?"sibling":"child");if(h&&h.childNodes)f.set("source","tree").set("sobj",h.treeNod).set("sid",f.sobj._dragged);else{if(!h)return!0;h.treeNod.isTreeGrid&&h.treeNod.isTreeGrid()&&f.set("source",
"treeGrid");f.set("sobj",h.treeNod).set("sid",f.sobj._dragged)}g.grid.isTreeGrid()?f.set("target","treeGrid"):f.set("dropmode","sibling");f.set("tobj",g.grid).set("tid",g.idd);var i=this.getFirstParentOfType(d,"TD");i&&f.set("tExtra",i._cellIndex);i&&f.set("sExtra",f.sobj._dndExtra);f.sobj.dpcpy&&f.set("mode","copy");if(f.tobj._realfake)f.tobj=f.tobj._fake;if(f.sobj._realfake)f.sobj=f.sobj._fake;f.tobj._clearMove();if(h&&h.treeNod&&h.treeNod._nonTrivialRow)h.treeNod._nonTrivialRow(this,f.tid,f.dropmode,
h);else{f.tobj.dragContext=f;if(!f.tobj.callEvent("onDrag",[f.slist(),f.tid,f.sobj,f.tobj,f.sExtra,f.tExtra]))return f.tobj.dragContext=null;var j=[];if(typeof f.sid=="object"){for(var l=f.copy(),k=0;k<f.sid.length;k++)if(l.set("alfa",!k).set("sid",f.sid[k][f.source=="tree"?"id":"idd"]).valid())l.tobj._dragRoutine(l),l.target=="treeGrid"&&l.dropmode=="child"&&l.tobj.openItem(l.tid),j[j.length]=l.nid,l.set("dropmode","sibling").set("tid",l.nid);l.close()}else f.tobj._dragRoutine(f);f.tobj.laterLink&&
f.tobj.laterLink();f.tobj.callEvent("onDrop",[f.slist(),f.tid,j.join(","),f.sobj,f.tobj,f.sExtra,f.tExtra])}f.tobj.dragContext=null;f.close()};
dhtmlXGridObject.prototype._dragRoutine=function(a){if(a.sobj==a.tobj&&a.source=="grid"&&a.mode=="move"&&!this._fake){if(!a.sobj._dndProblematic){var b=a.sobj.rowsAr[a.sid],c=a.sobj.rowsCol._dhx_find(b);a.sobj.rowsCol._dhx_removeAt(a.sobj.rowsCol._dhx_find(b));a.sobj.rowsBuffer._dhx_removeAt(a.sobj.rowsBuffer._dhx_find(b));a.sobj.rowsBuffer._dhx_insertAt(a.ind(),b);if(a.tobj._fake){a.tobj._fake.rowsCol._dhx_removeAt(c);var d=a.tobj._fake.rowsAr[a.sid];d.parentNode.removeChild(d)}a.sobj._insertRowAt(b,
a.ind());a.nid=a.sid;a.sobj.callEvent("onGridReconstructed",[])}}else{var e;this._h2&&typeof a.tid!="undefined"&&a.dropmode=="sibling"&&(this._sbmod||a.tid)?a.alfa&&this._sbmod&&this._h2.get[a.tid].childs.length?(this.openItem(a.tid),e=a.uid().tobj.addRowBefore(a.nid,a.data(),this._h2.get[a.tid].childs[0].id,a.img(),a.childs())):e=a.uid().tobj.addRowAfter(a.nid,a.data(),a.tid,a.img(),a.childs()):e=a.uid().tobj.addRow(a.nid,a.data(),a.ind(),a.pid(),a.img(),a.childs());e._attrs=a.attrs();if(a.source==
"tree"){this.callEvent("onRowAdded",[a.nid]);var g=a.sobj._globalIdStorageFind(a.sid);if(g.childsCount){for(var h=a.copy().set("tid",a.nid).set("dropmode",a.target=="grid"?"sibling":"child"),f=0;f<g.childsCount;f++)a.tobj._dragRoutine(h.set("sid",g.childNodes[f].id)),a.mode=="move"&&f--;h.close()}}else if(a.tobj._copyUserData(a),this.callEvent("onRowAdded",[a.nid]),a.source=="treeGrid"){if(a.sobj==a.tobj)e._xml=a.sobj.rowsAr[a.sid]._xml;var i=a.sobj._h2.get[a.sid];if(i&&i.childs.length){h=a.copy().set("tid",
a.nid);a.target=="grid"?h.set("dropmode","sibling"):(h.tobj.openItem(a.tid),h.set("dropmode","child"));for(var j=i.childs.length,f=0;f<j;f++)if(a.sobj.render_row_tree(null,i.childs[f].id),a.tobj._dragRoutine(h.set("sid",i.childs[f].id)),j!=i.childs.length)f--,j=i.childs.length;h.close()}}if(a.mode=="move"&&(a.sobj[a.source=="tree"?"deleteItem":"deleteRow"](a.sid),a.sobj==a.tobj&&!a.tobj.rowsAr[a.sid]))a.tobj.changeRowId(a.nid,a.sid),a.nid=a.sid}};
dhtmlXGridObject.prototype.gridToGrid=function(a,b){for(var c=[],d=0;d<b.hdr.rows[0].cells.length;d++)c[d]=b.cells(a,d).getValue();return c};dhtmlXGridObject.prototype.checkParentLine=function(a,b){return!this._h2||!b||!a?!1:a.id==b?!0:this.checkParentLine(a.parent,b)};
dhtmlXGridObject.prototype._dragIn=function(a,b,c,d){if(!this.dADTempOff)return 0;var e=this.isTreeGrid(),g=b.parentNode.idd?b.parentNode:b.parentObject;if(this._drag_validate){if(a.parentNode==b.parentNode)return 0;if(e&&this==g.grid&&this.checkParentLine(this._h2.get[a.parentNode.idd],b.parentNode.idd))return 0}if(!this.callEvent("onDragIn",[g.idd||g.id,a.parentNode.idd,g.grid||g.treeNod,a.grid||a.parentNode.grid]))return this._setMove(a,c,d,!0);this._setMove(a,c,d);e&&a.parentNode.expand!=""?(this._autoOpenTimer=
window.setTimeout(new callerFunction(this._autoOpenItem,this),1E3),this._autoOpenId=a.parentNode.idd):this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer);return a};dhtmlXGridObject.prototype._autoOpenItem=function(a,b){b.openItem(b._autoOpenId)};dhtmlXGridObject.prototype._dragOut=function(a){this._clearMove();var b=a.parentNode.parentObject?a.parentObject.id:a.parentNode.idd;this.callEvent("onDragOut",[b]);this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer)};
dhtmlXGridObject.prototype._setMove=function(a,b,c,d){if(a.parentNode.idd){var e=getAbsoluteTop(a),g=getAbsoluteTop(this.objBox);if(e-g>parseInt(this.objBox.offsetHeight)-50)this.objBox.scrollTop=parseInt(this.objBox.scrollTop)+20;if(e-g+parseInt(this.objBox.scrollTop)<parseInt(this.objBox.scrollTop)+30)this.objBox.scrollTop=parseInt(this.objBox.scrollTop)-20;if(d)return 0;if(this.dadmode==2){var h=c-e+(document.body.scrollTop||document.documentElement.scrollTop)-2-a.offsetHeight/2;Math.abs(h)-a.offsetHeight/
6>0?(this.dadmodec=1,this.dadmodefix=h<0?-1:1):this.dadmodec=0}else this.dadmodec=this.dadmode;if(this.dadmodec)this._sdrgc||this._createSdrgc(),this._sdrgc.style.display="block",this._sdrgc.style.top=e-g+parseInt(this.objBox.scrollTop)+(this.dadmodefix>=0?a.offsetHeight:0)+"px";else if(this._llSelD=a,a.parentNode.tagName=="TR")for(var f=0;f<a.parentNode.childNodes.length;f++)h=a.parentNode.childNodes[f],h._bgCol=h.style.backgroundColor,h.style.backgroundColor="#FFCCCC"}};
dhtmlXGridObject.prototype._clearMove=function(){if(this._sdrgc)this._sdrgc.style.display="none";if(this._llSelD&&this._llSelD.parentNode.tagName=="TR")for(var a=this._llSelD.parentNode.childNodes,b=0;b<a.length;b++)a[b].style.backgroundColor=a[b]._bgCol;this._llSelD=null};dhtmlXGridObject.prototype.rowToDragElement=function(a){var b=this.cells(a,0).getValue();return b};
dhtmlXGridObject.prototype._copyUserData=function(a){if(!a.tobj.UserData[a.nid]||a.tobj!=a.sobj){a.tobj.UserData[a.nid]=new Hashtable;var b=a.sobj.UserData[a.sid],c=a.tobj.UserData[a.nid];if(b)c.keys=c.keys.concat(b.keys),c.values=c.values.concat(b.values)}};dhtmlXGridObject.prototype.moveRow=function(a,b,c,d){switch(b){case "row_sibling":this.moveRowTo(a,c,"move","sibling",this,d);break;case "up":this.moveRowUp(a);break;case "down":this.moveRowDown(a)}};
dhtmlXGridObject.prototype.loadCSVFile=function(a,b){this.load(a,b,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(a){this._csvAID=convertStringToBoolean(a)};dhtmlXGridObject.prototype.enableCSVHeader=function(a){this._csvHdr=convertStringToBoolean(a)};dhtmlXGridObject.prototype.setCSVDelimiter=function(a){this.csv.cell=a};dhtmlXGridObject.prototype._csvAID=!0;dhtmlXGridObject.prototype.loadCSVString=function(a){this.parse(a,"csv")};
dhtmlXGridObject.prototype.serializeToCSV=function(a){this.editStop();this._agetm=this._mathSerialization?"getMathValue":this._strictText||a?"getTitle":"getValue";var b=[];if(this._csvHdr)for(var c=1;c<this.hdr.rows.length;c++){for(var d=[],e=0;e<this._cCount;e++)(!this._srClmn||this._srClmn[e])&&d.push(this.getColumnLabel(e,c-1));b.push(this.csvParser.str(d,this.csv.cell,this.csv.row))}for(var e=0,g=this.rowsBuffer.length;e<g;e++){var h=this._serializeRowToCVS(null,e);h!=""&&b.push(h)}return this.csvParser.block(b,
this.csv.row)};
dhtmlXGridObject.prototype._serializeRowToCVS=function(a,b,c,d){var e=[];a||(a=this.render_row(b),this._fake&&!this._fake.rowsAr[a.idd]&&this._fake.render_row(b));if(!this._csvAID)e[e.length]=a.idd;for(var c=c||0,d=d||this._cCount,g=!1,h=c;a.childNodes[c]._cellIndex>h&&c;)c--;for(var f=c;h<d;f++){if(!a.childNodes[f])break;var i=a.childNodes[f]._cellIndex;if((!this._srClmn||this._srClmn[i])&&(!this._serialize_visible||!this._hrrar[i])){for(var j=a.childNodes[f],l=this.cells(a.idd,i);h!=i;)if(h++,e.push(""),
h>=d)break;if(h>=d)break;h++;zxVal=l.cell?l[this._agetm]():"";this._chAttr&&l.wasChanged()&&(g=!0);e[e.length]=zxVal===null?"":zxVal;if(this._ecspn&&j.colSpan&&j.colSpan>1)for(var j=j.colSpan-1,k=0;k<j;k++)e[e.length]="",h++}else h++}return this._onlChAttr&&!g?"":this.csvParser.str(e,this.csv.cell,this.csv.row)};dhtmlXGridObject.prototype.toClipBoard=function(a){window.clipboardData?window.clipboardData.setData("Text",a):(new Clipboard).copy(a)};
dhtmlXGridObject.prototype.fromClipBoard=function(){return window.clipboardData?window.clipboardData.getData("Text"):(new Clipboard).paste()};dhtmlXGridObject.prototype.cellToClipboard=function(a,b){if(!a||!b){if(!this.selectedRows[0])return;a=this.selectedRows[0].idd;b=this.cell._cellIndex}var c=this.cells(a,b);this.toClipBoard(((c.getLabel?c.getLabel():c.getValue())||"").toString())};
dhtmlXGridObject.prototype.updateCellFromClipboard=function(a,b){if(!a||!b){if(!this.selectedRows[0])return;a=this.selectedRows[0].idd;b=this.cell._cellIndex}var c=this.cells(a,b);c[c.setImage?"setLabel":"setValue"](this.fromClipBoard())};
dhtmlXGridObject.prototype.rowToClipboard=function(a){var b="";this._agetm=this._mathSerialization?"getMathValue":this._strictText?"getTitle":"getValue";if(a)b=this._serializeRowToCVS(this.getRowById(a));else for(var c=[],d=0;d<this.selectedRows.length;d++)c[c.length]=this._serializeRowToCVS(this.selectedRows[d]),b=this.csvParser.block(c,this.csv.row);this.toClipBoard(b)};
dhtmlXGridObject.prototype.updateRowFromClipboard=function(a){var b=this.fromClipBoard();if(b){var c=a?this.getRowById(a):this.selectedRows[0];if(c){var d=this.csvParser,b=d.unblock(b,this.csv.cell,this.csv.row)[0];this._csvAID||b.splice(0,1);for(var e=0;e<b.length;e++){var g=this.cells3(c,e);g[g.setImage?"setLabel":"setValue"](b[e])}}}};
dhtmlXGridObject.prototype.csvParser={block:function(a,b){return a.join(b)},unblock:function(a,b,c){for(var d=(a||"").split(c),e=0;e<d.length;e++)d[e]=(d[e]||"").split(b);var g=d.length-1;d[g].length==1&&d[g][0]==""&&d.splice(g,1);return d},str:function(a,b){return a.join(b)}};
dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('\\\\"',"g"),block:function(a,b){return a.join(b)},unblock:function(a,b,c){var d=[[]],e=0;if(!a)return d;for(var g=/^[ ]*"/,h=/"[ ]*$/,f=RegExp(".*"+c+".*$"),i=a.split(b),j=0;j<i.length;j++)if(i[j].match(g)){for(var l=i[j].replace(g,"");!i[j].match(h);)j++,l+=i[j];d[e].push(l.replace(h,"").replace(this._quote_esc,'"'))}else if(i[j].match(f)){var k=i[j].indexOf(c);d[e].push(i[j].substr(0,k));e++;d[e]=[];i[j]=i[j].substr(k+
1);j--}else(i[j]||j!=i.length-1)&&d[e].push(i[j]);var m=d.length-1;m>0&&!d[m].length&&d.splice(m,1);return d},str:function(a,b){for(var c=0;c<a.length;c++)a[c]='"'+a[c].replace(this._quote,'\\"')+'"';return a.join(b)}};
dhtmlXGridObject.prototype.addRowFromClipboard=function(){var a=this.fromClipBoard();if(a)for(var b=this.csvParser.unblock(a,this.csv.cell,this.csv.row),c=0;c<b.length;c++)b[c]&&(a=b[c],a.length&&(this._csvAID?this.addRow(this.getRowsNum()+2,a):(this.rowsAr[a[0]]&&(a[0]=this.uid()),this.addRow(a[0],a.slice(1)))))};dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var a=this.fromClipBoard();a&&this.loadCSVString(a)};
dhtmlXGridObject.prototype.getXLS=function(a){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(a||"")+"xls.php";this.xslform.method="post";this.xslform.target=_isIE?"_blank":"";document.body.appendChild(this.xslform);var b=document.createElement("INPUT");b.type="hidden";b.name="csv";this.xslform.appendChild(b);var c=document.createElement("INPUT");c.type="hidden";c.name="csv_header";this.xslform.appendChild(c)}var d=this.serializeToCSV();this.xslform.childNodes[0].value=
d;for(var e=[],g=this._cCount,h=0;h<g;h++)e.push(this.getHeaderCol(h));e=e.join(",");this.xslform.childNodes[1].value=e;this.xslform.submit()};
dhtmlXGridObject.prototype.printView=function(a,b){var c="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }\t\n  </style>",d=null;if(this._fake)for(var d=[].concat(this._hrrar),e=0;e<this._fake._cCount;e++)this._hrrar[e]=null;c+="<base  href='"+document.location.href+"'></base>";this.parentGrid||(c+=a||"");c+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var g=Math.max(this.rowsBuffer.length,
this.rowsCol.length),h=this._cCount,f=this._printWidth();c+='<tr class="header_row_1">';for(e=0;e<h;e++)if(!this._hrrar||!this._hrrar[e]){for(var i=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(e)]:e],j=i.colSpan||1,l=i.rowSpan||1,k=1;k<j;k++)f[e]+=f[k];c+='<td rowspan="'+l+'" width="'+f[e]+'%" style="background-color:lightgrey;" colspan="'+j+'">'+this.getHeaderCol(e)+"</td>";e+=j-1}c+="</tr>";for(e=2;e<this.hdr.rows.length;e++)if(_isIE){c+="<tr style='background-color:lightgrey' class='header_row_"+
e+"'>";for(var m=this.hdr.rows[e].childNodes,k=0;k<m.length;k++)if(!this._hrrar||!this._hrrar[m[k]._cellIndex])c+=m[k].outerHTML;c+="</tr>"}else c+="<tr class='header_row_"+e+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[e].innerHTML:"")+this.hdr.rows[e].innerHTML+"</tr>";for(e=0;e<g;e++)if(c+="<tr>",this.rowsCol[e]&&this.rowsCol[e]._cntr)c+=this.rowsCol[e].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";else if(!(this.rowsCol[e]&&this.rowsCol[e].style.display=="none")){var n;
if(this.rowsCol[e])n=this.rowsCol[e].idd;else if(this.rowsBuffer[e])n=this.rowsBuffer[e].idd;else continue;for(k=0;k<h;k++)if(!this._hrrar||!this._hrrar[k]){if(this.rowsAr[n]&&this.rowsAr[n].tagName=="TR")var o=this.cells(n,k),q=o._setState?"":o.getContent?o.getContent():o.getImage||o.combo?o.cell.innerHTML:o.getValue();else q=this._get_cell_value(this.rowsBuffer[e],k);var p=this.columnColor[k]?"background-color:"+this.columnColor[k]+";":"",s=this.cellAlign[k]?"text-align:"+this.cellAlign[k]+";":
"",r=o.getAttribute("colspan");c+='<td style="'+p+s+'" '+(r?'colSpan="'+r+'"':"")+">"+(q===""?"&nbsp;":q)+"</td>";r&&(k+=r-1)}c+="</tr>";if(this.rowsCol[e]&&this.rowsCol[e]._expanded){var v=this.cells4(this.rowsCol[e]._expanded.ctrl);c+=v.getSubGrid?'<tr><td colspan="'+h+'">'+v.getSubGrid().printView()+"</td></tr>":'<tr><td colspan="'+h+'">'+this.rowsCol[e]._expanded.innerHTML+"</td></tr>"}}if(this.ftr)for(e=1;e<this.ftr.childNodes[0].rows.length;e++)c+="<tr style='background-color:lightgrey'>"+(this._fake?
this._fake.ftr.childNodes[0].rows[e].innerHTML:"")+this.ftr.childNodes[0].rows[e].innerHTML+"</tr>";c+="</table>";if(this.parentGrid)return c;c+=b||"";var t=window.open("","_blank");t.document.write(c);t.document.write("<script>window.onerror=function(){return true;}<\/script>");t.document.close();if(this._fake)this._hrrar=d};
dhtmlXGridObject.prototype._printWidth=function(){for(var a=[],b=0,c=0;c<this._cCount;c++){var d=this.getColWidth(c);a.push(d);b+=d}for(var e=[],g=0,c=0;c<a.length;c++){var h=Math.floor(a[c]/b*100);g+=h;e.push(h)}e[e.length-1]+=100-g;return e};dhtmlXGridObject.prototype.loadObject=function(){};dhtmlXGridObject.prototype.loadJSONFile=function(){};dhtmlXGridObject.prototype.serializeToObject=function(){};dhtmlXGridObject.prototype.serializeToJSON=function(){};
if(!window.clipboardData)window.clipboardData={_make:function(){var a=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!a)return null;var b=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!b)return null;b.addDataFlavor("text/unicode");var c=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this._p=[a,b,c];return!0},
setData:function(a,b){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){return dhtmlxError.throwError("Clipboard","Access to clipboard denied",[a,b]),""}if(!this._make())return!1;this._p[2].data=b;this._p[1].setTransferData("text/unicode",this._p[2],b.length*2);var d=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,d.kGlobalClipboard)},getData:function(a){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(b){return dhtmlxError.throwError("Clipboard",
"Access to clipboard denied",[a]),""}if(!this._make())return!1;this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var c={},d={};try{this._p[1].getTransferData("text/unicode",d,c)}catch(e){return""}d&&(d=d.value.QueryInterface(Components.interfaces.nsISupportsString));return d?d.data.substring(0,c.value/2):""}};
dhtmlXGridObject.prototype.enableBlockSelection=function(a){if(typeof this._bs_mode=="undefined"){var b=this;this.obj.onmousedown=function(a){b._bs_mode&&b._OnSelectionStart(a||event,this);return!0};this._CSVRowDelimiter=this.csv.row;this.attachEvent("onResize",function(){b._HideSelection();return!0});this.attachEvent("onGridReconstructed",function(){b._HideSelection();return!0});this.attachEvent("onFilterEnd",this._HideSelection)}if(a===!1)return this._bs_mode=!1,this._HideSelection();else this._bs_mode=
!0};dhtmlXGridObject.prototype.forceLabelSelection=function(a){this._strictText=convertStringToBoolean(a)};dhtmlXGridObject.prototype.disableBlockSelection=function(){this.obj.onmousedown=null};
dhtmlXGridObject.prototype._OnSelectionStart=function(a){var b=this;if(a.button!=2){var c=a.srcElement||a.target;if(this.editor){if(c.tagName&&(c.tagName=="INPUT"||c.tagName=="TEXTAREA"))return;this.editStop()}b.setActive(!0);var d=this.getPosition(this.obj),e=a.clientX-d[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),g=a.clientY-d[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));this._CreateSelection(e-
4,g-4);if(c==this._selectionObj)this._HideSelection(),this._startSelectionCell=null;else{for(;c.tagName.toLowerCase()!="td";)c=c.parentNode;this._startSelectionCell=c}if(this._startSelectionCell&&!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex]))return this._startSelectionCell=null;this.obj.onmousedown=null;this.obj[_isIE?"onmouseleave":"onmouseout"]=function(){b._blsTimer&&window.clearTimeout(b._blsTimer)};this.obj.onmmold=this.obj.onmousemove;
this._init_pos=[e,g];this._selectionObj.onmousemove=this.obj.onmousemove=function(c){c=c||a;c.returnValue=!1;b._OnSelectionMove(c)};this._oldDMP=document.body.onmouseup;document.body.onmouseup=function(c){c=c||a;b._OnSelectionStop(c,this);return!0};this.callEvent("onBeforeBlockSelection",[]);document.body.onselectstart=function(){return!1}}};
dhtmlXGridObject.prototype._getCellByPos=function(a,b){this._fake&&(a+=this._fake.objBox.scrollHeight);for(var c=0,d=0;d<this.obj.rows.length;d++)if(b-=this.obj.rows[d].offsetHeight,b<=0){c=this.obj.rows[d];break}if(!c||!c.idd)return null;for(d=0;d<this._cCount;d++)if(a-=this.getColWidth(d),a<=0)for(;;)if(c._childIndexes&&c._childIndexes[d+1]==c._childIndexes[d])c=c.previousSibling;else return this.cells(c.idd,d).cell;return null};
dhtmlXGridObject.prototype._OnSelectionMove=function(a){var b=this;this._ShowSelection();var c=this.getPosition(this.obj),d=a.clientX-c[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),e=a.clientY-c[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if(Math.abs(this._init_pos[0]-d)<5&&Math.abs(this._init_pos[1]-e)<5)return this._HideSelection();var g=this._endSelectionCell;if(this._startSelectionCell==null)this._endSelectionCell=
this._startSelectionCell=this.getFirstParentOfType(a.srcElement||a.target,"TD");else if(a.srcElement||a.target)if((a.srcElement||a.target).className=="dhtmlxGrid_selection")this._endSelectionCell=this._getCellByPos(d,e)||this._endSelectionCell;else{var h=this.getFirstParentOfType(a.srcElement||a.target,"TD");if(h.parentNode.idd)this._endSelectionCell=h}if(this._endSelectionCell&&!this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex]))this._endSelectionCell=
g;var f=this.objBox.scrollLeft+this.objBox.clientWidth,i=this.objBox.scrollTop+this.objBox.clientHeight,j=this.objBox.scrollLeft,l=this.objBox.scrollTop,k=!1;this._blsTimer&&window.clearTimeout(this._blsTimer);d+20>=f?(this.objBox.scrollLeft+=20,k=!0):d-20<j&&(this.objBox.scrollLeft-=20,k=!0);e+20>=i&&!this._realfake?(this.objBox.scrollTop+=20,k=!0):e-20<l&&!this._realfake&&(this.objBox.scrollTop-=20,k=!0);this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell);
if(k){var m=a.clientX,n=a.clientY;this._blsTimer=window.setTimeout(function(){b._OnSelectionMove({clientX:m,clientY:n})},100)}};
dhtmlXGridObject.prototype._OnSelectionStop=function(a){var b=this;this._blsTimer&&window.clearTimeout(this._blsTimer);this.obj.onmousedown=function(c){b._bs_mode&&b._OnSelectionStart(c||a,this);return!0};this.obj.onmousemove=this.obj.onmmold||null;this._selectionObj.onmousemove=null;document.body.onmouseup=this._oldDMP||null;if(parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2)this._HideSelection();else{var c=this.getFirstParentOfType(a.srcElement||a.target,
"TD");if(!c||!c.parentNode.idd)c=this._endSelectionCell;if(!c)return this._HideSelection();for(;c.tagName.toLowerCase()!="td";)c=c.parentNode;this._stopSelectionCell=c;this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell);this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}};
dhtmlXGridObject.prototype._RedrawSelectionPos=function(a,b){var c={};c.LeftTopCol=a._cellIndex;c.LeftTopRow=this.getRowIndex(a.parentNode.idd);c.RightBottomCol=b._cellIndex;c.RightBottomRow=this.getRowIndex(b.parentNode.idd);var d=a.offsetWidth,e=a.offsetHeight,a=this.getPosition(a,this.obj),g=b.offsetWidth,h=b.offsetHeight,b=this.getPosition(b,this.obj);if(a[0]<b[0])var f=a[0],i=b[0]+g;else{var j=c.RightBottomCol;c.RightBottomCol=c.LeftTopCol;c.LeftTopCol=j;f=b[0];i=a[0]+d}if(a[1]<b[1])var l=a[1],
k=b[1]+h;else j=c.RightBottomRow,c.RightBottomRow=c.LeftTopRow,c.LeftTopRow=j,l=b[1],k=a[1]+e;var m=i-f,n=k-l;this._selectionObj.style.left=f+"px";this._selectionObj.style.top=l+"px";this._selectionObj.style.width=m+"px";this._selectionObj.style.height=n+"px";return c};
dhtmlXGridObject.prototype._CreateSelection=function(a,b){if(this._selectionObj==null){var c=document.createElement("div");c.style.position="absolute";c.style.display="none";c.className="dhtmlxGrid_selection";this._selectionObj=c;this._selectionObj.onmousedown=function(a){a=a||event;if(a.button==2||_isMacOS&&a.ctrlKey)return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",a])};this._selectionObj.oncontextmenu=function(a){(a||event).cancelBubble=!0;return!1};this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width=
"0px";this._selectionObj.style.height="0px";this._selectionObj.style.left=a+"px";this._selectionObj.style.top=b+"px";this._selectionObj.startX=a;this._selectionObj.startY=b};dhtmlXGridObject.prototype._ShowSelection=function(){if(this._selectionObj)this._selectionObj.style.display=""};dhtmlXGridObject.prototype._HideSelection=function(){if(this._selectionObj)this._selectionObj.style.display="none";this._selectionArea=null};
dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._selectionArea!=null){var a=[];this._agetm=this._mathSerialization?"getMathValue":this._strictText?"getTitle":"getValue";this._serialize_visible=!0;for(var b=this._selectionArea.LeftTopRow;b<=this._selectionArea.RightBottomRow;b++){var c=this._serializeRowToCVS(this.rowsBuffer[b],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);a[a.length]=this._csvAID?c:c.substr(c.indexOf(this.csv.cell)+1)}a=a.join(this._CSVRowDelimiter);
this.toClipBoard(a);this._serialize_visible=!1}};
dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){var a=this.fromClipBoard();if(this._selectionArea!=null)var b=this._selectionArea.LeftTopRow,c=this._selectionArea.LeftTopCol;else if(this.cell!=null&&!this.editor)b=this.getRowIndex(this.cell.parentNode.idd),c=this.cell._cellIndex;else return!1;var a=this.csvParser.unblock(a,this.csv.cell,this.csv.row),d=b+a.length,e=c+a[0].length;if(e>this._cCount)e=this._cCount;for(var g=0,h=b;h<d;h++){var f=this.render_row(h);if(f!=-1){for(var i=0,
j=c;j<e;j++)if(this._hrrar[j])e=Math.max(e+1,this._cCount);else{var l=this.cells3(f,j);if(l.isDisabled())i++;else{this._onEditUndoRedo&&this._onEditUndoRedo(2,f.idd,j,a[g][i],l.getValue());if(l.combo){for(var k=l.combo.values,m=0;m<k.length;m++)if(a[g][i]==k[m]){l.setValue(l.combo.keys[m]);k=null;break}k!=null&&l.editable?l.setValue(a[g][i++]):i++}else l[l.setImage?"setLabel":"setValue"](a[g][i++]);l.cell.wasChanged=!0}}this.callEvent("onRowPaste",[f.idd]);g++}}};
dhtmlXGridObject.prototype.getSelectedBlock=function(){return this._selectionArea?this._selectionArea:this.getSelectedRowId()!==null?{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()}:null};
dhtmlXGridObject.prototype.enableSmartRendering=function(a,b,c){arguments.length>2&&(b&&!this.rowsBuffer[b-1]&&(this.rowsBuffer[b-1]=0),b=c);this._srnd=convertStringToBoolean(a);this._srdh=this._srdh||20;this._dpref=b||0};dhtmlXGridObject.prototype.enablePreRendering=function(a){this._srnd_pr=parseInt(a||50)};
dhtmlXGridObject.prototype.forceFullLoading=function(a,b){for(var c=0;c<this.rowsBuffer.length;c++)if(!this.rowsBuffer[c]){var d=a||this.rowsBuffer.length-c;if(this.callEvent("onDynXLS",[c,d])){var e=this;this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+c+"&count="+d,function(){window.setTimeout(function(){e.forceFullLoading(a,b)},100)},this._data_type)}return}b&&b.call(this)};dhtmlXGridObject.prototype.setAwaitedRowHeight=function(a){this._srdh=parseInt(a)};
dhtmlXGridObject.prototype._get_view_size=function(){return Math.floor(parseInt(this.entBox.offsetHeight)/this._srdh)+2};
dhtmlXGridObject.prototype._add_filler=function(a,b,c,d){if(!b)return null;var e="__filler__",g=this._prepareRow(e);g.firstChild.style.width="1px";for(var h=1;h<g.childNodes.length;h++)g.childNodes[h].style.display="none";g.firstChild.style.height=b*this._srdh+"px";(c=c||this.rowsCol[a])&&c.nextSibling?c.parentNode.insertBefore(g,c.nextSibling):_isKHTML?this.obj.appendChild(g):this.obj.rows[0].parentNode.appendChild(g);this.callEvent("onAddFiller",[a,b,g,c,d]);return[a,b,g]};
dhtmlXGridObject.prototype._update_srnd_view=function(){var a=Math.floor(this.objBox.scrollTop/this._srdh),b=a+this._get_view_size();if(this.multiLine){for(var c=this.objBox.scrollTop,a=0;c>0;)c-=this.rowsCol[a]?this.rowsCol[a].offsetHeight:this._srdh,a++;b=a+this._get_view_size();a>0&&a--}b+=this._srnd_pr||0;if(b>this.rowsBuffer.length)b=this.rowsBuffer.length;for(var d=a;d<b;d++)if(!this.rowsCol[d]){var e=this._add_from_buffer(d);if(e==-1){if(this.xmlFileUrl){if(this._dpref&&this.rowsBuffer[b-1]){var g=
this._dpref?this._dpref:b-d,h=Math.max(0,b-this._dpref);this._current_load=[h,b-h]}else this._current_load=[d,this._dpref?this._dpref:b-d];this.callEvent("onDynXLS",this._current_load)&&this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+this._current_load[0]+"&count="+this._current_load[1],this._data_type)}return}else if(this._tgle&&(this._updateLine(this._h2.get[this.rowsBuffer[d].idd],this.rowsBuffer[d]),this._updateParentLine(this._h2.get[this.rowsBuffer[d].idd],this.rowsBuffer[d])),
d&&d==(this._realfake?this._fake:this)._r_select)this.selectCell(d,this.cell?this.cell._cellIndex:0,!0)}if(this._fake&&!this._realfake&&this.multiLine)this._fake.objBox.scrollTop=this.objBox.scrollTop};
dhtmlXGridObject.prototype._add_from_buffer=function(a){var b=this.render_row(a);if(b==-1)return-1;if(b._attrs.selected||b._attrs.select)this.selectRow(b,!1,!0),b._attrs.selected=b._attrs.select=null;if(this._cssSP){if(this._h2){var c=this._h2.get[b.idd];b.className+=" "+(c.level%2?this._cssUnEven+" "+this._cssUnEven:this._cssEven+" "+this._cssEven)+"_"+c.level+(this.rowsAr[c.id]._css||"")}}else if(this._cssEven&&a%2==0)b.className=this._cssEven+(b.className.indexOf("rowselected")!=-1?" rowselected ":
" ")+(b._css||"");else if(this._cssUnEven&&a%2==1)b.className=this._cssUnEven+(b.className.indexOf("rowselected")!=-1?" rowselected ":" ")+(b._css||"");for(var d=0;d<this._fillers.length;d++){var e=this._fillers[d];if(e&&e[0]<=a&&e[0]+e[1]>a){var g=a-e[0];g==0?(this._insert_before(a,b,e[2]),this._update_fillers(d,-1,1)):g==e[1]-1?(this._insert_after(a,b,e[2]),this._update_fillers(d,-1,0)):(this._fillers.push(this._add_filler(a+1,e[1]-g-1,e[2],1)),this._insert_after(a,b,e[2]),this._update_fillers(d,
-e[1]+g,0));break}}};dhtmlXGridObject.prototype._update_fillers=function(a,b,c){var d=this._fillers[a];d[1]+=b;d[0]+=c;d[1]?(d[2].firstChild.style.height=parseFloat(d[2].firstChild.style.height)+b*this._srdh+"px",this.callEvent("onUpdateFiller",[d[2]])):(this.callEvent("onRemoveFiller",[d[2]]),d[2].parentNode.removeChild(d[2]),this._fillers.splice(a,1))};
dhtmlXGridObject.prototype._insert_before=function(a,b,c){c.parentNode.insertBefore(b,c);this.rowsCol[a]=b;this.callEvent("onRowInserted",[b,null,c,"before"])};dhtmlXGridObject.prototype._insert_after=function(a,b,c){c.nextSibling?c.parentNode.insertBefore(b,c.nextSibling):c.parentNode.appendChild(b);this.rowsCol[a]=b;this.callEvent("onRowInserted",[b,null,c,"after"])};
function dhtmlXGridFromTable(a,b){typeof a!="object"&&(a=document.getElementById(a));var c=document.createElement("DIV");c.setAttribute("width",a.getAttribute("gridWidth")||(a.offsetWidth?a.offsetWidth+"px":0)||(window.getComputedStyle?window.getComputedStyle(a,null).width:a.currentStyle?a.currentStyle.width:0));c.setAttribute("height",a.getAttribute("gridHeight")||(a.offsetHeight?a.offsetHeight+"px":0)||(window.getComputedStyle?window.getComputedStyle(a,null).height:a.currentStyle?a.currentStyle.height:
0));c.className=a.className;a.className="";if(a.id)c.id=a.id;var d=a,e=a.getAttribute("dragAndDrop");d.parentNode.insertBefore(c,d);var g=d.getAttribute("name")||"name_"+(new Date).valueOf(),h=new dhtmlXGridObject(c);window[g]=h;var f=d.getAttribute("onbeforeinit"),i=d.getAttribute("oninit");f&&eval(f);h.setImagePath(h.imgURL||d.getAttribute("imgpath")||d.getAttribute("image_path")||"");var j=d.getAttribute("skin");j&&h.setSkin(j);b&&b(h);for(var l=d.rows[0],k="",m="",n="",o="",q="",p=0;p<l.cells.length;p++){k+=
(k?",":"")+l.cells[p].innerHTML;var s=l.cells[p].getAttribute("width")||l.cells[p].offsetWidth||(window.getComputedStyle?window.getComputedStyle(l.cells[p],null).width:l.cells[p].currentStyle?l.cells[p].currentStyle.width:0);m+=(m?",":"")+(s=="*"?s:parseInt(s));n+=(n?",":"")+(l.cells[p].getAttribute("align")||"left");o+=(o?",":"")+(l.cells[p].getAttribute("type")||"ed");q+=(q?",":"")+(l.cells[p].getAttribute("sort")||"str");var r=l.cells[p].getAttribute("format");if(r)l.cells[p].getAttribute("type").toLowerCase().indexOf("calendar")!=
-1?h._dtmask=r:h.setNumberFormat(r,p)}h.setHeader(k);h.setInitWidths(m);h.setColAlign(n);h.setColTypes(o);h.setColSorting(q);a.getAttribute("gridHeight")=="auto"&&h.enableAutoHeigth(!0);a.getAttribute("multiline")&&h.enableMultiline(!0);var v=d.getAttribute("lightnavigation");v&&h.enableLightMouseNavigation(v);var t=d.getAttribute("evenrow"),u=d.getAttribute("unevenrow");(t||u)&&h.enableAlterCss(t,u);e&&h.enableDragAndDrop(!0);h.init();a.getAttribute("split")&&h.splitAt(a.getAttribute("split"));h._process_inner_html(d,
1);i&&eval(i);a.parentNode&&a.parentNode.removeChild&&a.parentNode.removeChild(a);return h}dhtmlXGridObject.prototype._process_html=function(a){if(a.tagName&&a.tagName=="TABLE")return this._process_inner_html(a,0);var b=document.createElement("DIV");b.innerHTML=a.xmlDoc.responseText;var c=b.getElementsByTagName("TABLE")[0];this._process_inner_html(c,0)};
dhtmlXGridObject.prototype._process_inner_html=function(a,b){for(var c=a.rows.length,d=b;d<c;d++){var e=a.rows[d].getAttribute("id")||d;this.rowsBuffer.push({idd:e,data:a.rows[d],_parser:this._process_html_row,_locator:this._get_html_data})}this.render_dataset();this.setSizes()};
dhtmlXGridObject.prototype._process_html_row=function(a,b){var c=b.getElementsByTagName("TD"),d=[];a._attrs=this._xml_attrs(b);for(var e=0;e<c.length;e++){var g=c[e],h=g.getAttribute("type");if(a.childNodes[e]){if(h)a.childNodes[e]._cellType=h;a.childNodes[e]._attrs=this._xml_attrs(c[e])}g.firstChild?d.push(g.innerHTML):d.push("");if(g.colSpan>1){a.childNodes[e]._attrs.colspan=g.colSpan;for(var f=1;f<g.colSpan;f++)d.push("")}}for(;e<a.childNodes.length;e++)a.childNodes[e]._attrs={};this._fillRow(a,
this._c_order?this._swapColumns(d):d);return a};dhtmlXGridObject.prototype._get_html_data=function(a,b){for(a=a.firstChild;;){if(!a)return"";a.tagName=="TD"&&b--;if(b<0)break;a=a.nextSibling}return a.firstChild?a.firstChild.data:""};dhtmlxEvent(window,"load",function(){for(var a=document.getElementsByTagName("table"),b=0;b<a.length;b++)a[b].className=="dhtmlxGrid"&&dhtmlXGridFromTable(a[b])});dhtmlxValidation=function(){};
dhtmlxValidation.prototype={trackInput:function(a,b,c,d){dhtmlxEvent(a,"keyup",function(){if(dhtmlxValidation._timer)window.clearTimeout(dhtmlxValidation._timer),dhtmlxValidation._timer=null;dhtmlxValidation._timer=window.setTimeout(function(){if(dhtmlxValidation.checkInput(a,b))a.className=a.className.replace(/[ ]*dhtmlx_live_validation_error/g,""),d&&d(a,a.value,b);else if(!c||c(a,a.value,b))a.className+=" dhtmlx_live_validation_error"},250)})},checkInput:function(a,b){return this.checkValue(a.value,
b)},checkValue:function(a,b){typeof b=="string"&&(b=b.split(","));for(var c=!0,d=0;d<b.length;d++)this["is"+b[d]]?c=c&&this["is"+b[d]](a):alert("Incorrect validation rule: "+b[d]);return c},isEmpty:function(a){return a==""},isNotEmpty:function(a){return!a==""},isValidBoolean:function(a){return!!a.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(a){return!!a.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},
isValidInteger:function(a){return!!a.toString().match(/(^-?\d+$)/)},isValidNumeric:function(a){return!!a.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(a){return!!a.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(a){var b=a.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return b&&!!(b[1]<=9999&&b[2]<=12&&b[3]<=31&&b[4]<=59&&b[5]<=59&&b[6]<=59)||!1},isValidDate:function(a){var b=a.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);
return b&&!!(b[1]<=9999&&b[2]<=12&&b[3]<=31)||!1},isValidTime:function(a){var b=a.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return b&&!!(b[1]<=24&&b[2]<=59&&b[3]<=59)||!1},isValidIPv4:function(a){var b=a.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return b&&!!(b[1]<=255&&b[2]<=255&&b[3]<=255&&b[4]<=255)||!1},isValidCurrency:function(a){return a.toString().match(/^\$?\s?\d+?[\.,\,]?\d+?\s?\$?$/)&&!0||!1},isValidSSN:function(a){return a.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&
!0||!1},isValidSIN:function(a){return a.toString().match(/^\d{9}$/)&&!0||!1}};dhtmlxValidation=new dhtmlxValidation;dhtmlXGridObject.prototype.enableValidation=function(a,b){this._validators=(a=convertStringToBoolean(a))?{data:[]}:!1;if(arguments.length>1)this._validators._live=b;if(!this._validators._event)this._validators._event=this.attachEvent("onEditCell",this.validationEvent)};
dhtmlXGridObject.prototype.setColValidators=function(a){this._validators||this.enableValidation(!0);typeof a=="string"&&(a=a.split(this.delim));this._validators.data=a};
dhtmlXGridObject.prototype.validationEvent=function(a,b,c,d){var e=this._validators;if(!e)return!0;var g=e.data[c]||this.cells(b,c).getAttribute("validate")||"";if(a==1&&g){var h=this.editor||(this._fake||{}).editor;if(!h)return!0;h.cell.className=h.cell.className.replace(/[ ]*dhtmlx_validation_error/g,"");if(e._live){var f=this;dhtmlxValidation.trackInput(h.getInput(),g,function(a,d,e){return f.callEvent("onLiveValidationError",[b,c,d,a,e])},function(a,d,e){return f.callEvent("onLiveValidationCorrect",
[b,c,d,a,e])})}}a==2&&this.validateCell(b,c,g,d);return!0};
dhtmlXGridObject.prototype.validateCell=function(a,b,c,d){c=c||this._validators.data[b]||this.cells(a,b).getAttribute("validate");d=d||this.cells(a,b).getValue();if(c){var e=this.cells(a,b).cell,g=!0;typeof c=="string"&&(c=c.split(this.delim));for(var h=0;h<c.length;h++)dhtmlxValidation.checkValue(d,c[h])||(this.callEvent("onValidationError",[a,b,d,c[h]])&&(e.className+=" dhtmlx_validation_error"),g=!1);if(g)this.callEvent("onValidationCorrect",[a,b,d,c]),e.className=e.className.replace(/[ ]*dhtmlx_validation_error/g,
"");return g}};function eXcell_dhxCalendar(a){if(a&&(this.cell=a,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var b=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[b]);var c=this.grid;b.attachEvent("onClick",function(){this._last_operation_calendar=!0;window.setTimeout(function(){c.editStop()},1);return!0});var d=function(a){(a||event).cancelBubble=!0};dhtmlxEvent(b.base,"click",d);b=null}}eXcell_dhxCalendar.prototype=new eXcell;
eXcell_dhxCalendar.prototype.edit=function(){var a=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1);this.grid._grid_calendarA.setPosition(a[0],a[1]+this.cell.offsetHeight);this.grid._grid_calendarA._last_operation_calendar=!1;this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.cell._cediton=!0;this.val=this.cell.val;this._val=this.cell.innerHTML;var b=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=
function(){};this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y");this.grid._grid_calendarA.setDate(this.val||new Date);this.grid._grid_calendarA.draw=b};eXcell_dhxCalendar.prototype.getDate=function(){return this.cell.val?this.cell.val:null};eXcell_dhxCalendar.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()};
eXcell_dhxCalendar.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){this.cell._cediton=!1;if(this.grid._grid_calendarA._last_operation_calendar){var a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),b=this.grid._grid_calendarA.getDate();this.cell.val=new Date(b);this.setCValue(a,b);this.cell._clearCell=!a;var c=this.val;this.val=this._val;return this.cell.val.valueOf()!=c}return!1}};
eXcell_dhxCalendar.prototype.setValue=function(a){a&&typeof a=="object"?(this.cell.val=a,this.cell._clearCell=!1,this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",a).toString(),this.cell.val)):(!a||a.toString()._dhx_trim()==""?(a="&nbsp",this.cell._clearCell=!0,this.cell.val=""):(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",a.toString(),null,!0)),this.grid._dtmask_inc&&
(a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))),this.cell.val=="NaN"||this.cell.val=="Invalid Date"?(this.cell._clearCell=!0,this.cell.val=new Date,this.setCValue("&nbsp;",0)):this.setCValue((a||"").toString(),this.cell.val))};
function eXcell_dhxCalendarA(a){if(a&&(this.cell=a,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var b=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[b]);var c=this.grid;b.attachEvent("onClick",function(){this._last_operation_calendar=!0;window.setTimeout(function(){c.editStop()},1);return!0});var d=function(a){(a||event).cancelBubble=!0};dhtmlxEvent(b.base,"click",d)}}eXcell_dhxCalendarA.prototype=new eXcell;
eXcell_dhxCalendarA.prototype.edit=function(){var a=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1);this.grid._grid_calendarA.setPosition(a[0]*1+this.cell.offsetWidth,a[1]*1);this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid._grid_calendarA._last_operation_calendar=!1;this.cell._cediton=!0;this.val=this.cell.val;this._val=this.cell.innerHTML;var b=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=
function(){};this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y");this.grid._grid_calendarA.setDate(this.val);this.grid._grid_calendarA.draw=b;this.grid._grid_calendarA.draw();this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.atag);this.obj.style.height=this.cell.offsetHeight-(_isIE?4:2)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=
function(a){(a||event).cancelBubble=!0};this.obj.onmousedown=function(a){(a||event).cancelBubble=!0};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40))this.obj.style.height="36px",this.obj.style.overflow="scroll";this.obj.onselectstart=function(a){a||(a=event);return a.cancelBubble=!0};this.obj.focus();this.obj.focus()};
eXcell_dhxCalendarA.prototype.getDate=function(){return this.cell.val?this.cell.val:null};eXcell_dhxCalendarA.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()};
eXcell_dhxCalendarA.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){this.cell._cediton=!1;if(this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=!1;var a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),b=this.grid._grid_calendarA.getDate();this.cell.val=new Date(b);this.setCValue(a,b);this.cell._clearCell=!a;var c=this.val;this.val=this._val;return this.cell.val.valueOf()!=
(c|0).valueOf()}this.setValue(this.obj.value);c=this.val;this.val=this._val;return this.cell.val.valueOf()!=(c||"").valueOf()}};
eXcell_dhxCalendarA.prototype.setValue=function(a){a&&typeof a=="object"?(this.cell.val=a,this.cell._clearCell=!1,this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",a).toString(),this.cell.val)):(!a||a.toString()._dhx_trim()==""?(a="&nbsp",this.cell._clearCell=!0,this.cell.val=""):(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",a.toString(),null,!0)),this.grid._dtmask_inc&&
(a=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))),this.cell.val=="NaN"||this.cell.val=="Invalid Date"?(this.cell.val=new Date,this.cell._clearCell=!0,this.setCValue("&nbsp;",0)):this.setCValue((a||"").toString(),this.cell.val))};
function eXcell_cntr(a){this.cell=a;this.grid=this.cell.parentNode.grid;if(!this.grid._ex_cntr_ready&&!this._realfake)this.grid._ex_cntr_ready=!0,this.grid._h2&&this.grid.attachEvent("onOpenEn",function(){this.resetCounter(a._cellIndex)}),this.grid.attachEvent("onBeforeSorting",function(){var b=this;window.setTimeout(function(){b.resetCounter&&(b._fake&&!b._realfake&&a._cellIndex<b._fake._cCount?b._fake.resetCounter(a._cellIndex):b.resetCounter(a._cellIndex))},1);return!0});this.edit=function(){};
this.getValue=function(){return this.cell.innerHTML};this.setValue=function(){this.cell.style.paddingRight="2px";var a=this.cell;window.setTimeout(function(){if(a.parentNode){var c=a.parentNode.rowIndex;if(a.parentNode.grid.currentPage||c<0||a.parentNode.grid._srnd)c=a.parentNode.grid.rowsBuffer._dhx_find(a.parentNode)+1;if(!(c<=0))a.innerHTML=c,a.parentNode.grid._fake&&a._cellIndex<a.parentNode.grid._fake._cCount&&a.parentNode.grid._fake.rowsAr[a.parentNode.idd]&&a.parentNode.grid._fake.cells(a.parentNode.idd,
a._cellIndex).setCValue(c),a=null}},100)}}dhtmlXGridObject.prototype.resetCounter=function(a){this._fake&&!this._realfake&&a<this._fake._cCount&&this._fake.resetCounter(a,this.currentPage);var b=a||0;this.currentPage&&(b=(this.currentPage-1)*this.rowsBufferOutSize);for(b=0;b<this.rowsBuffer.length;b++)if(this.rowsBuffer[b]&&this.rowsBuffer[b].tagName=="TR"&&this.rowsAr[this.rowsBuffer[b].idd])this.rowsAr[this.rowsBuffer[b].idd].childNodes[a].innerHTML=b+1};eXcell_cntr.prototype=new eXcell;
function eXcell_link(a){this.cell=a;this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return!0};this.edit=function(){};this.getValue=function(){if(this.cell.firstChild.getAttribute){var a=this.cell.firstChild.getAttribute("target");return this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href")+(a?"^"+a:"")}else return""};this.setValue=function(a){if(typeof a!="number"&&(!a||a.toString()._dhx_trim()==""))return this.setCValue("&nbsp;",c),this.cell._clearCell=!0;var c=
a.split("^");c.length==1?c[1]="":c.length>1&&(c[1]="href='"+c[1]+"'",c[1]+=c.length==3?" target='"+c[2]+"'":" target='_blank'");this.setCValue("<a "+c[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+c[0]+"</a>",c)}}eXcell_link.prototype=new eXcell;eXcell_link.prototype.getTitle=function(){var a=this.cell.firstChild;return a&&a.tagName?a.getAttribute("href"):""};eXcell_link.prototype.getContent=function(){var a=this.cell.firstChild;return a&&a.tagName?a.innerHTML:""};
function dhtmlXCalendarObject(a,b){this.i={};this.uid=function(){if(!this.uidd)this.uidd=(new Date).getTime();return this.uidd++};var c=null,d=typeof a=="string"?document.getElementById(a):a;d&&typeof d=="object"&&d.tagName&&String(d.tagName).toLowerCase()!="input"&&(c=d);d=null;if(typeof a!="object"||!a.length)a=[a];for(var e=0;e<a.length;e++){typeof a[e]=="string"&&(a[e]=document.getElementById(a[e])||null);if(a[e]!=null&&a[e].tagName&&String(a[e].tagName).toLowerCase()=="input")this.i[this.uid()]=
{input:a[e]};else if(!(a[e]instanceof Array)&&a[e]instanceof Object&&(a[e].input!=null||a[e].button!=null)){if(a[e].input!=null&&typeof a[e].input=="string")a[e].input=document.getElementById(a[e].input);if(a[e].button!=null&&typeof a[e].button=="string")a[e].button=document.getElementById(a[e].button);this.i[this.uid()]=a[e]}a[e]=null}this.skinDetect=function(){var a=document.createElement("DIV");a.className="dhtmlxcalendar_skin_detect";document.body.firstChild?document.body.insertBefore(a,document.body.firstChild):
document.body.appendChild(a);var b=a.offsetWidth;a.parentNode.removeChild(a);a=null;return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace",40:"dhx_blue",50:"dhx_black",60:"omega"}[b]||null};this.skin=b!=null?b:typeof dhtmlx!="undefined"&&typeof dhtmlx.skin=="string"?dhtmlx.skin:this.skinDetect()||"dhx_skyblue";this.setSkin=function(a,b){if(this.skin!=a||b)this.skin=a,this.base.className="dhtmlxcalendar_container dhtmlxcalendar_skin_"+this.skin,this._ifrSize()};this.base=document.createElement("DIV");
this.base.className="dhtmlxcalendar_container";this.base.style.display="none";this.base.appendChild(document.createElement("DIV"));c!=null?(this._hasParent=!0,c.appendChild(this.base),c=null):document.body.appendChild(this.base);this.setParent=function(a){this._hasParent&&(typeof a=="object"?a.appendChild(this.base):typeof a=="string"&&document.getElementById(a).appendChild(this.base))};this.setSkin(this.skin,!0);this.base.onclick=function(a){a=a||event;a.cancelBubble=!0};this.base.onmousedown=function(){return!1};
this.loadUserLanguage=function(a){if(this.langData[a]&&(this.lang=a,this.setWeekStartDay(this.langData[this.lang].weekstart),this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d"),this.msCont))for(var b=0,c=0;c<this.msCont.childNodes.length;c++)for(var d=0;d<this.msCont.childNodes[c].childNodes.length;d++)this.msCont.childNodes[c].childNodes[d].innerHTML=this.langData[this.lang].monthesSNames[b++]};this.contMonth=document.createElement("DIV");this.contMonth.className="dhtmlxcalendar_month_cont";
this.contMonth.onselectstart=function(a){a=a||event;a.cancelBubble=!0;return a.returnValue=!1};this.base.firstChild.appendChild(this.contMonth);var g=document.createElement("UL");g.className="dhtmlxcalendar_line";this.contMonth.appendChild(g);var h=document.createElement("LI");h.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";h.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span class='dhtmlxcalendar_month_label_month'>Month</span><span class='dhtmlxcalendar_month_label_year'>Year</span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";
g.appendChild(h);var f=this;h.onclick=function(a){var a=a||event,b=a.target||a.srcElement;if(b.className&&b.className.indexOf("dhtmlxcalendar_month_arrow")===0){f._hideSelector();var c=b.parentNode.firstChild==b?-1:1,d=new Date(f._activeMonth);f._drawMonth(new Date(f._activeMonth.getFullYear(),f._activeMonth.getMonth()+c,1,0,0,0,0));f.callEvent("onArrowClick",[d,new Date(f._activeMonth)])}else b.className&&b.className=="dhtmlxcalendar_month_label_month"?(a.cancelBubble=!0,f._showSelector("month",
31,21,"selector_month",!0)):b.className&&b.className=="dhtmlxcalendar_month_label_year"?(a.cancelBubble=!0,f._showSelector("year",42,21,"selector_year",!0)):f._hideSelector()};this.contDays=document.createElement("DIV");this.contDays.className="dhtmlxcalendar_days_cont";this.base.firstChild.appendChild(this.contDays);this.setWeekStartDay=function(a){a==0&&(a=7);this._wStart=Math.min(Math.max(isNaN(a)?1:a,1),7);this._drawDaysOfWeek()};this._drawDaysOfWeek=function(){if(this.contDays.childNodes.length==
0){var a=document.createElement("UL");a.className="dhtmlxcalendar_line";this.contDays.appendChild(a)}else a=this.contDays.firstChild;var b=this._wStart,c=this.langData[this.lang].daysSNames;c.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var d=0;d<8;d++){if(a.childNodes[d]==null){var e=document.createElement("LI");a.appendChild(e)}else e=a.childNodes[d];d==0?(e.className="dhtmlxcalendar_cell_wn",e.innerHTML="<div class='dhtmlxcalendar_label'>"+(this.langData[this.lang].weekname||
"w")+"</div>"):(e.className="dhtmlxcalendar_cell"+(b>=6?" dhtmlxcalendar_day_weekday_cell":"")+(d==1?"_first":""),e.innerHTML=c[b],++b>7&&(b=1))}this._activeMonth!=null&&this._drawMonth(this._activeMonth)};this._wStart=this.langData[this.lang].weekstart;this.setWeekStartDay(this._wStart);this.contDates=document.createElement("DIV");this.contDates.className="dhtmlxcalendar_dates_cont";this.base.firstChild.appendChild(this.contDates);this.contDates.onclick=function(a){var a=a||event,b=a.target||a.srcElement;
if(b.parentNode!=null&&b.parentNode._date!=null)b=b.parentNode;if(b._date!=null&&!b._css_dis){var c=f._activeDate.getHours(),d=f._activeDate.getMinutes(),e=b._date;if(!f.checkEvent("onBeforeChange")||f.callEvent("onBeforeChange",[new Date(b._date.getFullYear(),b._date.getMonth(),b._date.getDate(),c,d)])){if(f._activeDateCell!=null)f._activeDateCell._css_date=!1,f._updateCellStyle(f._activeDateCell._q,f._activeDateCell._w);var g=f._activeDate.getFullYear()+"_"+f._activeDate.getMonth()!=e.getFullYear()+
"_"+e.getMonth();f._nullDate=!1;f._activeDate=new Date(e.getFullYear(),e.getMonth(),e.getDate(),c,d);f._activeDateCell=b;f._activeDateCell._css_date=!0;f._activeDateCell._css_hover=!1;f._updateCellStyle(f._activeDateCell._q,f._activeDateCell._w);g&&f._drawMonth(f._activeDate);if(f._activeInp&&f.i[f._activeInp]&&f.i[f._activeInp].input!=null)f.i[f._activeInp].input.value=f._dateToStr(new Date(f._activeDate.getTime()));f._hasParent||f._hide();f.callEvent("onClick",[new Date(f._activeDate.getTime())])}}};
this.contDates.onmouseover=function(a){var a=a||event,b=a.target||a.srcElement;if(b.parentNode!=null&&b.parentNode._date!=null)b=b.parentNode;if(b._date!=null&&!(f._lastHover==b||b._css_hover))b._css_hover=!0,f._updateCellStyle(b._q,b._w),f._lastHover=b,f.callEvent("onMouseOver",[new Date(b._date.getFullYear(),b._date.getMonth(),b._date.getDate(),0,0,0,0),a]),b=null};this.contDates.onmouseout=function(a){f._clearDayHover(a||event)};this._lastHover=null;this._clearDayHover=function(a){if(this._lastHover)this._lastHover._css_hover=
!1,this._updateCellStyle(this._lastHover._q,this._lastHover._w),f.callEvent("onMouseOut",[new Date(this._lastHover._date.getFullYear(),this._lastHover._date.getMonth(),this._lastHover._date.getDate(),0,0,0,0),a]),this._lastHover=null};for(e=0;e<6;e++){g=document.createElement("UL");g.className="dhtmlxcalendar_line";this.contDates.appendChild(g);for(var i=0;i<=7;i++)h=document.createElement("LI"),h.className=i==0?"dhtmlxcalendar_cell_wn":"dhtmlxcalendar_cell",g.appendChild(h)}this.contTime=document.createElement("DIV");
this.contTime.className="dhtmlxcalendar_time_cont";this.base.firstChild.appendChild(this.contTime);var j=document.createElement("DIV");j.className="dhtmlxcalendar_bottom";this.base.firstChild.appendChild(j);j=null;this.showTime=function(){this.contTime.style.display="";this._ifrSize()};this.hideTime=function(){this.contTime.style.display="none";this._ifrSize()};g=document.createElement("UL");g.className="dhtmlxcalendar_line";this.contTime.appendChild(g);h=document.createElement("LI");h.className=
"dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";h.innerHTML="<div class='dhtmlxcalendar_time_label'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'>:</span><span class='dhtmlxcalendar_label_minutes'></span>";g.appendChild(h);h.onclick=function(a){var a=a||event,b=a.target||a.srcElement;if(b.tagName!=null&&b.tagName.toLowerCase()=="span"&&b._par==!0&&b.parentNode!=null)b=b.parentNode;if(b.className&&b.className=="dhtmlxcalendar_label_hours")a.cancelBubble=
!0,f._showSelector("hours",3,115,"selector_hours",!0);else if(b.className&&b.className=="dhtmlxcalendar_label_minutes"){a.cancelBubble=!0;var c=59,d=115;if(f._minutesInterval==1){var e=f.getFormatedDate("%i");b.innerHTML="<span class='dhtmlxcalendar_selected_date'>"+e.charAt(0)+"</span>"+e.charAt(1);b.firstChild._par=!0;f._selectorMode=1;d=149}f._minutesInterval==10&&(d=149);f._minutesInterval==15&&(c=46,d=165);f._showSelector("minutes",c,d,"selector_minutes",!0)}else f._hideSelector()};this._activeMonth=
null;this._activeDate=new Date;this._activeDateCell=null;this.setDate=function(a){this._nullDate=typeof a=="undefined"||a===""||!a;a instanceof Date||(a=this._strToDate(String(a||"")),a=="Invalid Date"&&(a=new Date));var b=a.getTime();if(!this._isOutOfRange(b))this._activeDate=new Date(b),this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleHours(),this._updateVisibleMinutes()};this.getDate=function(a){if(this._nullDate)return null;var b=new Date(this._activeDate.getTime());
return a?this._dateToStr(b):b};this._drawMonth=function(a){if(a instanceof Date){isNaN(a.getFullYear())&&(a=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0));this._activeMonth=new Date(a.getFullYear(),a.getMonth(),1,0,0,0,0);this._activeDateCell=null;var b=new Date(this._activeMonth.getTime()),c=b.getDay(),d=c-this._wStart;d<0&&(d+=7);b.setDate(b.getDate()-d);for(var e=a.getMonth(),f=(new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),
0,0,0,0)).getTime(),g=0,h=0;h<6;h++)for(var i=this._wStart,j=0;j<=7;j++)if(j==0){var l=this.getWeekNumber(new Date(b.getFullYear(),b.getMonth(),b.getDate()+g,0,0,0,0));this.contDates.childNodes[h].childNodes[j].innerHTML="<div class='dhtmlxcalendar_label'>"+l+"</div>"}else{var w=new Date(b.getFullYear(),b.getMonth(),b.getDate()+g,0,0,0,0),x=w.getDay(),y=w.getTime(),A="dhtmlxcalendar_label";this._tipData[y]!=null?(this._tipData[y].usePopup&&typeof window.dhtmlXPopup=="function"?(this.contDates.childNodes[h].childNodes[j].removeAttribute("title"),
this._initTooltipPopup()):this.contDates.childNodes[h].childNodes[j].setAttribute("title",this._tipData[y].text),this._tipData[y].showIcon&&(A+=" dhtmlxcalendar_label_title")):this.contDates.childNodes[h].childNodes[j].removeAttribute("title");this.contDates.childNodes[h].childNodes[j].innerHTML="<div class='"+A+"'>"+w.getDate()+"</div>";this.contDates.childNodes[h].childNodes[j]._date=new Date(y);this.contDates.childNodes[h].childNodes[j]._q=h;this.contDates.childNodes[h].childNodes[j]._w=j;this.contDates.childNodes[h].childNodes[j]._css_month=
w.getMonth()==e;this.contDates.childNodes[h].childNodes[j]._css_date=!this._nullDate&&y==f;this.contDates.childNodes[h].childNodes[j]._css_weekend=i>=6;this.contDates.childNodes[h].childNodes[j]._css_dis=this._isOutOfRange(y);this.contDates.childNodes[h].childNodes[j]._css_holiday=this._holidays[y]==!0;this._updateCellStyle(h,j);if(y==f)this._activeDateCell=this.contDates.childNodes[h].childNodes[j];++i>7&&(i=1);g++}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this.langData[this.lang].monthesFNames[a.getMonth()];
this.contMonth.firstChild.firstChild.childNodes[2].innerHTML=a.getFullYear()}};this._updateCellStyle=function(a,b){var c=this.contDates.childNodes[a].childNodes[b],d="dhtmlxcalendar_cell dhtmlxcalendar_cell";d+=c._css_month?"_month":"";d+=c._css_date?"_date":"";d+=c._css_weekend?"_weekend":"";d+=c._css_holiday?"_holiday":"";d+=c._css_dis?"_dis":"";d+=c._css_hover&&!c._css_dis?"_hover":"";c.className=d;c=null};this._minutesInterval=5;this._initSelector=function(a,b){if(!this._selCover)this._selCover=
document.createElement("DIV"),this._selCover.className="dhtmlxcalendar_selector_cover",this.base.firstChild.appendChild(this._selCover);if(!this._sel)this._sel=document.createElement("DIV"),this._sel.className="dhtmlxcalendar_selector_obj",this.base.firstChild.appendChild(this._sel),this._sel.appendChild(document.createElement("TABLE")),this._sel.firstChild.className="dhtmlxcalendar_selector_table",this._sel.firstChild.cellSpacing=0,this._sel.firstChild.cellPadding=0,this._sel.firstChild.border=0,
this._sel.firstChild.appendChild(document.createElement("TBODY")),this._sel.firstChild.firstChild.appendChild(document.createElement("TR")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left",this._sel.firstChild.firstChild.firstChild.childNodes[1].className=
"dhtmlxcalendar_selector_cell_middle",this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right",this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=
function(){this.className="dhtmlxcalendar_selector_cell_left"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(a){a=a||event;a.cancelBubble=!0;f._scrollYears(-1)},this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=
function(a){a=a||event;a.cancelBubble=!0;f._scrollYears(1)},this._sel._ta={},this._selHover=null,this._sel.onmouseover=function(a){var a=a||event,b=a.target||a.srcElement;if(b._cell===!0&&(f._selHover!=b&&f._clearSelHover(),String(b.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)!=null))b.className+=" dhtmlxcalendar_selector_cell_hover",f._selHover=b},this._sel.onmouseout=function(){f._clearSelHover()},this._sel.appendChild(document.createElement("DIV")),this._sel.lastChild.className=
"dhtmlxcalendar_selector_obj_arrow";if(this._sel._ta[a]!=!0){if(a=="month"){this._msCells={};this.msCont=document.createElement("DIV");this.msCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);for(var c=0,d=0;d<4;d++){var e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.msCont.appendChild(e);for(var g=0;g<3;g++){var h=document.createElement("LI");h.innerHTML=this.langData[this.lang].monthesSNames[c];
h.className="dhtmlxcalendar_selector_cell";e.appendChild(h);h._month=c;h._cell=!0;this._msCells[c++]=h}}this.msCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;b._month!=null&&(f._hideSelector(),f._updateActiveMonth(),f._drawMonth(new Date(f._activeMonth.getFullYear(),b._month,1,0,0,0,0)),f._doOnSelectorChange())}}if(a=="year"){this._ysCells={};this.ysCont=document.createElement("DIV");this.ysCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);
for(d=0;d<4;d++){e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.ysCont.appendChild(e);for(g=0;g<3;g++)h=document.createElement("LI"),h.className="dhtmlxcalendar_selector_cell",h._cell=!0,e.appendChild(h)}this.ysCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;b._year!=null&&(f._hideSelector(),f._drawMonth(new Date(b._year,f._activeMonth.getMonth(),1,0,0,0,0)),f._doOnSelectorChange())}}if(a=="hours"){this._hsCells={};this.hsCont=document.createElement("DIV");
this.hsCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);for(d=c=0;d<4;d++){e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.hsCont.appendChild(e);for(g=0;g<6;g++)h=document.createElement("LI"),h.innerHTML=this._fixLength(c,2),h.className="dhtmlxcalendar_selector_cell",e.appendChild(h),h._hours=c,h._cell=!0,this._hsCells[c++]=h}this.hsCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||
a.srcElement;b._hours!=null&&(f._hideSelector(),f._activeDate.setHours(b._hours),f._updateActiveHours(),f._updateVisibleHours(),f._doOnSelectorChange())}}if(a=="minutes"){var i=4,j=3,l=2;this._minutesInterval==1&&(this._selectorMode==1?(i=2,j=3,l=1):(i=2,j=5,l=1,b+="5"));this._minutesInterval==10&&(i=2);this._minutesInterval==15&&(i=1,j=4,b+="4");this._rsCells={};this.rsCont=document.createElement("DIV");this.rsCont.className="dhtmlxcalendar_area_"+b;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);
for(d=c=0;d<i;d++){e=document.createElement("UL");e.className="dhtmlxcalendar_selector_line";this.rsCont.appendChild(e);for(g=0;g<j;g++)h=document.createElement("LI"),h.innerHTML=l>1?this._fixLength(c,l):c,h.className="dhtmlxcalendar_selector_cell",e.appendChild(h),h._minutes=c,h._cell=!0,this._rsCells[c]=h,c+=this._minutesInterval}this.rsCont.onclick=function(a){a=a||event;a.cancelBubble=!0;var b=a.target||a.srcElement;if(b._minutes!=null){if(f._minutesInterval==1){var c=f.getFormatedDate("%i"),
c=f._selectorMode==1?b._minutes.toString()+c.charAt(1):c.charAt(0)+b._minutes.toString();f._activeDate.setMinutes(Number(c));f._hideSelector();if(f._selectorMode==1){f._updateVisibleMinutes(!0);f._selectorMode=2;f._showSelector("minutes",32,149,"selector_minutes",!0);f._updateActiveMinutes();return}else f._selectorMode=1}else f._hideSelector(),f._activeDate.setMinutes(b._minutes),f._updateActiveMinutes();f._updateVisibleMinutes();f._doOnSelectorChange()}}}this._sel._ta[a]=!0}};this._showSelector=
function(a,b,c,d,e){e===!0&&this._sel!=null&&this._isSelectorVisible()&&a==this._sel._t?this._hideSelector():(this.skin=="dhx_terrace"&&(b+={month:14,year:27,hours:19,minutes:24}[a],c+={month:8,year:8,hours:14,minutes:14}[a]),(!this._sel||!this._sel._ta[a])&&this._initSelector(a,d),this._selCover.style.display="",this._sel._t=a,this._sel.style.left=b+"px",this._sel.style.top=c+"px",this._sel.style.display="",this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+d,this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display=
this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display=a=="year"?"":"none",this._sel.childNodes[1].style.width=this._sel.childNodes[0].offsetWidth+"px",this._doOnSelectorShow(a))};this._doOnSelectorShow=function(a){a=="month"&&this._updateActiveMonth();a=="year"&&this._updateYearsList(this._activeMonth);a=="hours"&&this._updateActiveHours();a=="minutes"&&this._updateActiveMinutes()};this._hideSelector=function(){if(this._sel&&(this._sel.style.display="none",this._selCover.style.display=
"none",this._sel._t=="minutes"&&this._minutesInterval==1))this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i"),this._unloadSelector("minutes")};this._isSelectorVisible=function(){return!this._sel?!1:this._sel.style.display!="none"};this._doOnSelectorChange=function(a){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),
a===!0])};this._clearSelHover=function(){if(this._selHover)this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,"")),this._selHover=null};this._unloadSelector=function(a){if(this._sel&&this._sel._ta[a]){if(a=="month"){this._msActive=this.msCont.onclick=null;for(var b in this._msCells)this._msCells[b]._cell=null,this._msCells[b]._month=null,this._msCells[b].parentNode.removeChild(this._msCells[b]),this._msCells[b]=null;for(this._msCells=null;this.msCont.childNodes.length>
0;)this.msCont.removeChild(this.msCont.lastChild);this.msCont.parentNode.removeChild(this.msCont);this.msCont=null}if(a=="year"){this.ysCont.onclick=null;for(b in this._ysCells)this._ysCells[b]._cell=null,this._ysCells[b]._year=null,this._ysCells[b].parentNode.removeChild(this._ysCells[b]),this._ysCells[b]=null;for(this._ysCells=null;this.ysCont.childNodes.length>0;)this.ysCont.removeChild(this.ysCont.lastChild);this.ysCont.parentNode.removeChild(this.ysCont);this.ysCont=null}if(a=="hours"){this._hsActive=
this.hsCont.onclick=null;for(b in this._hsCells)this._hsCells[b]._cell=null,this._hsCells[b]._hours=null,this._hsCells[b].parentNode.removeChild(this._hsCells[b]),this._hsCells[b]=null;for(this._hsCells=null;this.hsCont.childNodes.length>0;)this.hsCont.removeChild(this.hsCont.lastChild);this.hsCont.parentNode.removeChild(this.hsCont);this.hsCont=null}if(a=="minutes"){this._rsActive=this.rsCont.onclick=null;for(b in this._rsCells)this._rsCells[b]._cell=null,this._rsCells[b]._minutes=null,this._rsCells[b].parentNode.removeChild(this._rsCells[b]),
this._rsCells[b]=null;for(this._rsCells=null;this.rsCont.childNodes.length>0;)this.rsCont.removeChild(this.rsCont.lastChild);this.rsCont.parentNode.removeChild(this.rsCont);this.rsCont=null}this._sel._ta[a]=null}};this.setMinutesInterval=function(a){if(a==1||a==5||a==10||a==15)this._minutesInterval=a,this._unloadSelector("minutes")};this._updateActiveMonth=function(){if(typeof this._msActive!="undefined"&&typeof this._msCells[this._msActive]!="undefined")this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell";
this._msActive=this._activeMonth.getMonth();this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateActiveYear=function(){var a=this._activeMonth.getFullYear();if(this._ysCells[a])this._ysCells[a].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateYearsList=function(a){for(var b in this._ysCells)this._ysCells[b]=null,delete this._ysCells[b];for(var c=12*Math.floor(a.getFullYear()/12),d=0;d<4;d++)for(var e=
0;e<3;e++)this.ysCont.childNodes[d].childNodes[e].innerHTML=c,this.ysCont.childNodes[d].childNodes[e]._year=c,this.ysCont.childNodes[d].childNodes[e].className="dhtmlxcalendar_selector_cell",this._ysCells[c++]=this.ysCont.childNodes[d].childNodes[e];this._updateActiveYear()};this._scrollYears=function(a){var b=(a<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+a,c=new Date(b,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(c)};this._updateActiveHours=
function(){if(typeof this._hsActive!="undefined"&&typeof this._hsCells[this._hsActive]!="undefined")this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell";this._hsActive=this._activeDate.getHours();this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)};this._updateActiveMinutes=function(){if(this._rsActive!=
null&&typeof this._rsActive!="undefined"&&typeof this._rsCells[this._rsActive]!="undefined")this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell";this._rsActive=this._minutesInterval==1?this.getFormatedDate("%i").toString().charAt(this._selectorMode==1?0:1):this._activeDate.getMinutes();if(typeof this._rsCells[this._rsActive]!="undefined")this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleMinutes=function(a){var b=
this._fixLength(this._activeDate.getMinutes(),2).toString();a==!0&&(b=b.charAt(0)+"<span class='dhtmlxcalendar_selected_date'>"+b.charAt(1)+"</span>");this.contTime.firstChild.firstChild.childNodes[3].innerHTML=b;if(a==!0)this.contTime.firstChild.firstChild.childNodes[3].lastChild._par=!0};this._fixLength=function(a,b){for(;String(a).length<b;)a="0"+String(a);return a};this._dateFormat="";this._dateFormatRE=null;this.setDateFormat=function(a){this._dateFormat=a;this._dateFormatRE=RegExp(String(this._dateFormat).replace(/%[a-zA-Z]+/g,
function(a){var b=a.replace(/%/,"");switch(b){case "n":case "h":case "j":case "g":case "G":return"\\d{1,2}";case "m":case "d":case "H":case "i":case "s":case "y":return"\\d{2}";case "Y":return"\\d{4}";case "M":return"("+f.langData[f.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case "F":return"("+f.langData[f.lang].monthesFNames.join("|").toLowerCase()+"){1,}";case "D":return"[a-z]{2}";case "a":case "A":return"AM|PM"}return a}),"i")};this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d");
this._getInd=function(a,b){for(var c=0;c<b.length;c++)if(b[c].toLowerCase()==a)return c;return-1};this._strToDate=function(a,b){var b=b||this._dateFormat,c=a.match(/[a-z0-9\u00e9\u00fb\u00e4\u0430-\u044F\u0451]{1,}/gi),d=b.match(/%[a-zA-Z]/g);if(!c||c.length!=d.length)return"Invalid Date";for(var e={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7},g={},h={},i=0;i<d.length;i++)if(typeof e[d[i]]!="undefined"){var j=e[d[i]];g[j]||(g[j]=
[],h[j]=[]);g[j].push(c[i]);h[j].push(d[i])}c=[];d=[];for(i=1;i<=7;i++)if(g[i]!=null)for(var l=0;l<g[i].length;l++)c.push(g[i][l]),d.push(h[i][l]);var u=new Date;u.setDate(1);u.setMinutes(0);u.setSeconds(0);for(i=0;i<c.length;i++)switch(d[i]){case "%d":case "%j":case "%n":case "%m":case "%Y":case "%H":case "%G":case "%i":case "%s":if(!isNaN(c[i]))u[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds"}[d[i]]](Number(c[i])+
(d[i]=="%m"||d[i]=="%n"?-1:0));break;case "%M":case "%F":var w=this._getInd(c[i].toLowerCase(),f.langData[f.lang][{"%M":"monthesSNames","%F":"monthesFNames"}[d[i]]]);w>=0&&u.setMonth(w);break;case "%y":if(!isNaN(c[i])){var x=Number(c[i]);u.setFullYear(x+(x>50?1900:2E3))}break;case "%g":case "%h":isNaN(c[i])||(x=Number(c[i]),x<=12&&x>=0&&u.setHours(x+(this._getInd("pm",c)>=0?x==12?0:12:x==12?-12:0)))}return u};this._dateToStr=function(a,b){if(a instanceof Date)var c=function(a){return String(a).length==
1?"0"+String(a):a},d=function(b){switch(b){case "%d":return c(a.getDate());case "%j":return a.getDate();case "%D":return f.langData[f.lang].daysSNames[a.getDay()];case "%l":return f.langData[f.lang].daysFNames[a.getDay()];case "%m":return c(a.getMonth()+1);case "%n":return a.getMonth()+1;case "%M":return f.langData[f.lang].monthesSNames[a.getMonth()];case "%F":return f.langData[f.lang].monthesFNames[a.getMonth()];case "%y":return c(a.getYear()%100);case "%Y":return a.getFullYear();case "%g":return(a.getHours()+
11)%12+1;case "%h":return c((a.getHours()+11)%12+1);case "%G":return a.getHours();case "%H":return c(a.getHours());case "%i":return c(a.getMinutes());case "%s":return c(a.getSeconds());case "%a":return a.getHours()>11?"pm":"am";case "%A":return a.getHours()>11?"PM":"AM";default:return b}},e=String(b||this._dateFormat).replace(/%[a-zA-Z]/g,d);return e||String(a)};this._updateDateStr=function(a){if(this._dateFormatRE&&a.match(this._dateFormatRE)&&a!=this.getFormatedDate()){var b=this._strToDate(a);
if(b instanceof Date)if(this.checkEvent("onBeforeChange")&&!this.callEvent("onBeforeChange",[new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds())])){if(this.i!=null&&this._activeInp!=null&&this.i[this._activeInp]!=null&&this.i[this._activeInp].input!=null)this.i[this._activeInp].input.value=this.getFormatedDate()}else this._nullDate=!1,this._activeDate=b,this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleMinutes(),this._updateVisibleHours(),
this._sel&&this._isSelectorVisible()&&this._doOnSelectorShow(this._sel._t),this._doOnSelectorChange(!0)}};this.showMonth=function(a){typeof a=="string"&&(a=this._strToDate(a));a instanceof Date&&this._drawMonth(a)};this.setFormatedDate=function(a,b,c,d){var e=this._strToDate(b,a);if(d)return e;this.setDate(e)};this.getFormatedDate=function(a,b){if(!(b&&b instanceof Date)){if(this._nullDate)return"";b=new Date(this._activeDate)}return this._dateToStr(b,a)};this.getWeekNumber=function(a){typeof a==
"string"&&(a=this._strToDate(a));if(!(a instanceof Date))return"Invalid Date";if(typeof this._ftDay=="undefined")this._ftDay=4;var b=this._wStart,c=b+7,d=4,e=new Date(a.getFullYear(),0,1,0,0,0,0),f=e.getDay();f==0&&(f=7);d<b&&(d+=7,f+=7);var g=0;f>=b&&f<=d||(g=1);var h=f-b,i=new Date(a.getFullYear(),0,1-h+g*7,0,0,0,0),j=6048E5,l=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1,0,0,0,0),w=Math.ceil((l.getTime()-i.getTime())/j);return w};this.showWeekNumbers=function(){this.base.firstChild.className=
"dhtmlxcalendar_wn"};this.hideWeekNumbers=function(){this.base.firstChild.className=""};this.show=function(a){if(!a&&this._hasParent)this._show();else if(typeof a=="object"&&typeof a._dhtmlxcalendar_uid!="undefined"&&this.i[a._dhtmlxcalendar_uid]==a)this._show(a._dhtmlxcalendar_uid);else{if(typeof a=="undefined")for(var b in this.i)a||(a=b);a&&this._show(a)}};this.hide=function(){this._isVisible()&&this._hide()};this.isVisible=function(){return this._isVisible()};this.draw=function(){this.show()};
this.close=function(){this.hide()};this._activeInp=null;this.pos="bottom";this.setPosition=function(a,b){this._py=this._px=null;if(a=="right"||a=="bottom")this.pos=a;else{this.pos="int";if(typeof a!="undefined"&&!isNaN(a))this.base.style.left=a+"px",this._px=a;if(typeof b!="undefined"&&!isNaN(b))this.base.style.top=b+"px",this._py=b;this._ifrSize()}};this._show=function(a,b){if(b===!0&&this._activeInp==a&&this._isVisible())this._hide();else{this.base.style.visibility="hidden";this.base.style.display=
"";if(a){var c=this.i[a].input||this.i[a].button,d=navigator.appVersion.indexOf("MSIE")!=-1,e=Math.max((d?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),f=e+(d?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight);this.pos=="right"?(this.base.style.left=this._getLeft(c)+c.offsetWidth-1+"px",this.base.style.top=Math.min(this._getTop(c),f-this.base.offsetHeight)+
"px"):this.pos=="bottom"?(this.base.style.left=this._getLeft(c)+"px",this.base.style.top=this._getTop(c)+c.offsetHeight+1+"px"):(this.base.style.left=(this._px||0)+"px",this.base.style.top=(this._py||0)+"px");this._activeInp=a;c=null}else this._px&&this._py?(this.base.style.left=this._px+"px",this.base.style.top=this._py+"px"):(this.base.style.left="0px",this.base.style.top="0px");this._hideSelector();this.base.style.visibility="visible";this._ifrSize();if(this._ifr)this._ifr.style.display="";this.callEvent("onShow",
[])}};this._hide=function(){this._hideSelector();this.base.style.display="none";this._activeInp=null;if(this._ifr)this._ifr.style.display="none";this.callEvent("onHide",[])};this._isVisible=function(){return this.base.style.display!="none"};this._getLeft=function(a){return this._posGetOffset(a).left};this._getTop=function(a){return this._posGetOffset(a).top};this._posGetOffsetSum=function(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop),c+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:b,left:c}};
this._posGetOffsetRect=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}};this._posGetOffset=function(a){return this[a.getBoundingClientRect?"_posGetOffsetRect":"_posGetOffsetSum"](a)};this._rangeActive=!1;this._rangeTo=this._rangeFrom=
null;this._rangeSet={};this.setInsensitiveDays=function(a){for(var b=this._extractDates(a),c=0;c<b.length;c++)this._rangeSet[(new Date(b[c].getFullYear(),b[c].getMonth(),b[c].getDate(),0,0,0,0)).getTime()]=!0;this._drawMonth(this._activeMonth)};this.clearInsensitiveDays=function(){this._clearRangeSet();this._drawMonth(this._activeMonth)};this._holidays={};this.setHolidays=function(a){if(a==null)this._clearHolidays();else if(a!=null)for(var b=this._extractDates(a),c=0;c<b.length;c++)this._holidays[(new Date(b[c].getFullYear(),
b[c].getMonth(),b[c].getDate(),0,0,0,0)).getTime()]=!0;this._drawMonth(this._activeMonth)};this._extractDates=function(a){if(typeof a=="string"||a instanceof Date)a=[a];for(var b=[],c=0;c<a.length;c++)if(typeof a[c]=="string")for(var d=a[c].split(","),e=0;e<d.length;e++)b.push(this._strToDate(d[e]));else a[c]instanceof Date&&b.push(a[c]);return b};this._clearRange=function(){this._rangeActive=!1;this._rangeTo=this._rangeFrom=this._rangeType=null};this._clearRangeSet=function(){for(var a in this._rangeSet)this._rangeSet[a]=
null,delete this._rangeSet[a]};this._clearHolidays=function(){for(var a in this._holidays)this._holidays[a]=null,delete this._holidays[a]};this._isOutOfRange=function(a){if(this._rangeSet[a]==!0)return!0;if(this._rangeActive){if(this._rangeType=="in"&&(a<this._rangeFrom||a>this._rangeTo))return!0;if(this._rangeType=="out"&&a>=this._rangeFrom&&a<=this._rangeTo)return!0;if(this._rangeType=="from"&&a<this._rangeFrom)return!0;if(this._rangeType=="to"&&a>this._rangeTo)return!0}var b=new Date(a);return this._rangeWeek&&
this._rangeWeekData[b.getDay()]===!0?!0:this._rangeMonth&&this._rangeMonthData[b.getDate()]===!0?!0:this._rangeYear&&this._rangeYearData[b.getMonth()+"_"+b.getDate()]===!0?!0:!1};this.clearSensitiveRange=function(){this._clearRange();this._drawMonth(this._activeMonth)};this.setSensitiveRange=function(a,b,c){var d=!1;if(a!=null&&b!=null){a instanceof Date||(a=this._strToDate(a));b instanceof Date||(b=this._strToDate(b));if(a.getTime()>b.getTime())return;this._rangeFrom=(new Date(a.getFullYear(),a.getMonth(),
a.getDate(),0,0,0,0)).getTime();this._rangeTo=(new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0)).getTime();this._rangeActive=!0;this._rangeType="in";d=!0}if(!d&&a!=null&&b==null)a instanceof Date||(a=this._strToDate(a)),this._rangeFrom=(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime(),this._rangeTo=null,c===!0&&this._rangeFrom++,this._rangeActive=!0,this._rangeType="from",d=!0;if(!d&&a==null&&b!=null)b instanceof Date||(b=this._strToDate(b)),this._rangeFrom=null,this._rangeTo=
(new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0)).getTime(),c===!0&&this._rangeTo--,this._rangeActive=!0,this._rangeType="to",d=!0;d&&this._drawMonth(this._activeMonth)};this.setInsensitiveRange=function(a,b){if(a!=null&&b!=null){if(a instanceof Date||(a=this._strToDate(a)),b instanceof Date||(b=this._strToDate(b)),!(a.getTime()>b.getTime()))this._rangeFrom=(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime(),this._rangeTo=(new Date(b.getFullYear(),b.getMonth(),b.getDate(),
0,0,0,0)).getTime(),this._rangeActive=!0,this._rangeType="out",this._drawMonth(this._activeMonth)}else a!=null&&b==null?this.setSensitiveRange(null,a,!0):a==null&&b!=null&&this.setSensitiveRange(b,null,!0)};this.disableDays=function(a,b){if(a=="week"){typeof b!="object"&&typeof b.length=="undefined"&&(b=[b]);if(!this._rangeWeekData)this._rangeWeekData={};for(var c in this._rangeWeekData)this._rangeWeekData[c]=!1,delete this._rangeWeekData[c];for(var d=0;d<b.length;d++)this._rangeWeekData[b[d]]=!0,
b[d]==7&&(this._rangeWeekData[0]=!0);this._rangeWeek=!0}if(a=="month"){typeof b!="object"&&typeof b.length=="undefined"&&(b=[b]);if(!this._rangeMonthData)this._rangeMonthData={};for(c in this._rangeMonthData)this._rangeMonthData[c]=!1,delete this._rangeMonthData[c];for(d=0;d<b.length;d++)this._rangeMonthData[b[d]]=!0;this._rangeMonth=!0}if(a=="year"){var e=this._extractDates(b);if(!this._rangeYearData)this._rangeYearData={};for(c in this._rangeYearData)this._rangeYearData[c]=!1,delete this._rangeYearData[c];
for(d=0;d<e.length;d++)this._rangeYearData[e[d].getMonth()+"_"+e[d].getDate()]=!0;this._rangeYear=!0}this._drawMonth(this._activeMonth)};this.enableDays=function(a){if(a=="week")this._rangeWeek=!1;if(a=="month")this._rangeMonth=!1;if(a=="year")this._rangeYear=!1;this._drawMonth(this._activeMonth)};this._tipData={};this._tipTM=null;this._tipTMTime=400;this._tipEvs=!1;this._tipCellDim=this._tipCellDate=this._tipPopup=null;this.setTooltip=function(a,b,c,d){for(var e=this._extractDates(a),f=0;f<e.length;f++){var g=
(new Date(e[f].getFullYear(),e[f].getMonth(),e[f].getDate(),0,0,0,0)).getTime();this._tipData[g]={text:b,showIcon:c,usePopup:d}}this._drawMonth(this._activeMonth)};this.clearTooltip=function(a){for(var b=this._extractDates(a),c=0;c<b.length;c++){var d=(new Date(b[c].getFullYear(),b[c].getMonth(),b[c].getDate(),0,0,0,0)).getTime();this._tipData[d]=null;delete this._tipData[d]}this._drawMonth(this._activeMonth)};this._initTooltipPopup=function(){if(!this._tipEvs)this.attachEvent("onMouseOver",function(a){var b=
(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime();if(this._tipData[b]!=null)this._tipTM&&window.clearTimeout(this._tipTM),this._tipCellDate=a,this._tipCellDim=this.getCellDimension(a),this._tipText=this._tipData[b].text,this._tipTM=window.setTimeout(this._showTooltipPopup,this._tipTMTime)}),this.attachEvent("onMouseOut",this._hideTooltipPopup),this._tipEvs=!0};this._showTooltipPopup=function(){if(!f._tipPopup)f._tipPopup=new dhtmlXPopup({mode:"top"});f._tipPopup.attachHTML(f._tipText);
f._tipPopup.show(f._tipCellDim.x,f._tipCellDim.y,f._tipCellDim.w,f._tipCellDim.h);f.callEvent("onPopupShow",[f._tipCellDate])};this._hideTooltipPopup=function(){this._tipTM&&window.clearTimeout(this._tipTM);this._tipPopup!=null&&this._tipPopup.isVisible()&&(this._tipPopup.hide(),this.callEvent("onPopupHide",[this._tipCellDate]))};this.getPopup=function(){return this._tipPopup};this.getCellDimension=function(a){typeof a=="string"&&(a=this._strToDate(a));if(!(a instanceof Date))return null;for(var b=
(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)).getTime(),c=null,d=0;d<this.contDates.childNodes.length;d++)for(var e=0;e<this.contDates.childNodes[d].childNodes.length;e++){var f=this.contDates.childNodes[d].childNodes[e];f._date!=null&&f._date.getTime()==b&&(c={x:this._getLeft(f),y:this._getTop(f),w:f.offsetWidth,h:f.offsetHeight});f=null}return c};this._updateFromInput=function(a){if(this._nullInInput&&a.value.replace(/\s/g,"").length==0){if(this.checkEvent("onBeforeChange")&&!this.callEvent("onBeforeChange",
[null])){if(this.i!=null&&this._activeInp!=null&&this.i[this._activeInp]!=null&&this.i[this._activeInp].input!=null)this.i[this._activeInp].input.value=this.getFormatedDate();return}this.setDate(null)}else this._updateDateStr(a.value);a=null};this._doOnClick=function(a){var a=a||event,b=a.target||a.srcElement;if(b._dhtmlxcalendar_uid&&b._dhtmlxcalendar_uid!=f._activeInp&&f._isVisible()&&f._activeInp)f._hide();else if(!b._dhtmlxcalendar_uid||!f.i[b._dhtmlxcalendar_uid])f._isSelectorVisible()?f._hideSelector():
!f._hasParent&&f._isVisible()&&f._hide()};this._doOnKeyDown=function(a){a=a||event;if(a.keyCode==27||a.keyCode==13)f._isSelectorVisible()?f._hideSelector():f._isVisible()&&!f._hasParent&&f._hide()};this._doOnInpClick=function(a){var a=a||event,b=a.target||a.srcElement;b._dhtmlxcalendar_uid&&(f._listenerEnabled||f._updateFromInput(b),f._show(b._dhtmlxcalendar_uid,!0))};this._doOnInpKeyUp=function(a){var a=a||event,b=a.target||a.srcElement;a.keyCode!=13&&b._dhtmlxcalendar_uid&&(f._listenerEnabled||
f._updateFromInput(b))};this._doOnBtnClick=function(a){var a=a||event,b=a.target||a.srcElement;b._dhtmlxcalendar_uid&&(f.i[b._dhtmlxcalendar_uid].input!=null&&f._updateFromInput(f.i[b._dhtmlxcalendar_uid].input),f._show(b._dhtmlxcalendar_uid,!0))};this._doOnUnload=function(){f&&f.unload&&f.unload()};window.addEventListener?(document.body.addEventListener("click",f._doOnClick,!1),window.addEventListener("keydown",f._doOnKeyDown,!1),window.addEventListener("unload",f._doOnUnload,!1)):(document.body.attachEvent("onclick",
f._doOnClick),document.body.attachEvent("onkeydown",f._doOnKeyDown),window.attachEvent("onunload",f._doOnUnload));this.attachObj=function(a){typeof a=="string"&&(a=document.getElementById(a));var b=this.uid();this.i[b]=a;this._attachEventsToObject(b)};this.detachObj=function(a){typeof a=="string"&&(a=document.getElementById(a));var b=a._dhtmlxcalendar_uid;if(this.i[b]!=null)this._detachEventsFromObject(b),this.i[b]._dhtmlxcalendar_uid=null,this.i[b]=null,delete this.i[b]};this._attachEventsToObject=
function(a){if(this.i[a].button!=null)this.i[a].button._dhtmlxcalendar_uid=a,window.addEventListener?this.i[a].button.addEventListener("click",f._doOnBtnClick,!1):this.i[a].button.attachEvent("onclick",f._doOnBtnClick);else if(this.i[a].input!=null)this.i[a].input._dhtmlxcalendar_uid=a,window.addEventListener?(this.i[a].input.addEventListener("click",f._doOnInpClick,!1),this.i[a].input.addEventListener("keyup",f._doOnInpKeyUp,!1)):(this.i[a].input.attachEvent("onclick",f._doOnInpClick),this.i[a].input.attachEvent("onkeyup",
f._doOnInpKeyUp))};this.enableListener=function(a){a&&(window.addEventListener?(a.addEventListener("focus",f._listenerEvFocus,!1),a.addEventListener("blur",f._listenerEvBlur,!1)):(a.attachEvent("onfocus",f._listenerEvFocus),a.attachEvent("onblur",f._listenerEvBlur)),a=null)};this.disableListener=function(a){if(a)a._f0=!1,this._tmListener&&window.clearTimeout(this._tmListener),window.addEventListener?(a.removeEventListener("focus",f._listenerEvFocus,!1),a.removeEventListener("blur",f._listenerEvBlur,
!1)):(a.detachEvent("onfocus",f._listenerEvFocus),a.detachEvent("onblur",f._listenerEvBlur)),a=null};this._startListener=function(a){this._tmListener&&window.clearTimeout(this._tmListener);if(typeof a._v1=="undefined")a._v1=a.value;if(a._v1!=a.value)this._updateFromInput(a),a._v1=a.value;if(a._f0)this._tmListener=window.setTimeout(function(){f._startListener(a)},100)};this._listenerEvFocus=function(a){var a=a||event,b=a.target||a.srcElement;b._f0=!0;f._startListener(b);b=null};this._listenerEvBlur=
function(a){var a=a||event,b=a.target||a.srcElement;b._f0=!1;b=null};this._detachEventsFromObject=function(a){this.i[a].button!=null?window.addEventListener?this.i[a].button.removeEventListener("click",f._doOnBtnClick,!1):this.i[a].button.detachEvent("onclick",f._doOnBtnClick):this.i[a].input!=null&&(window.addEventListener?(this.i[a].input.removeEventListener("click",f._doOnInpClick,!1),this.i[a].input.removeEventListener("keyup",f._doOnInpKeyUp,!1)):(this.i[a].input.detachEvent("onclick",f._doOnInpClick),
this.i[a].input.detachEvent("onkeyup",f._doOnInpKeyUp)))};for(var l in this.i)this._attachEventsToObject(l);this.evs={};this.attachEvent=function(a,b){var c=this.uid();this.evs[c]={name:String(a).toLowerCase(),func:b};return c};this.detachEvent=function(a){if(this.evs[a])this.evs[a].name=null,this.evs[a].func=null,this.evs[a]=null,delete this.evs[a]};this.callEvent=function(a,b){var c=!0,d=String(a).toLowerCase(),b=b||[],e;for(e in this.evs)if(this.evs[e].name==d)var f=this.evs[e].func.apply(this,
b),c=c&&f;return c};this.checkEvent=function(a){var b=!1,c=String(a).toLowerCase(),d;for(d in this.evs)b=b||this.evs[d].name==c;return b};this.unload=function(){this.uidd=this.uid=this._lastHover=this._dateFormatRE=this._dateFormat=this._activeMonth=this._activeInp=this._activeDateCell=this._activeDate=null;this._tmListener&&window.clearTimeout(this._tmListener);this._tmListener=null;window.addEventListener?(document.body.removeEventListener("click",f._doOnClick,!1),window.removeEventListener("keydown",
f._doOnKeyDown,!1),window.removeEventListener("unload",f._doOnUnload,!1)):(document.body.detachEvent("onclick",f._doOnClick),document.body.detachEvent("onkeydown",f._doOnKeyDown),window.detachEvent("onunload",f._doOnKeyDown));this._doOnUnload=this._doOnKeyDown=this._doOnClick=null;for(var a in this.i)this.i[a]._dhtmlxcalendar_uid=null,this._detachEventsFromObject(a),this.disableListener(this.i[a].input),this.i[a]=null,delete this.i[a];this._doOnInpKeyUp=this._doOnInpClick=this.i=null;for(a in this.evs)this.detachEvent(a);
this.callEvent=this.checkEvent=this.detachEvent=this.attachEvent=this.evs=null;this.contMonth.onselectstart=null;this.contMonth.firstChild.firstChild.onclick=null;this.contMonth.firstChild.firstChild.firstChild.onmouseover=null;this.contMonth.firstChild.firstChild.firstChild.onmouseout=null;this.contMonth.firstChild.firstChild.lastChild.onmouseover=null;for(this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;this.contMonth.firstChild.firstChild.childNodes.length>0;)this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild);
this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);this.contMonth.removeChild(this.contMonth.firstChild);this.contMonth.parentNode.removeChild(this.contMonth);for(this.contMonth=null;this.contDays.firstChild.childNodes.length>0;)this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild);this.contDays.removeChild(this.contDays.firstChild);this.contDays.parentNode.removeChild(this.contDays);this.contDays=null;this.contDates.onclick=null;this.contDates.onmouseover=
null;for(this.contDates.onmouseout=null;this.contDates.childNodes.length>0;){for(;this.contDates.lastChild.childNodes.length>0;)this.contDates.lastChild.lastChild._css_date=null,this.contDates.lastChild.lastChild._css_month=null,this.contDates.lastChild.lastChild._css_weekend=null,this.contDates.lastChild.lastChild._css_hover=null,this.contDates.lastChild.lastChild._date=null,this.contDates.lastChild.lastChild._q=null,this.contDates.lastChild.lastChild._w=null,this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild);
this.contDates.removeChild(this.contDates.lastChild)}this.contDates.parentNode.removeChild(this.contDates);this.contDates=null;for(this.contTime.firstChild.firstChild.onclick=null;this.contTime.firstChild.firstChild.childNodes.length>0;)this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild);this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);this.contTime.removeChild(this.contTime.firstChild);this.contTime.parentNode.removeChild(this.contTime);
this._lastHover=this.contTime=null;this._unloadSelector("month");this._unloadSelector("year");this._unloadSelector("hours");this._unloadSelector("minutes");if(this._selCover)this._selCover.parentNode.removeChild(this._selCover),this._selCover=null;if(this._sel){for(a in this._sel._ta)this._sel._ta[a]=null;this._sel._ta=null;this._sel._t=null;this._sel.onmouseover=null;for(this._sel.onmouseout=null;this._sel.firstChild.firstChild.firstChild.childNodes.length>0;)this._sel.firstChild.firstChild.firstChild.lastChild.onclick=
null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null,this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild);this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);for(this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);this._sel.childNodes.length>0;)this._sel.removeChild(this._sel.lastChild);this._sel.parentNode.removeChild(this._sel);
this._sel=null}this.base.onclick=null;this.base.onmouseout=null;this.base.parentNode.removeChild(this.base);this.unload=this.showTime=this.show=this.setYearsRange=this.setDateFormat=this.setDate=this.hideTime=this.hide=this.enableIframe=this._updateYearsList=this._updateVisibleMinutes=this._updateVisibleHours=this._updateDateStr=this._updateCellStyle=this._updateActiveYear=this._updateActiveMonth=this._updateActiveMinutes=this._updateActiveHours=this._strToDate=this._showSelector=this._show=this._scrollYears=
this._posGetOffsetSum=this._posGetOffsetRect=this._posGetOffset=this._isVisible=this._isSelectorVisible=this._initSelector=this._hideSelector=this._hide=this._ifrSize=this._getTop=this._getLeft=this._fixLength=this._drawMonth=this._doOnSelectorShow=this._doOnSelectorChange=this._clearSelHover=this._clearDayHover=this.base=null;if(this._tipPopup!=null)this._tipPopup.unload(),this._tipPopup=null;for(a in this)delete this[a];a=f=null};this.setDate(this._activeDate);return this}
dhtmlXCalendarObject.prototype.setYearsRange=function(){};dhtmlXCalendarObject.prototype.lang="en";dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",monthesFNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthesSNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),daysFNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),daysSNames:"Su,Mo,Tu,We,Th,Fr,Sa".split(","),weekstart:1,weekname:"w"}};
dhtmlXCalendarObject.prototype.enableIframe=function(a){if(a==!0){if(!this._ifr)this._ifr=document.createElement("IFRAME"),this._ifr.frameBorder=0,this._ifr.border=0,this._ifr.setAttribute("src","javascript:false;"),this._ifr.className="dhtmlxcalendar_ifr",this._ifr.onload=function(){this.onload=null;this.contentWindow.document.open("text/html","replace");this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")},
this.base.parentNode.insertBefore(this._ifr,this.base),this._ifrSize()}else if(this._ifr)this._ifr.parentNode.removeChild(this._ifr),this._ifr=null};dhtmlXCalendarObject.prototype._ifrSize=function(){if(this._ifr)this._ifr.style.left=this.base.style.left,this._ifr.style.top=this.base.style.top,this._ifr.style.width=this.base.offsetWidth+"px",this._ifr.style.height=this.base.offsetHeight+"px"};dhtmlxCalendarObject=dhtmlXCalendarObject;
function dhtmlXComboFromSelect(a,b){typeof a=="string"&&(a=document.getElementById(a));b=b||a.getAttribute("width")||(window.getComputedStyle?window.getComputedStyle(a,null).width:a.currentStyle?a.currentStyle.width:0);if(!b||b=="auto"||b.indexOf("em")!=-1)b=a.offsetWidth||100;var c=document.createElement("SPAN");a.parentNode.insertBefore(c,a);a.style.display="none";for(var d=a.getAttribute("opt_type"),e=new dhtmlXCombo(c,a.name,b,d,a.tabIndex),g=[],h=-1,f=0;f<a.options.length;f++){a.options[f].selected&&
(h=f);var i=a.options[f].innerHTML,j=a.options[f].getAttribute("value");if(typeof j=="undefined"||j===null)j=i;g[f]={value:j,text:i,img_src:a.options[f].getAttribute("img_src")}}g.length&&e.addOption(g);a.parentNode.removeChild(a);if(h>=0)e._skipFocus=!0,e.selectOption(h,null,!0);a.onchange&&e.attachEvent("onChange",a.onchange);a.style.direction=="rtl"&&e.setRTL&&e.setRTL(!0);return e}var dhtmlXCombo_optionTypes=[];
function dhtmlXCombo(a,b,c,d,e){typeof a=="string"&&(a=document.getElementById(a));this.dhx_Event();this.optionType=d!=window.undefined&&dhtmlXCombo_optionTypes[d]?d:"default";this._optionObject=dhtmlXCombo_optionTypes[this.optionType];this._disabled=!1;this.readonlyDelay=750;this.filterEntities="[,],{,},(,),+,*,\\,?,.,$,^".split(",");if(!window.dhx_glbSelectAr)window.dhx_glbSelectAr=[],window.dhx_openedSelect=null,window.dhx_SelectId=1,dhtmlxEvent(document.body,"click",this.closeAll),dhtmlxEvent(document.body,
"keydown",function(a){try{(a||event).keyCode==9&&window.dhx_glbSelectAr[0].closeAll()}catch(b){}return!0});if(a.tagName=="SELECT")return dhtmlXComboFromSelect(a);else this._createSelf(a,b,c,e);dhx_glbSelectAr.push(this)}dhtmlXCombo.prototype.setSize=function(a){this.DOMlist.style.width=a+"px";if(this.DOMlistF)this.DOMlistF.style.width=a+"px";this.DOMelem.style.width=a+"px";this.DOMelem_input.style.width=Math.max(0,a-19)+"px"};
dhtmlXCombo.prototype.enableFilteringMode=function(a,b,c,d){a=="between"?this._autoDisabled=this._anyPosition=this._filter=!0:this._filter=convertStringToBoolean(a);if(b)this._xml=b,this._autoxml=convertStringToBoolean(d);if(convertStringToBoolean(c))this._xmlCache=[]};dhtmlXCombo.prototype.setFilteringParam=function(a,b){if(!this._prs)this._prs=[];this._prs.push([a,b])};
dhtmlXCombo.prototype.disable=function(a){var b=convertStringToBoolean(a);if(this._disabled!=b)this._disabled=this.DOMelem_input.disabled=b};
dhtmlXCombo.prototype.readonly=function(a,b){this.DOMelem_input.readOnly=a?!0:!1;if(b===!1||a===!1)this.DOMelem.onkeyup=function(){};else{var c=this;this.DOMelem.onkeyup=function(a){a=a||window.event;c._searchTimeout&&window.clearTimeout(c._searchTimeout);if(a.keyCode!=9)a.cancelBubble=!0;if(a.keyCode>=48&&a.keyCode<=57||a.keyCode>=65&&a.keyCode<=90){if(!c._searchText)c._searchText="";c._searchText+=String.fromCharCode(a.keyCode);for(var b=0;b<c.optionsArr.length;b++){var g=c.optionsArr[b].text;if(g.toString().toUpperCase().indexOf(c._searchText)==
0){c.selectOption(b);break}}c._searchTimeout=window.setTimeout(function(){c._searchText=""},c.readonlyDelay);a.cancelBubble=!0}}}};dhtmlXCombo.prototype.getOption=function(a){for(var b=0;b<this.optionsArr.length;b++)if(this.optionsArr[b].value==a)return this.optionsArr[b];return null};dhtmlXCombo.prototype.getOptionByLabel=function(a){for(var b=0;b<this.optionsArr.length;b++)if(this.optionsArr[b].text==a||this.optionsArr[b]._ctext==a)return this.optionsArr[b];return null};
dhtmlXCombo.prototype.getOptionByIndex=function(a){return this.optionsArr[a]};dhtmlXCombo.prototype.clearAll=function(a){a&&this.setComboText("");this.optionsArr=[];this.redrawOptions();a&&(this._selOption&&this._selOption.RedrawHeader(this,!0),this._confirmSelection())};dhtmlXCombo.prototype.deleteOption=function(a){var b=this.getIndexByValue(a);if(!(b<0)){if(this.optionsArr[b]==this._selOption)this._selOption=null;this.optionsArr.splice(b,1);this.redrawOptions()}};
dhtmlXCombo.prototype.render=function(a){this._skiprender=!convertStringToBoolean(a);this.redrawOptions()};dhtmlXCombo.prototype.updateOption=function(a,b,c,d){var e=this.getOption(a);typeof b!="object"&&(b={text:c,value:b,css:d});e.setValue(b);this.redrawOptions()};
dhtmlXCombo.prototype.addOption=function(a){args=!arguments[0].length||typeof arguments[0]!="object"?[arguments]:a;this.render(!1);for(var b=0;b<args.length;b++){var c=args[b];if(c.length)c.value=c[0]||"",c.text=c[1]||"",c.css=c[2]||"";this._addOption(c)}this.render(!0)};dhtmlXCombo.prototype._addOption=function(a){dOpt=new this._optionObject;this.optionsArr.push(dOpt);dOpt.setValue.apply(dOpt,[a]);this.redrawOptions()};
dhtmlXCombo.prototype.getIndexByValue=function(a){for(var b=0;b<this.optionsArr.length;b++)if(this.optionsArr[b].value==a)return b;return-1};dhtmlXCombo.prototype.getSelectedValue=function(){return this._selOption?this._selOption.value:null};dhtmlXCombo.prototype.getComboText=function(){return this.DOMelem_input.value};dhtmlXCombo.prototype.setComboText=function(a){this.DOMelem_input.value=a};
dhtmlXCombo.prototype.setComboValue=function(a){this.setComboText(a);for(var b=0;b<this.optionsArr.length;b++)if(this.optionsArr[b].data()[0]==a)return this._skipFocus=!0,this.selectOption(b,null,!0);this.DOMelem_hidden_input.value=a};dhtmlXCombo.prototype.getActualValue=function(){return this.DOMelem_hidden_input.value};dhtmlXCombo.prototype.getSelectedText=function(){return this._selOption?this._selOption.text:""};
dhtmlXCombo.prototype.getSelectedIndex=function(){for(var a=0;a<this.optionsArr.length;a++)if(this.optionsArr[a]==this._selOption)return a;return-1};dhtmlXCombo.prototype.setName=function(a){this.DOMelem_hidden_input.name=a;this.DOMelem_hidden_input2=a.replace(/(\]?)$/,"_new_value$1");this.name=a};dhtmlXCombo.prototype.show=function(a){this.DOMelem.style.display=convertStringToBoolean(a)?"":"none"};
dhtmlXCombo.prototype.destructor=function(){this.DOMParent.removeChild(this.DOMelem);this.DOMlist.parentNode.removeChild(this.DOMlist);this.DOMlistF&&this.DOMlistF.parentNode.removeChild(this.DOMlistF);var a=dhx_glbSelectAr;this.DOMParent=this.DOMlist=this.DOMlistF=this.DOMelem=0;for(var b=this.DOMlist.combo=this.DOMelem.combo=0;b<a.length;b++)if(a[b]==this){a[b]=null;a.splice(b,1);break}};
dhtmlXCombo.prototype._createSelf=function(a,b,c,d){if(c.toString().indexOf("%")!=-1){var e=this,g=parseInt(c)/100;window.setInterval(function(){if(a.parentNode){var b=a.parentNode.offsetWidth*g-2;if(!(b<0)&&b!=e._lastTs)e.setSize(e._lastTs=b)}},500);c=parseInt(a.offsetWidth)}c=parseInt(c||100);this.ListPosition="Bottom";this.DOMParent=a;this._inID=null;this.name=b;this._selOption=null;this.optionsArr=[];var h=new this._optionObject;h.DrawHeader(this,b,c,d);this.DOMlist=document.createElement("DIV");
this.DOMlist.className="dhx_combo_list "+(dhtmlx.skin?dhtmlx.skin+"_list":"");this.DOMlist.style.width=c-(_isIE?0:0)+"px";if(_isOpera||_isKHTML)this.DOMlist.style.overflow="auto";this.DOMlist.style.display="none";document.body.insertBefore(this.DOMlist,document.body.firstChild);if(_isIE)this.DOMlistF=document.createElement("IFRAME"),this.DOMlistF.style.border="0px",this.DOMlistF.className="dhx_combo_list",this.DOMlistF.style.width=c-(_isIE?0:0)+"px",this.DOMlistF.style.display="none",this.DOMlistF.src=
"javascript:false;",document.body.insertBefore(this.DOMlistF,document.body.firstChild);this.DOMlist.combo=this.DOMelem.combo=this;this.DOMelem_input.onkeydown=this._onKey;this.DOMelem_input.onkeypress=this._onKeyF;this.DOMelem_input.onblur=this._onBlur;this.DOMelem.onclick=this._toggleSelect;this.DOMlist.onclick=this._selectOption;this.DOMlist.onmousedown=function(){this._skipBlur=!0};this.DOMlist.onkeydown=function(a){(a||event).cancelBubble=!0;this.combo.DOMelem_input.onkeydown(a)};this.DOMlist.onmouseover=
this._listOver};dhtmlXCombo.prototype._listOver=function(a){a=a||event;a.cancelBubble=!0;var b=_isIE?event.srcElement:a.target,c=this.combo;if(b.parentNode==c.DOMlist){c._selOption&&c._selOption.deselect();c._tempSel&&c._tempSel.deselect();for(var d=0;d<c.DOMlist.childNodes.length;d++)if(c.DOMlist.childNodes[d]==b)break;var e=c.optionsArr[d];c._tempSel=e;c._tempSel.select();c._autoxml&&d+1==c._lastLength&&c._fetchOptions(d+1,c._lasttext||"")}};
dhtmlXCombo.prototype._positList=function(){var a=this.getPosition(this.DOMelem);this.ListPosition=="Bottom"?(this.DOMlist.style.top=a[1]+this.DOMelem.offsetHeight-1+"px",this.DOMlist.style.left=a[0]+"px"):this.ListPosition=="Top"?(this.DOMlist.style.top=a[1]-this.DOMlist.offsetHeight+"px",this.DOMlist.style.left=a[0]+"px"):(this.DOMlist.style.top=a[1]+"px",this.DOMlist.style.left=a[0]+this.DOMelem.offsetWidth+"px")};
dhtmlXCombo.prototype.getPosition=function(a,b){if(_isIE&&_isIE<8){if(!b)b=document.body;for(var c=a,d=0,e=0;c&&c!=b;)d+=c.offsetLeft-c.scrollLeft+c.clientLeft,e+=c.offsetTop-c.scrollTop+c.clientTop,c=c.offsetParent;document.documentElement.scrollTop&&(e+=document.documentElement.scrollTop);document.documentElement.scrollLeft&&(d+=document.documentElement.scrollLeft);return[d,e]}var g=getOffset(a);return[g.left,g.top]};
dhtmlXCombo.prototype._correctSelection=function(){if(this.getComboText()!="")for(var a=0;a<this.optionsArr.length;a++)if(!this.optionsArr[a].isHidden())return this.selectOption(a,!0,!1);this.unSelectOption()};dhtmlXCombo.prototype.selectNext=function(a){for(var b=this.getSelectedIndex()+a;this.optionsArr[b];){if(!this.optionsArr[b].isHidden())return this.selectOption(b,!1,!1);b+=a}};
dhtmlXCombo.prototype._onKeyF=function(a){var b=this.parentNode.combo,c=a||event;c.cancelBubble=!0;c.keyCode=="13"||c.keyCode=="9"?(b._confirmSelection(),b.closeAll()):c.keyCode=="27"?(b._resetSelection(),b.closeAll()):b._activeMode=!0;return c.keyCode=="13"||c.keyCode=="27"?(b.callEvent("onKeyPressed",[c.keyCode]),!1):!0};
dhtmlXCombo.prototype._onKey=function(a){var b=this.parentNode.combo;(a||event).cancelBubble=!0;var c=(a||event).keyCode;if(c>15&&c<19)return!0;if(c==27)return!0;if(b.DOMlist.style.display!="block"&&c!="13"&&c!="9"&&(!b._filter||b._filterAny))b.DOMelem.onclick(a||event);if(c!="13"&&c!="9"){if(window.setTimeout(function(){b._onKeyB(c)},1),c=="40"||c=="38")return!1}else if(c==9)b._confirmSelection(),b.closeAll(),(a||event).cancelBubble=!1};
dhtmlXCombo.prototype._onKeyB=function(a){if(a=="40")var b=this.selectNext(1);else if(a=="38")this.selectNext(-1);else{this.callEvent("onKeyPressed",[a]);if(this._filter)return this.filterSelf(a==8||a==46);for(var c=0;c<this.optionsArr.length;c++)if(this.optionsArr[c].data()[1]==this.DOMelem_input.value)return this.selectOption(c,!1,!1),!1;this.unSelectOption()}return!0};
dhtmlXCombo.prototype._onBlur=function(){var a=this.parentNode._self;window.setTimeout(function(){if(a.DOMlist._skipBlur)return!(a.DOMlist._skipBlur=!1);a._skipFocus=!0;a._confirmSelection();a.callEvent("onBlur",[])},100)};dhtmlXCombo.prototype.redrawOptions=function(){if(!this._skiprender){for(var a=this.DOMlist.childNodes.length-1;a>=0;a--)this.DOMlist.removeChild(this.DOMlist.childNodes[a]);for(a=0;a<this.optionsArr.length;a++)this.DOMlist.appendChild(this.optionsArr[a].render())}};
dhtmlXCombo.prototype.loadXML=function(a,b){this._load=!0;this.callEvent("onXLS",[]);if(this._prs)for(var c=0;c<this._prs.length;c++)a+=[getUrlSymbol(a),escape(this._prs[c][0]),"=",escape(this._prs[c][1])].join("");if(this._xmlCache&&this._xmlCache[a])this._fillFromXML(this,null,null,null,this._xmlCache[a]),b&&b();else{var d=new dtmlXMLLoaderObject(this._fillFromXML,this,!0,!0);if(b)d.waitCall=b;d._cPath=a;d.loadXML(a)}};
dhtmlXCombo.prototype.loadXMLString=function(a){var b=new dtmlXMLLoaderObject(this._fillFromXML,this,!0,!0);b.loadXMLString(a)};
dhtmlXCombo.prototype._fillFromXML=function(a,b,c,d,e){a._xmlCache&&(a._xmlCache[e._cPath]=e);var g=e.getXMLTopNode("complete");if(g.tagName!="complete")a._load=!1;else{var h=e.doXPath("//complete"),f=e.doXPath("//option"),i=!1;a.render(!1);if(!h[0]||!h[0].getAttribute("add")){if(a.clearAll(),a._lastLength=f.length,a._xml)if(!f||!f.length)a.closeAll();else if(a._activeMode)a._positList(),a.DOMlist.style.display="block",_isIE&&a._IEFix(!0)}else a._lastLength+=f.length||Infinity,i=!0;for(var j=0;j<
f.length;j++){var l={};l.text=f[j].firstChild?f[j].firstChild.nodeValue:"";for(var k=0;k<f[j].attributes.length;k++){var m=f[j].attributes[k];if(m)l[m.nodeName]=m.nodeValue}a._addOption(l)}a.render(i!=!0||!!f.length);a._load&&a._load!==!0?a.loadXML(a._load):(a._load=!1,!a._lkmode&&a._filter&&!a._autoDisabled&&a._correctSelection());var n=e.doXPath("//option[@selected]");if(n.length)a._skipFocus=!0,a.selectOption(a.getIndexByValue(n[0].getAttribute("value")),!1,!0);a.callEvent("onXLE",[])}};
dhtmlXCombo.prototype.unSelectOption=function(){this._selOption&&this._selOption.deselect();this._tempSel&&this._tempSel.deselect();this._tempSel=this._selOption=null};dhtmlXCombo.prototype.confirmValue=function(){this._confirmSelection()};
dhtmlXCombo.prototype._confirmSelection=function(a,b){var c=this.getComboText();this.setComboText("");this.setComboText(c);if(arguments.length==0){var d=this.getOptionByLabel(this.DOMelem_input.value),a=d?d.value:this.DOMelem_input.value,b=d==null;if(a==this.getActualValue())return this._skipFocus=!1}if(!this._skipFocus&&!this._disabled)try{this.DOMelem_input.focus()}catch(e){}this._skipFocus=!1;this.DOMelem_hidden_input.value=a;this.DOMelem_hidden_input2.value=b?"true":"false";this.callEvent("onChange",
[]);this._activeMode=!1};dhtmlXCombo.prototype._resetSelection=function(){var a=this.getOption(this.DOMelem_hidden_input.value);this.setComboValue(a?a.data()[0]:this.DOMelem_hidden_input.value);this.setComboText(a?a.data()[1]:this.DOMelem_hidden_input.value)};
dhtmlXCombo.prototype.selectOption=function(a,b,c){arguments.length<3&&(c=!0);this.unSelectOption();var d=this.optionsArr[a];if(d){this._selOption=d;this._selOption.select();var e=this._selOption.content.offsetTop+this._selOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;e>0&&(this.DOMlist.scrollTop+=e);e=this.DOMlist.scrollTop-this._selOption.content.offsetTop;e>0&&(this.DOMlist.scrollTop-=e);var g=this._selOption.data();c&&(this.setComboText(g[1]),this._confirmSelection(g[0],
!1));this._autoxml&&a+1==this._lastLength&&this._fetchOptions(a+1,this._lasttext||"");if(b){var h=this.getComboText();h!=g[1]&&(this.setComboText(g[1]),dhtmlXRange(this.DOMelem_input,h.length+1,g[1].length))}else this.setComboText(g[1]);this._selOption.RedrawHeader(this);this.callEvent("onSelectionChange",[])}};
dhtmlXCombo.prototype._selectOption=function(a){(a||event).cancelBubble=!0;for(var b=_isIE?event.srcElement:a.target,c=this.combo;!b._self;)if(b=b.parentNode,!b)return;for(var d=0;d<c.DOMlist.childNodes.length;d++)if(c.DOMlist.childNodes[d]==b)break;c.selectOption(d,!1,!0);c.closeAll();c.callEvent("onBlur",[]);c._activeMode=!1};
dhtmlXCombo.prototype.openSelect=function(){if(!this._disabled){this.closeAll();this.DOMlist.style.display="block";this._positList();this.callEvent("onOpen",[]);this._tempSel&&this._tempSel.deselect();this._selOption&&this._selOption.select();if(this._selOption){var a=this._selOption.content.offsetTop+this._selOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;a>0&&(this.DOMlist.scrollTop+=a);a=this.DOMlist.scrollTop-this._selOption.content.offsetTop;a>0&&(this.DOMlist.scrollTop-=
a)}_isIE&&this._IEFix(!0);this.DOMelem_input.focus();this._filter&&this.filterSelf()}};dhtmlXCombo.prototype._toggleSelect=function(a){var b=this.combo;b.DOMlist.style.display=="block"?b.closeAll():b.openSelect();(a||event).cancelBubble=!0};
dhtmlXCombo.prototype._fetchOptions=function(a,b){if(b=="")return this.closeAll(),this.clearAll();var c=this._xml+(this._xml.indexOf("?")!=-1?"&":"?")+"pos="+a+"&mask="+encodeURIComponent(b);this._lasttext=b;this._load?this._load=c:this.callEvent("onDynXLS",[b,a])&&this.loadXML(c)};dhtmlXCombo.prototype.disableAutocomplete=function(){this._autoDisabled=!0};
dhtmlXCombo.prototype.filterSelf=function(a){var b=this.getComboText();if(this._xml)this._lkmode=a,this._fetchOptions(0,b);var c=RegExp("(["+this.filterEntities.join("\\")+"])","g"),b=b.replace(c,"\\$1"),d=(this._anyPosition?"":"^")+b,e=RegExp(d,"i");this.filterAny=!1;for(var g=0;g<this.optionsArr.length;g++){var h=e.test(this.optionsArr[g].content?this.optionsArr[g].data()[1]:this.optionsArr[g].text);this.filterAny|=h;this.optionsArr[g].hide(!h)}this.filterAny?(this.DOMlist.style.display!="block"&&
this.openSelect(),_isIE&&this._IEFix(!0)):(this.closeAll(),this._activeMode=!0);!a&&!this._autoDisabled?this._correctSelection():this.unSelectOption()};dhtmlXCombo.prototype._IEFix=function(a){this.DOMlistF.style.display=a?"block":"none";this.DOMlistF.style.top=this.DOMlist.style.top;this.DOMlistF.style.left=this.DOMlist.style.left;this.DOMlistF.style.width=this.DOMlist.offsetWidth+"px";this.DOMlistF.style.height=this.DOMlist.offsetHeight+"px"};
dhtmlXCombo.prototype.closeAll=function(){if(window.dhx_glbSelectAr)for(var a=0;a<dhx_glbSelectAr.length;a++){if(dhx_glbSelectAr[a].DOMlist.style.display=="block")dhx_glbSelectAr[a].DOMlist.style.display="none",_isIE&&dhx_glbSelectAr[a]._IEFix(!1);dhx_glbSelectAr[a]._activeMode=!1}};dhtmlXCombo.prototype.changeOptionId=function(a,b){(this.getOption(a)||{}).value=b};
function dhtmlXRange(a,b,c){var d=typeof a=="object"?a:document.getElementById(a);try{d.focus()}catch(e){}var g=d.value.length;b--;if(b<0||b>c||b>g)b=0;c>g&&(c=g);if(b!=c)if(d.setSelectionRange)d.setSelectionRange(b,c);else if(d.createTextRange){var h=d.createTextRange();h.moveStart("character",b);h.moveEnd("character",c-g);try{h.select()}catch(f){}}}dhtmlXCombo_defaultOption=function(){this.init()};
dhtmlXCombo_defaultOption.prototype.init=function(){this.value=null;this.text="";this.selected=!1;this.css=""};dhtmlXCombo_defaultOption.prototype.select=function(){if(this.content)this.content.className="dhx_selected_option"+(dhtmlx.skin?" combo_"+dhtmlx.skin+"_sel":"")};dhtmlXCombo_defaultOption.prototype.hide=function(a){this.render().style.display=a?"none":""};dhtmlXCombo_defaultOption.prototype.isHidden=function(){return this.render().style.display=="none"};
dhtmlXCombo_defaultOption.prototype.deselect=function(){this.content&&this.render();this.content.className=""};dhtmlXCombo_defaultOption.prototype.setValue=function(a){this.value=a.value||"";this.text=a.text||"";this.css=a.css||"";this.content=null};
dhtmlXCombo_defaultOption.prototype.render=function(){if(!this.content){this.content=document.createElement("DIV");this.content._self=this;this.content.style.cssText="width:100%; overflow:hidden;"+this.css;if(_isOpera||_isKHTML)this.content.style.padding="2px 0px 2px 0px";this.content.innerHTML=this.text;this._ctext=typeof this.content.textContent!="undefined"?this.content.textContent:this.content.innerText}return this.content};
dhtmlXCombo_defaultOption.prototype.data=function(){if(this.content)return[this.value,this._ctext?this._ctext:this.text]};dhtmlXCombo_defaultOption.prototype.DrawHeader=function(a,b,c,d){var e=document.createElement("DIV");e.style.width=c+"px";e.className="dhx_combo_box "+(dhtmlx.skin||"");e._self=a;a.DOMelem=e;this._DrawHeaderInput(a,b,c,d);this._DrawHeaderButton(a,b,c);a.DOMParent.appendChild(a.DOMelem)};
dhtmlXCombo_defaultOption.prototype._DrawHeaderInput=function(a,b,c,d){var e=document.createElement("input");e.setAttribute("autocomplete","off");e.type="text";e.className="dhx_combo_input";if(d)e.tabIndex=d;e.style.width=c-19-(document.compatMode=="BackCompat"?0:3)+"px";a.DOMelem.appendChild(e);a.DOMelem_input=e;e=document.createElement("input");e.type="hidden";e.name=b;a.DOMelem.appendChild(e);a.DOMelem_hidden_input=e;e=document.createElement("input");e.type="hidden";e.name=(b||"").replace(/(\]?)$/,
"_new_value$1");e.value="true";a.DOMelem.appendChild(e);a.DOMelem_hidden_input2=e};dhtmlXCombo_defaultOption.prototype._DrawHeaderButton=function(a){var b=document.createElement("img");b.className="dhx_combo_img";if(dhtmlx.image_path)dhx_globalImgPath=dhtmlx.image_path;b.src=(window.dhx_globalImgPath?dhx_globalImgPath:"")+"combo_select"+(dhtmlx.skin?"_"+dhtmlx.skin:"")+".gif";a.DOMelem.appendChild(b);a.DOMelem_button=b};dhtmlXCombo_defaultOption.prototype.RedrawHeader=function(){};
dhtmlXCombo_optionTypes["default"]=dhtmlXCombo_defaultOption;
dhtmlXCombo.prototype.dhx_Event=function(){this.dhx_SeverCatcherPath="";this.attachEvent=function(a,b,c){c=c||this;a="ev_"+a;if(!this[a]||!this[a].addEvent){var d=new this.eventCatcher(c);d.addEvent(this[a]);this[a]=d}return a+":"+this[a].addEvent(b)};this.callEvent=function(a,b){return this["ev_"+a]?this["ev_"+a].apply(this,b):!0};this.checkEvent=function(a){return this["ev_"+a]?!0:!1};this.eventCatcher=function(a){var b=[],c=a,d=function(a,b){var a=a.split(":"),c="",d="",e=a[1];a[1]=="rpc"&&(c=
'<?xml version="1.0"?><methodCall><methodName>'+a[2]+"</methodName><params>",d="</params></methodCall>",e=b);var l=function(){};return l},e=function(){if(b)var a=!0;for(var d=0;d<b.length;d++)if(b[d]!=null)var e=b[d].apply(c,arguments),a=a&&e;return a};e.addEvent=function(a){typeof a!="function"&&(a=a&&a.indexOf&&a.indexOf("server:")==0?new d(a,c.rpcServer):eval(a));return a?b.push(a)-1:!1};e.removeEvent=function(a){b[a]=null};return e};this.detachEvent=function(a){if(a!=!1){var b=a.split(":");this[b[0]].removeEvent(b[1])}}};
(function(){dhtmlx.extend_api("dhtmlXCombo",{_init:function(a){if(a.image_path)dhx_globalImgPath=a.image_path;return[a.parent,a.name,a.width||"100%",a.type,a.index]},filter:"filter_command",auto_height:"enableOptionAutoHeight",auto_position:"enableOptionAutoPositioning",auto_width:"enableOptionAutoWidth",xml:"loadXML",readonly:"readonly",items:"addOption"},{filter_command:function(a){typeof a=="string"?this.enableFilteringMode(!0,a):this.enableFilteringMode(a)}})})();window.dhx||(dhx={});
dhx.version="3.0";dhx.codebase="./";dhx.name="Core";dhx.clone=function(a){var b=dhx.clone.xa;b.prototype=a;return new b};dhx.clone.xa=function(){};dhx.extend=function(a,b,c){if(a.q)return dhx.PowerArray.insertAt.call(a.q,b,1),a;for(var d in b)if(!a[d]||c)a[d]=b[d];b.defaults&&dhx.extend(a.defaults,b.defaults);b.$init&&b.$init.call(a);return a};
dhx.copy=function(a){if(arguments.length>1)var b=arguments[0],a=arguments[1];else b=dhx.isArray(a)?[]:{};for(var c in a)a[c]&&typeof a[c]=="object"&&!dhx.isDate(a[c])?(b[c]=dhx.isArray(a[c])?[]:{},dhx.copy(b[c],a[c])):b[c]=a[c];return b};dhx.single=function(a){var b=null,c=function(c){b||(b=new a({}));b.Ia&&b.Ia.apply(b,arguments);return b};return c};
dhx.protoUI=function(){var a=arguments,b=a[0].name,c=function(a){if(!c)return dhx.ui[b].prototype;var e=c.q;if(e){for(var g=[e[0]],h=1;h<e.length;h++)g[h]=e[h],g[h].q&&(g[h]=g[h].call(dhx,g[h].name)),g[h].prototype&&g[h].prototype.name&&(dhx.ui[g[h].prototype.name]=g[h]);dhx.ui[b]=dhx.proto.apply(dhx,g);if(c.r)for(h=0;h<c.r.length;h++)dhx.Type(dhx.ui[b],c.r[h]);c=e=null}return this!=dhx?new dhx.ui[b](a):dhx.ui[b]};c.q=Array.prototype.slice.call(arguments,0);return dhx.ui[b]=c};
dhx.proto=function(){for(var a=arguments,b=a[0],c=!!b.$init,d=[],e=a.length-1;e>0;e--){if(typeof a[e]=="function")a[e]=a[e].prototype;a[e].$init&&d.push(a[e].$init);if(a[e].defaults){var g=a[e].defaults;if(!b.defaults)b.defaults={};for(var h in g)dhx.isUndefined(b.defaults[h])&&(b.defaults[h]=g[h])}if(a[e].type&&b.type)for(h in a[e].type)b.type[h]||(b.type[h]=a[e].type[h]);for(var f in a[e])b[f]||(b[f]=a[e][f])}c&&d.push(b.$init);b.$init=function(){for(var a=0;a<d.length;a++)d[a].apply(this,arguments)};
var i=function(a){this.$ready=[];this.$init(a);this.$&&this.$(a,this.defaults);for(var b=0;b<this.$ready.length;b++)this.$ready[b].call(this)};i.prototype=b;b=a=null;return i};dhx.bind=function(a,b){return function(){return a.apply(b,arguments)}};
dhx.require=function(a,b,c,d,e){if(typeof a!="string"){var g=a.length||0,h=b;if(g)b=function(){if(g)g--,dhx.require(a[a.length-g-1],b,c);else return h.apply(this,arguments)},b();else{for(var f in a)g++;b=function(){g--;g===0&&h.apply(this,arguments)};for(f in a)dhx.require(f,b,c)}}else if(dhx.i[a]!==!0)if(a.substr(-4)==".css"){var i=dhx.html.create("LINK",{type:"text/css",rel:"stylesheet",href:dhx.codebase+a});document.head.appendChild(i);b&&b.call(c||window)}else{var j=e;b?dhx.i[a]?dhx.i[a].push([b,
c]):(dhx.i[a]=[[b,c]],dhx.ajax(dhx.codebase+a,function(b){dhx.exec(b);var c=dhx.i[a];dhx.i[a]=!0;for(var d=0;d<c.length;d++)c[d][0].call(c[d][1]||window,!d)})):(dhx.exec(dhx.ajax().sync().get(dhx.codebase+a).responseText),dhx.i[a]=!0)}};dhx.i={};dhx.exec=function(a){window.execScript?window.execScript(a):window.eval(a)};dhx.wrap=function(a,b){return!a?b:function(){var c=a.apply(this,arguments);b.apply(this,arguments);return c}};dhx.isUndefined=function(a){return typeof a=="undefined"};
dhx.delay=function(a,b,c,d){return window.setTimeout(function(){var d=a.apply(b,c||[]);a=b=c=null;return d},d||1)};dhx.uid=function(){if(!this.R)this.R=(new Date).valueOf();this.R++;return this.R};dhx.toNode=function(a){return typeof a=="string"?document.getElementById(a):a};dhx.toArray=function(a){return dhx.extend(a||[],dhx.PowerArray,!0)};dhx.toFunctor=function(a){return typeof a=="string"?eval(a):a};
dhx.isArray=function(a){return Array.isArray?Array.isArray(a):Object.prototype.toString.call(a)==="[object Array]"};dhx.isDate=function(a){return a instanceof Date};dhx.L={};dhx.event=function(a,b,c,d){var a=dhx.toNode(a),e=dhx.uid();d&&(c=dhx.bind(c,d));dhx.L[e]=[a,b,c];a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c);return e};
dhx.eventRemove=function(a){if(a){var b=dhx.L[a];b[0].removeEventListener?b[0].removeEventListener(b[1],b[2],!1):b[0].detachEvent&&b[0].detachEvent("on"+b[1],b[2]);delete this.L[a]}};
dhx.EventSystem={$init:function(){if(!this.e)this.e={},this.s={},this.M={}},blockEvent:function(){this.e.T=!0},unblockEvent:function(){this.e.T=!1},mapEvent:function(a){dhx.extend(this.M,a,!0)},on_setter:function(a){if(a)for(var b in a)typeof a[b]=="function"&&this.attachEvent(b,a[b])},callEvent:function(a,b){if(this.e.T)return!0;var a=a.toLowerCase(),c=this.e[a.toLowerCase()],d=!0;if(c)for(var e=0;e<c.length;e++)if(c[e].apply(this,b||[])===!1)d=!1;this.M[a]&&!this.M[a].callEvent(a,b)&&(d=!1);return d},
attachEvent:function(a,b,c){var a=a.toLowerCase(),c=c||dhx.uid(),b=dhx.toFunctor(b),d=this.e[a]||dhx.toArray();d.push(b);this.e[a]=d;this.s[c]={f:b,t:a};return c},detachEvent:function(a){if(this.s[a]){var b=this.s[a].t,c=this.s[a].f,d=this.e[b];d.remove(c);delete this.s[a]}},hasEvent:function(a){a=a.toLowerCase();return this.e[a]?!0:!1}};dhx.extend(dhx,dhx.EventSystem);
dhx.PowerArray={removeAt:function(a,b){a>=0&&this.splice(a,b||1)},remove:function(a){this.removeAt(this.find(a))},insertAt:function(a,b){if(!b&&b!==0)this.push(a);else{var c=this.splice(b,this.length-b);this[b]=a;this.push.apply(this,c)}},find:function(a){for(var b=0;b<this.length;b++)if(a==this[b])return b;return-1},each:function(a,b){for(var c=0;c<this.length;c++)a.call(b||this,this[c])},map:function(a,b){for(var c=0;c<this.length;c++)this[c]=a.call(b||this,this[c]);return this},filter:function(a,
b){for(var c=0;c<this.length;c++)a.call(b||this,this[c])||(this.splice(c,1),c--);return this}};dhx.env={};
(function(){if(navigator.userAgent.indexOf("Mobile")!=-1)dhx.env.mobile=!0;if(dhx.env.mobile||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1)dhx.env.touch=!0;navigator.userAgent.indexOf("Opera")!=-1?dhx.env.isOpera=!0:(dhx.env.isIE=!!document.all,dhx.env.isFF=!document.all,dhx.env.isWebKit=navigator.userAgent.indexOf("KHTML")!=-1,dhx.env.isSafari=dhx.env.isWebKit&&navigator.userAgent.indexOf("Mac")!=-1);if(navigator.userAgent.toLowerCase().indexOf("android")!=
-1)dhx.env.isAndroid=!0;dhx.env.transform=!1;dhx.env.transition=!1;for(var a={names:["transform","transition"],transform:["transform","WebkitTransform","MozTransform","OTransform","msTransform"],transition:["transition","WebkitTransition","MozTransition","OTransition","msTransition"]},b=document.createElement("DIV"),c=0;c<a.names.length;c++)for(var d=a[a.names[c]],e=0;e<d.length;e++)if(typeof b.style[d[e]]!="undefined"){dhx.env[a.names[c]]=d[e];break}b.style[dhx.env.transform]="translate3d(0,0,0)";
dhx.env.translate=b.style[dhx.env.transform]?"translate3d":"translate";var g="",h=!1;dhx.env.isOpera&&(g="-o-",h="O");dhx.env.isFF&&(g="-Moz-");dhx.env.isWebKit&&(g="-webkit-");dhx.env.isIE&&(g="-ms-");dhx.env.transformCSSPrefix=g;dhx.env.transformPrefix=h||dhx.env.transformCSSPrefix.replace(/-/gi,"");dhx.env.transitionEnd=dhx.env.transformCSSPrefix=="-Moz-"?"transitionend":dhx.env.transformPrefix+"TransitionEnd"})();
dhx.env.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}();
dhx.html={v:0,denySelect:function(){if(!dhx.v)dhx.v=document.onselectstart;document.onselectstart=dhx.html.stopEvent},allowSelect:function(){if(dhx.v!==0)document.onselectstart=dhx.v||null;dhx.v=0},index:function(a){for(var b=0;a=a.previousSibling;)b++;return b},ga:{},createCss:function(a){var b="",c;for(c in a)b+=c+":"+a[c]+";";var d=this.ga[b];d||(d="s"+dhx.uid(),this.addStyle("."+d+"{"+b+"}"),this.ga[b]=d);return d},addStyle:function(a){var b=document.createElement("style");b.setAttribute("type",
"text/css");b.setAttribute("media","screen");b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));document.getElementsByTagName("head")[0].appendChild(b)},create:function(a,b,c){var b=b||{},d=document.createElement(a),e;for(e in b)d.setAttribute(e,b[e]);if(b.style)d.style.cssText=b.style;if(b["class"])d.className=b["class"];if(c)d.innerHTML=c;return d},getValue:function(a){a=dhx.toNode(a);return!a?"":dhx.isUndefined(a.value)?a.innerHTML:a.value},remove:function(a){if(a instanceof
Array)for(var b=0;b<a.length;b++)this.remove(a[b]);else a&&a.parentNode&&a.parentNode.removeChild(a)},insertBefore:function(a,b,c){a&&(b&&b.parentNode?b.parentNode.insertBefore(a,b):c.appendChild(a))},locate:function(a,b){if(a.tagName)var c=a;else a=a||event,c=a.target||a.srcElement;for(;c;){if(c.getAttribute){var d=c.getAttribute(b);if(d)return d}c=c.parentNode}return null},offset:function(a){if(a.getBoundingClientRect){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=
window.pageYOffset||d.scrollTop||c.scrollTop,g=window.pageXOffset||d.scrollLeft||c.scrollLeft,h=d.clientTop||c.clientTop||0,f=d.clientLeft||c.clientLeft||0,i=b.top+e-h,j=b.left+g-f;return{y:Math.round(i),x:Math.round(j)}}else{for(j=i=0;a;)i+=parseInt(a.offsetTop,10),j+=parseInt(a.offsetLeft,10),a=a.offsetParent;return{y:i,x:j}}},posRelative:function(a){a=a||event;return dhx.isUndefined(a.offsetX)?{x:a.layerX,y:a.layerY}:{x:a.offsetX,y:a.offsetY}},pos:function(a){a=a||event;if(a.pageX||a.pageY)return{x:a.pageX,
y:a.pageY};var b=dhx.env.isIE&&document.compatMode!="BackCompat"?document.documentElement:document.body;return{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}},preventEvent:function(a){a&&a.preventDefault&&a.preventDefault();return dhx.html.stopEvent(a)},stopEvent:function(a){(a||event).cancelBubble=!0;return!1},addCss:function(a,b){a.className+=" "+b},removeCss:function(a,b){a.className=a.className.replace(RegExp(" "+b,"g"),"")}};
dhx.ready=function(a){this.Ga?a.call():this.D.push(a)};dhx.D=[];(function(){var a=document.getElementsByTagName("SCRIPT");if(a.length)a=(a[a.length-1].getAttribute("src")||"").split("/"),a.splice(a.length-1,1),dhx.codebase=a.slice(0,a.length).join("/")+"/";dhx.event(window,"load",function(){dhx.callEvent("onReady",[]);dhx.delay(function(){dhx.Ga=!0;for(var a=0;a<dhx.D.length;a++)dhx.D[a].call();dhx.D=[]})})})();dhx.locale=dhx.locale||{};
dhx.ready(function(){dhx.event(document.body,"click",function(a){dhx.callEvent("onClick",[a||event])})});
(function(){var a={},b=RegExp("(\\r\\n|\\n)","g"),c=RegExp('(\\")',"g");dhx.Template=function(d){if(typeof d=="function")return d;if(a[d])return a[d];d=(d||"").toString();if(d.indexOf("->")!=-1)switch(d=d.split("->"),d[0]){case "html":d=dhx.html.getValue(d[1]);break;case "http":d=(new dhx.ajax).sync().get(d[1],{uid:dhx.uid()}).responseText}d=(d||"").toString();d=d.replace(b,"\\n");d=d.replace(c,'\\"');d=d.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,'"+(obj.$1?"$2":"$3")+"');d=d.replace(/\{common\.([^}\(]*)\}/g,
"\"+(common.$1||'')+\"");d=d.replace(/\{common\.([^\}\(]*)\(\)\}/g,'"+(common.$1?common.$1.apply(this, arguments):"")+"');d=d.replace(/\{obj\.([^}]*)\}/g,'"+(obj.$1)+"');d=d.replace("{obj}",'"+obj+"');d=d.replace(/#([^#'";, ]+)#/gi,'"+(obj.$1)+"');try{a[d]=Function("obj","common",'return "'+d+'";')}catch(e){}return a[d]};dhx.Template.empty=function(){return""};dhx.Template.bind=function(a){return dhx.bind(dhx.Template(a),this)};dhx.Type=function(a,b){if(a.q){if(!a.r)a.r=[];a.r.push(b)}else{if(typeof a==
"function")a=a.prototype;if(!a.types)a.types={"default":a.type},a.type.name="default";var c=b.name,h=a.type;c&&(h=a.types[c]=dhx.clone(b.baseType?a.types[b.baseType]:a.type));for(var f in b)h[f]=f.indexOf("template")===0?dhx.Template(b[f]):b[f];return c}}})();
dhx.Settings={$init:function(){this.a=this.config={}},define:function(a,b){return typeof a=="object"?this.Q(a):this.U(a,b)},U:function(a,b){var c=this[a+"_setter"];return this.a[a]=c?c.call(this,b,a):b},Q:function(a){if(a)for(var b in a)this.U(b,a[b])},$:function(a,b){var c={};b&&(c=dhx.extend(c,b));typeof a=="object"&&!a.tagName&&dhx.extend(c,a,!0);this.Q(c)},Ba:function(a,b){for(var c in b)switch(typeof a[c]){case "object":a[c]=this.Ba(a[c]||{},b[c]);break;case "undefined":a[c]=b[c]}return a}};
dhx.ajax=function(a,b,c){if(arguments.length!==0){var d=new dhx.ajax;if(c)d.master=c;return d.get(a,null,b)}return!this.getXHR?new dhx.ajax:this};dhx.ajax.count=0;
dhx.ajax.prototype={master:null,getXHR:function(){return dhx.env.isIE?new ActiveXObject("Microsoft.xmlHTTP"):new XMLHttpRequest},send:function(a,b,c){var d=this.getXHR();dhx.isArray(c)||(c=[c]);if(typeof b=="object"){var e=[],g;for(g in b){var h=b[g];if(h===null||h===dhx.undefined)h="";e.push(g+"="+encodeURIComponent(h))}b=e.join("&")}b&&this.request==="GET"&&(a=a+(a.indexOf("?")!=-1?"&":"?")+b,b=null);d.open(this.request,a,!this.Na);this.request==="POST"&&d.setRequestHeader("Content-type","application/x-www-form-urlencoded");
var f=this;d.onreadystatechange=function(){if(!d.readyState||d.readyState==4){dhx.ajax.count++;if(c&&f)for(var a=0;a<c.length;a++)if(c[a]){var b=c[a].success||c[a];if(d.status>=400||!d.status&&!d.responseText)b=c[a].error;b&&b.call(f.master||f,d.responseText,d.responseXML,d)}if(f)f.master=null;c=f=null}};d.send(b||null);return d},get:function(a,b,c){arguments.length==2&&(c=b,b=null);this.request="GET";return this.send(a,b,c)},post:function(a,b,c){this.request="POST";return this.send(a,b,c)},put:function(a,
b,c){this.request="PUT";return this.send(a,b,c)},del:function(a,b,c){this.request="DELETE";return this.send(a,b,c)},sync:function(){this.Na=!0;return this},bind:function(a){this.master=a;return this}};dhx.send=function(a,b,c,d){var e=dhx.html.create("FORM",{target:d||"_self",action:a,method:c||"POST"},""),g;for(g in b){var h=dhx.html.create("INPUT",{type:"hidden",name:g,value:b[g]},"");e.appendChild(h)}e.style.display="none";document.body.appendChild(e);e.submit();document.body.removeChild(e)};
dhx.AtomDataLoader={$init:function(a){this.data={};if(a)this.a.datatype=a.datatype||"json",this.$ready.push(this.Aa)},Aa:function(){this.aa=!0;this.a.url&&this.url_setter(this.a.url);this.a.data&&this.data_setter(this.a.data)},url_setter:function(a){if(!this.aa)return a;this.load(a,this.a.datatype);return a},data_setter:function(a){if(!this.aa)return a;this.parse(a,this.a.datatype);return!0},load:function(a,b,c){if(a.$proxy)a.load(this,typeof b=="string"?b:"json");else{this.callEvent("onXLS",[]);
if(typeof b=="string")this.data.driver=dhx.DataDriver[b],b=c;else if(!this.data.driver)this.data.driver=dhx.DataDriver.json;var d=[{success:this.P}];b&&(dhx.isArray(b)?d.push.apply(d,b):d.push(b));return dhx.ajax(a,d,this)}},parse:function(a,b){this.callEvent("onXLS",[]);this.data.driver=dhx.DataDriver[b||"json"];this.P(a,null)},P:function(a,b,c){var d=this.data.driver,e=d.toObject(a,b);if(e){var g=d.getRecords(e)[0];this.data=d?d.getDetails(g):a}else this.C(a,b,c);this.callEvent("onXLE",[])},C:function(a,
b,c){this.callEvent("onXLE",[]);this.callEvent("onLoadError",arguments);dhx.callEvent("onLoadError",[a,b,c,this])},z:function(a){if(!this.a.dataFeed||this.N||!a)return!0;var b=this.a.dataFeed;if(typeof b=="function")return b.call(this,a.id||a,a);b=b+(b.indexOf("?")==-1?"?":"&")+"action=get&id="+encodeURIComponent(a.id||a);this.callEvent("onXLS",[]);dhx.ajax(b,function(a,b,e){this.N=!0;var g=dhx.DataDriver.toObject(a,b);g?this.setValues(g.getDetails(g.getRecords()[0])):this.C(a,b,e);this.N=!1;this.callEvent("onXLE",
[])},this);return!1}};dhx.DataDriver={};
dhx.DataDriver.json={toObject:function(a){a||(a="[]");if(typeof a=="string"){try{eval("dhx.temp="+a)}catch(b){return null}a=dhx.temp}if(a.data){var c=a.data.config={},d;for(d in a)d!="data"&&(c[d]=a[d]);a=a.data}return a},getRecords:function(a){return a&&!dhx.isArray(a)?[a]:a},getDetails:function(a){return typeof a=="string"?{id:dhx.uid(),value:a}:a},getInfo:function(a){var b=a.config;return!b?{}:{n:b.total_count||0,m:b.pos||0,Ea:b.parent||0,K:b.config,O:b.dhx_security}},child:"data"};
dhx.DataDriver.html={toObject:function(a){if(typeof a=="string"){var b=null;a.indexOf("<")==-1&&(b=dhx.toNode(a));if(!b)b=document.createElement("DIV"),b.innerHTML=a;return b.getElementsByTagName(this.tag)}return a},getRecords:function(a){for(var b=[],c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.nodeType==1&&b.push(d)}return b},getDetails:function(a){return dhx.DataDriver.xml.tagToObject(a)},getInfo:function(){return{n:0,m:0}},tag:"LI"};
dhx.DataDriver.jsarray={toObject:function(a){return typeof a=="string"?(eval("dhx.temp="+a),dhx.temp):a},getRecords:function(a){return a},getDetails:function(a){for(var b={},c=0;c<a.length;c++)b["data"+c]=a[c];return b},getInfo:function(){return{n:0,m:0}}};
dhx.DataDriver.csv={toObject:function(a){return a},getRecords:function(a){return a.split(this.row)},getDetails:function(a){for(var a=this.stringToArray(a),b={},c=0;c<a.length;c++)b["data"+c]=a[c];return b},getInfo:function(){return{n:0,m:0}},stringToArray:function(a){for(var a=a.split(this.cell),b=0;b<a.length;b++)a[b]=a[b].replace(/^[ \t\n\r]*(\"|)/g,"").replace(/(\"|)[ \t\n\r]*$/g,"");return a},row:"\n",cell:","};
dhx.DataDriver.xml={Y:function(a){return!a||!a.documentElement?null:a.getElementsByTagName("parsererror").length?null:a},toObject:function(a){if(this.Y(b))return b;var b=typeof a=="string"?this.fromString(a.replace(/^[\s]+/,"")):a;return this.Y(b)?b:null},getRecords:function(a){return this.xpath(a,this.records)},records:"/*/item",child:"item",config:"/*/config",getDetails:function(a){return this.tagToObject(a,{})},getInfo:function(a){var b=this.xpath(a,this.config),b=b.length?this.assignTypes(this.tagToObject(b[0],
{})):null;return{n:a.documentElement.getAttribute("total_count")||0,m:a.documentElement.getAttribute("pos")||0,Ea:a.documentElement.getAttribute("parent")||0,K:b,O:a.documentElement.getAttribute("dhx_security")||null}},xpath:function(a,b){if(window.XPathResult){var c=a;if(a.nodeName.indexOf("document")==-1)a=a.ownerDocument;for(var d=[],e=a.evaluate(b,c,null,XPathResult.ANY_TYPE,null),g=e.iterateNext();g;)d.push(g),g=e.iterateNext();return d}else{var h=!0;try{typeof a.selectNodes=="undefined"&&(h=
!1)}catch(f){}if(h)return a.selectNodes(b);else{var i=b.split("/").pop();return a.getElementsByTagName(i)}}},assignTypes:function(a){for(var b in a){var c=a[b];typeof c=="object"?this.assignTypes(c):typeof c=="string"&&c!==""&&(c=="true"?a[b]=!0:c=="false"?a[b]=!1:c==c*1&&(a[b]*=1))}return a},tagToObject:function(a,b){var b=b||{},c=!1,d=a.attributes;if(d&&d.length){for(var e=0;e<d.length;e++)b[d[e].name]=d[e].value;c=!0}for(var g=a.childNodes,h={},e=0;e<g.length;e++)if(g[e].nodeType==1){var f=g[e].tagName;
typeof b[f]!="undefined"?(dhx.isArray(b[f])||(b[f]=[b[f]]),b[f].push(this.tagToObject(g[e],{}))):b[g[e].tagName]=this.tagToObject(g[e],{});c=!0}if(!c)return this.nodeValue(a);b.value=b.value||this.nodeValue(a);return b},nodeValue:function(a){return a.firstChild?a.firstChild.data:""},fromString:function(a){try{if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");if(window.ActiveXObject){var b=new ActiveXObject("Microsoft.xmlDOM");b.loadXML(a);return b}}catch(c){return null}}};
dhx.DataLoader=dhx.proto({$init:function(a){a=a||"";this.o=dhx.toArray();this.data=new dhx.DataStore;this.data.attachEvent("onClearAll",dhx.bind(this.oa,this));this.data.attachEvent("onServerConfig",dhx.bind(this.na,this));this.data.feed=this.sa},sa:function(a,b,c){if(this.u)return this.u=[a,b,c];else this.u=!0;this.W=[a,b];this.ua.call(this,a,b,c)},ua:function(a,b,c){var d=this.data.url;a<0&&(a=0);this.load(d+(d.indexOf("?")==-1?"?":"&")+(this.dataCount()?"continue=true&":"")+"start="+a+"&count="+
b,[this.ta,c])},ta:function(){var a=this.u,b=this.W;this.u=!1;typeof a=="object"&&(a[0]!=b[0]||a[1]!=b[1])&&this.data.feed.apply(this,a)},load:function(a,b){var c=dhx.AtomDataLoader.load.apply(this,arguments);this.o.push(c);if(!this.data.url)this.data.url=a},loadNext:function(a,b,c,d,e){this.a.datathrottle&&!e?(this.ha&&window.clearTimeout(this.ha),this.ha=dhx.delay(function(){this.loadNext(a,b,c,d,!0)},this,0,this.a.datathrottle)):(!b&&b!==0&&(b=this.dataCount()),this.data.url=this.data.url||d,this.callEvent("onDataRequest",
[b,a,c,d])&&this.data.url&&this.data.feed.call(this,b,a,c))},Ra:function(a,b){var c=this.W;return this.u&&c&&c[0]<=b&&c[1]+c[0]>=a+b?!0:!1},P:function(a,b,c){this.o.remove(c);var d=this.data.driver.toObject(a,b);if(d)this.data.Fa(d);else return this.C(a,b,c);this.pa();this.callEvent("onXLE",[])},removeMissed_setter:function(a){return this.data.Ja=a},scheme_setter:function(a){this.data.scheme(a)},dataFeed_setter:function(a){this.data.attachEvent("onBeforeFilter",dhx.bind(function(a,c){if(this.a.dataFeed){var d=
{};if(a||c){if(typeof a=="function"){if(!c)return;a(c,d)}else d={text:c};this.clearAll();var e=this.a.dataFeed,g=[];if(typeof e=="function")return e.call(this,c,d);for(var h in d)g.push("dhx_filter["+h+"]="+encodeURIComponent(d[h]));this.load(e+(e.indexOf("?")<0?"?":"&")+g.join("&"),this.a.datatype);return!1}}},this));return a},pa:function(){if(this.a.ready&&!this.Ha){var a=dhx.toFunctor(this.a.ready);a&&dhx.delay(a,this,arguments);this.Ha=!0}},oa:function(){for(var a=0;a<this.o.length;a++)this.o[a].abort();
this.o=dhx.toArray()},na:function(a){this.Q(a)}},dhx.AtomDataLoader);dhx.DataStore=function(){this.name="DataStore";dhx.extend(this,dhx.EventSystem);this.setDriver("json");this.pull={};this.order=dhx.toArray();this.d={}};
dhx.DataStore.prototype={setDriver:function(a){this.driver=dhx.DataDriver[a]},Fa:function(a){this.callEvent("onParse",[this.driver,a]);this.c&&this.filter();var b=this.driver.getInfo(a);if(b.O)dhx.securityKey=b.O;b.K&&this.callEvent("onServerConfig",[b.K]);var c=this.driver.getRecords(a);this.za(b,c);this.ba&&this.ya&&this.ya(this.ba);this.da&&(this.blockEvent(),this.sort(this.da),this.unblockEvent());this.callEvent("onStoreLoad",[this.driver,a]);this.refresh()},za:function(a,b){var c=(a.m||0)*1,
d=!0,e=!1;if(c===0&&this.order[0]){if(this.Ja)for(var e={},g=0;g<this.order.length;g++)e[this.order[g]]=!0;d=!1;c=this.order.length}for(var h=0,g=0;g<b.length;g++){var f=this.driver.getDetails(b[g]),i=this.id(f);this.pull[i]?d&&this.order[h+c]&&h++:(this.order[h+c]=i,h++);this.pull[i]?(dhx.extend(this.pull[i],f,!0),this.H&&this.H(this.pull[i]),e&&delete e[i]):(this.pull[i]=f,this.G&&this.G(f))}if(e){this.blockEvent();for(var j in e)this.remove(j);this.unblockEvent()}if(!this.order[a.n-1])this.order[a.n-
1]=dhx.undefined},id:function(a){return a.id||(a.id=dhx.uid())},changeId:function(a,b){this.pull[a]&&(this.pull[b]=this.pull[a]);this.pull[b].id=b;this.order[this.order.find(a)]=b;this.c&&(this.c[this.c.find(a)]=b);this.d[a]&&(this.d[b]=this.d[a],delete this.d[a]);this.callEvent("onIdChange",[a,b]);this.Ka&&this.Ka(a,b);delete this.pull[a]},item:function(a){return this.pull[a]},update:function(a,b){dhx.isUndefined(b)&&(b=this.item(a));this.H&&this.H(b);if(this.callEvent("onBeforeUpdate",[a,b])===
!1)return!1;this.pull[a]=b;this.callEvent("onStoreUpdated",[a,b,"update"])},refresh:function(a){this.fa||(a?this.callEvent("onStoreUpdated",[a,this.pull[a],"paint"]):this.callEvent("onStoreUpdated",[null,null,null]))},silent:function(a,b){this.fa=!0;a.call(b||this);this.fa=!1},getRange:function(a,b){a=a?this.indexById(a):this.$min||this.startOffset||0;b?b=this.indexById(b):(b=Math.min(this.$max||this.endOffset||Infinity,this.dataCount()-1),b<0&&(b=0));if(a>b)var c=b,b=a,a=c;return this.getIndexRange(a,
b)},getIndexRange:function(a,b){for(var b=Math.min(b||Infinity,this.dataCount()-1),c=dhx.toArray(),d=a||0;d<=b;d++)c.push(this.item(this.order[d]));return c},dataCount:function(){return this.order.length},exists:function(a){return!!this.pull[a]},move:function(a,b){var c=this.idByIndex(a),d=this.item(c);this.order.removeAt(a);this.order.insertAt(c,Math.min(this.order.length,b));this.callEvent("onStoreUpdated",[c,d,"move"])},scheme:function(a){this.F={};this.G=a.$init;this.H=a.$update;this.ca=a.$serialize;
this.ba=a.$group;this.da=a.$sort;for(var b in a)b.substr(0,1)!="$"&&(this.F[b]=a[b])},sync:function(a,b,c){typeof a=="string"&&(a=$$("source"));typeof b!="function"&&(c=b,b=null);this.I=!1;if(a.name!="DataStore")a.data&&a.data.name=="DataStore"?a=a.data:this.I=!0;var d=dhx.bind(function(d,g,h){if(this.I){if(!d)return;if(d.indexOf("change")===0){if(d=="change")this.pull[g.id]=g.attributes,this.refresh(g.id);return}d=="reset"&&(h=g);this.order=[];this.pull={};this.c=null;for(var f=0;f<h.models.length;f++){var i=
h.models[f].id;this.order.push(i);this.pull[i]=h.models[f].attributes}}else this.c=null,this.order=dhx.toArray([].concat(a.order)),this.pull=a.pull;b&&this.silent(b);this.Z&&this.Z();this.callEvent("onSyncApply",[]);c?c=!1:this.refresh()},this);this.I?a.bind("all",d):this.w=[a.attachEvent("onStoreUpdated",d),a.attachEvent("onIdChange",dhx.bind(function(a,b){this.changeId(a,b)},this))];d()},add:function(a,b,c){if(this.F)for(var d in this.F)dhx.isUndefined(a[d])&&(a[d]=this.F[d]);this.G&&this.G(a);
var e=this.id(a),g=c||this.order,h=g.length;if(dhx.isUndefined(b)||b<0)b=h;b>h&&(b=Math.min(g.length,b));if(this.callEvent("onBeforeAdd",[e,a,b])===!1)return!1;this.pull[e]=a;g.insertAt(e,b);if(this.c){var f=this.c.length;!b&&this.order.length&&(f=0);this.c.insertAt(e,f)}this.callEvent("onAfterAdd",[e,b]);this.callEvent("onStoreUpdated",[e,a,"add"]);return e},remove:function(a){if(dhx.isArray(a))for(var b=0;b<a.length;b++)this.remove(a[b]);else{if(this.callEvent("onBeforeDelete",[a])===!1)return!1;
var c=this.item(a);this.order.remove(a);this.c&&this.c.remove(a);delete this.pull[a];this.d[a]&&delete this.d[a];this.callEvent("onAfterDelete",[a]);this.callEvent("onStoreUpdated",[a,c,"delete"])}},clearAll:function(){this.pull={};this.order=dhx.toArray();this.c=this.url=null;this.callEvent("onClearAll",[]);this.refresh()},idByIndex:function(a){return this.order[a]},indexById:function(a){var b=this.order.find(a);return b},next:function(a,b){return this.order[this.indexById(a)+(b||1)]},first:function(){return this.order[0]},
last:function(){return this.order[this.order.length-1]},previous:function(a,b){return this.order[this.indexById(a)-(b||1)]},sort:function(a,b,c){var d=a;typeof a=="function"?d={as:a,dir:b}:typeof a=="string"&&(d={by:a.replace(/#/g,""),dir:b,as:c});var e=[d.by,d.dir,d.as];this.callEvent("onBeforeSort",e)&&(this.Ma(d),this.refresh(),this.callEvent("onAfterSort",e))},Ma:function(a){if(this.order.length){var b=this.La.qa(a),c=this.getRange(this.first(),this.last());c.sort(b);this.order=c.map(function(a){return this.id(a)},
this)}},wa:function(a){if(this.c&&!a)this.order=this.c,delete this.c},va:function(a,b,c){for(var d=dhx.toArray(),e=0;e<this.order.length;e++){var g=this.order[e];a(this.item(g),b)&&d.push(g)}if(!c||!this.c)this.c=this.order;this.order=d},filter:function(a,b,c){if(this.callEvent("onBeforeFilter",[a,b])&&(this.wa(c),this.order.length)){if(a){var d=a,b=b||"";typeof a=="string"&&(a=a.replace(/#/g,""),typeof b=="function"?d=function(c){return b(c[a])}:(b=b.toString().toLowerCase(),d=function(b,c){return(b[a]||
"").toString().toLowerCase().indexOf(c)!=-1}));this.va(d,b,c,this.Pa)}this.refresh();this.callEvent("onAfterFilter",[])}},each:function(a,b){for(var c=0;c<this.order.length;c++)a.call(b||this,this.item(this.order[c]))},Ca:function(a,b){return function(){return a[b].apply(a,arguments)}},addMark:function(a,b,c,d){var e=this.d[a]||{};this.d[a]=e;if(!e[b]&&(e[b]=d||!0,c))this.item(a).$css=(this.item(a).$css||"")+" "+b,this.refresh(a);return e[b]},removeMark:function(a,b,c){var d=this.d[a];d&&d[b]&&delete d[b];
if(c){var e=this.item(a).$css;if(e)this.item(a).$css=e.replace(b,""),this.refresh(a)}},hasMark:function(a,b){var c=this.d[a];return c&&c[b]},provideApi:function(a,b){b&&this.mapEvent({onbeforesort:a,onaftersort:a,onbeforeadd:a,onafteradd:a,onbeforedelete:a,onafterdelete:a,onbeforeupdate:a});for(var c="sort,add,remove,exists,idByIndex,indexById,item,update,refresh,dataCount,filter,next,previous,clearAll,first,last,serialize,sync,addMark,removeMark,hasMark".split(","),d=0;d<c.length;d++)a[c[d]]=this.Ca(this,
c[d])},serialize:function(){for(var a=this.order,b=[],c=0;c<a.length;c++){var d=this.pull[a[c]];(!this.ca||!(d=this.ca(d),d===!1))&&b.push(d)}return b},La:{qa:function(a){return this.ra(a.dir,this.ma(a.by,a.as))},ja:{date:function(a,b){a-=0;b-=0;return a>b?1:a<b?-1:0},"int":function(a,b){a*=1;b*=1;return a>b?1:a<b?-1:0},string_strict:function(a,b){a=a.toString();b=b.toString();return a>b?1:a<b?-1:0},string:function(a,b){if(!b)return 1;if(!a)return-1;a=a.toString().toLowerCase();b=b.toString().toLowerCase();
return a>b?1:a<b?-1:0}},ma:function(a,b){if(!a)return b;typeof b!="function"&&(b=this.ja[b||"string"]);return function(c,d){return b(c[a],d[a])}},ra:function(a,b){return a=="asc"||!a?b:function(a,d){return b(a,d)*-1}}}};
dhx.BaseBind={bind:function(a,b,c){typeof a=="string"&&(a=dhx.ui.get(a));a.b&&a.b();this.b&&this.b();a.getBindData||dhx.extend(a,dhx.BindSource);if(!this.ka){var d=this.render;if(this.filter){var e=this.a.id;this.data.Z=function(){a.l[e]=!1}}this.render=function(){if(!this.X){this.X=!0;var a=this.callEvent("onBindRequest");this.X=!1;return d.apply(this,a===!1?arguments:[])}};if(this.getValue||this.getValues)this.save=function(){if(!this.validate||this.validate())a.setBindData(this.getValue?this.getValue:
this.getValues(),this.a.id)};this.ka=!0}a.addBind(this.a.id,b,c);var g=this.a.id;this.attachEvent(this.touchable?"onAfterRender":"onBindRequest",function(){return a.getBindData(g)});!this.a.dataFeed&&this.loadNext&&this.data.attachEvent("onStoreLoad",function(){a.l[g]=!1});this.isVisible(this.a.id)&&this.refresh()},g:function(a){a.removeBind(this.a.id);var b=this.w||(this.data?this.data.w:0);if(b&&a.data)for(var c=0;c<b.length;c++)a.data.detachEvent(b[c])}};
dhx.BindSource={$init:function(){this.p={};this.l={};this.A={};this.la(this)},saveBatch:function(a){this.V=!0;a.call(this);this.V=!1;this.k()},setBindData:function(a,b){b&&(this.A[b]=!0);if(this.setValue)this.setValue(a);else if(this.setValues)this.setValues(a);else{var c=this.getCursor();c&&(a=dhx.extend(this.item(c),a,!0),this.update(c,a))}this.callEvent("onBindUpdate",[a,b]);this.save&&this.save();b&&(this.A[b]=!1)},getBindData:function(a,b){if(this.l[a])return!1;var c=dhx.ui.get(a);c.isVisible(c.a.id)&&
(this.l[a]=!0,this.J(c,this.p[a][0],this.p[a][1]),b&&c.filter&&c.refresh())},addBind:function(a,b,c){this.p[a]=[b,c]},removeBind:function(a){delete this.p[a];delete this.l[a];delete this.A[a]},la:function(a){a.filter?dhx.extend(this,dhx.CollectionBind):a.setValue?dhx.extend(this,dhx.ValueBind):dhx.extend(this,dhx.RecordBind)},k:function(){if(!this.V)for(var a in this.p)this.A[a]||(this.l[a]=!1,this.getBindData(a,!0))},S:function(a,b,c){a.setValue?a.setValue(c?c[b]:c):a.filter?a.data.silent(function(){this.filter(b,
c)}):!c&&a.clear?a.clear():a.z(c)&&a.setValues(dhx.clone(c));a.callEvent("onBindApply",[c,b,this])}};dhx.DataValue=dhx.proto({name:"DataValue",isVisible:function(){return!0},$init:function(a){var b=(this.data=a)&&a.id?a.id:dhx.uid();this.a={id:b};dhx.ui.views[b]=this},setValue:function(a){this.data=a;this.callEvent("onChange",[a])},getValue:function(){return this.data},refresh:function(){this.callEvent("onBindRequest")}},dhx.EventSystem,dhx.BaseBind);
dhx.DataRecord=dhx.proto({name:"DataRecord",isVisible:function(){return!0},$init:function(a){this.data=a||{};var b=a&&a.id?a.id:dhx.uid();this.a={id:b};dhx.ui.views[b]=this},getValues:function(){return this.data},setValues:function(a){this.data=a;this.callEvent("onChange",[a])},refresh:function(){this.callEvent("onBindRequest")}},dhx.EventSystem,dhx.BaseBind,dhx.AtomDataLoader,dhx.Settings);
dhx.DataCollection=dhx.proto({name:"DataCollection",isVisible:function(){return!this.data.order.length&&!this.data.c&&!this.a.dataFeed?!1:!0},$init:function(a){this.data.provideApi(this,!0);var b=a&&a.id?a.id:dhx.uid();this.a.id=b;dhx.ui.views[b]=this;this.data.attachEvent("onStoreLoad",dhx.bind(function(){this.callEvent("onBindRequest",[])},this))},refresh:function(){this.callEvent("onBindRequest",[])}},dhx.DataLoader,dhx.EventSystem,dhx.BaseBind,dhx.Settings);
dhx.ValueBind={$init:function(){this.attachEvent("onChange",this.k)},J:function(a,b,c){var d=this.getValue()||"";c&&(d=c(d));if(a.setValue)a.setValue(d);else if(a.filter)a.data.silent(function(){this.filter(b,d)});else{var e={};e[b]=d;a.z(d)&&a.setValues(e)}a.callEvent("onBindApply",[d,b,this])}};dhx.RecordBind={$init:function(){this.attachEvent("onChange",this.k)},J:function(a,b){var c=this.getValues()||null;this.S(a,b,c)}};
dhx.CollectionBind={$init:function(){this.h=null;this.attachEvent("onSelectChange",function(){var a=this.getSelected();this.setCursor(a?a.id||a:null)});this.attachEvent("onAfterCursorChange",this.k);this.data.attachEvent("onStoreUpdated",dhx.bind(function(a,b,c){a&&a==this.getCursor()&&c!="paint"&&this.k()},this));this.data.attachEvent("onClearAll",dhx.bind(function(){this.h=null},this));this.data.attachEvent("onIdChange",dhx.bind(function(a,b){if(this.h==a)this.h=b},this))},setCursor:function(a){if(!(a==
this.h||a!==null&&!this.item(a)))this.callEvent("onBeforeCursorChange",[this.h]),this.h=a,this.callEvent("onAfterCursorChange",[a])},getCursor:function(){return this.h},J:function(a,b){var c=this.item(this.getCursor())||this.a.defaultData||null;this.S(a,b,c)}};if(!dhx.ui)dhx.ui={};if(!dhx.ui.views)dhx.ui.views={},dhx.ui.get=function(a){return a.a?a:dhx.ui.views[a]};
dhtmlXDataStore=function(a){var b=new dhx.DataCollection(a),c="_dp_init";b[c]=function(a){var b="_methods";a[b]=["dummy","dummy","changeId","dummy"];this.data.Da={add:"inserted",update:"updated","delete":"deleted"};this.data.attachEvent("onStoreUpdated",function(b,c,e){b&&!a.ea&&a.setUpdated(b,!0,this.Da[e])});b="_getRowData";a[b]=function(a){var b=this.obj.data.item(a),c={id:a};c[this.action_param]=this.obj.getUserData(a);if(b)for(var d in b)c[d]=b[d];return c};this.changeId=function(b,c){this.data.changeId(b,
c);a.ea=!0;this.data.callEvent("onStoreUpdated",[c,this.item(c),"update"]);a.ea=!1};b="_clearUpdateFlag";a[b]=function(){};this.ia={}};b.dummy=function(){};b.setUserData=function(a,b,c){this.ia[a]=c};b.getUserData=function(a){return this.ia[a]};b.dataFeed=function(a){this.define("dataFeed",a)};dhx.extend(b,dhx.BindSource);return b};
if(window.dhtmlXDataView)dhtmlXDataView.prototype.b=function(){this.isVisible=function(){return!this.data.order.length&&!this.data.c&&!this.a.dataFeed?!1:!0};var a="_settings";this.a=this.a||this[a];if(!this.a.id)this.a.id=dhx.uid();this.unbind=dhx.BaseBind.unbind;this.unsync=dhx.BaseBind.unsync;dhx.ui.views[this.a.id]=this};
if(window.dhtmlXChart)dhtmlXChart.prototype.b=function(){this.isVisible=function(){return!this.data.order.length&&!this.data.Qa&&!this.a.dataFeed?!1:!0};var a="_settings";this.a=this.a||this[a];if(!this.a.id)this.a.id=dhx.uid();this.unbind=dhx.BaseBind.unbind;this.unsync=dhx.BaseBind.unsync;dhx.ui.views[this.a.id]=this};dhx.BaseBind.unsync=function(a){return dhx.BaseBind.g.call(this,a)};dhx.BaseBind.unbind=function(a){return dhx.BaseBind.g.call(this,a)};
dhx.BaseBind.legacyBind=function(){return dhx.BaseBind.bind.apply(this,arguments)};
dhx.BaseBind.legacySync=function(a,b){this.b&&this.b();a.b&&a.b();this.attachEvent("onAfterEditStop",function(a){this.save(a);return!0});this.attachEvent("onDataRequest",function(b,d){for(var e=b;e<b+d;e++)if(!a.data.order[e])return a.loadNext(d,b),!1});this.save=function(b){b||(b=this.getCursor());var d=this.item(b),e=a.item(b),g;for(g in d)g.indexOf("$")!==0&&(e[g]=d[g]);a.refresh(b)};return a&&a.name=="DataCollection"?a.data.sync.apply(this.data,arguments):this.data.sync.apply(this.data,arguments)};
if(window.dhtmlXForm)dhtmlXForm.prototype.bind=function(a){dhx.BaseBind.bind.apply(this,arguments);a.getBindData(this.a.id)},dhtmlXForm.prototype.unbind=function(a){dhx.BaseBind.g.call(this,a)},dhtmlXForm.prototype.b=function(){if(dhx.isUndefined(this.a))this.a={id:dhx.uid(),dataFeed:this.j},dhx.ui.views[this.a.id]=this},dhtmlXForm.prototype.z=function(a){if(!this.a.dataFeed||this.N||!a)return!0;var b=this.a.dataFeed;if(typeof b=="function")return b.call(this,a.id||a,a);b=b+(b.indexOf("?")==-1?"?":
"&")+"action=get&id="+encodeURIComponent(a.id||a);this.load(b);return!1},dhtmlXForm.prototype.setValues=dhtmlXForm.prototype.setFormData,dhtmlXForm.prototype.getValues=function(){return this.getFormData(!1,!0)},dhtmlXForm.prototype.dataFeed=function(a){this.a?this.a.dataFeed=a:this.j=a},dhtmlXForm.prototype.refresh=dhtmlXForm.prototype.isVisible=function(){return!0};
if(window.scheduler){if(!window.Scheduler)window.Scheduler={};Scheduler.$syncFactory=function(a){a.sync=function(b,c){this.b&&this.b();b.b&&b.b();var d="_process_loading",e=function(){a.clearAll();for(var e=b.data.order,h=b.data.pull,f=[],i=0;i<e.length;i++)f[i]=c&&c.copy?dhx.clone(h[e[i]]):h[e[i]];a[d](f)};this.save=function(a){a||(a=this.getCursor());var c=this.item(a),d=b.item(a);this.callEvent("onStoreSave",[a,c,d])&&(dhx.extend(b.item(a),c,!0),b.update(a))};this.item=function(a){return this.getEvent(a)};
this.w=[b.data.attachEvent("onStoreUpdated",function(){e.call(this)}),b.data.attachEvent("onIdChange",function(a,b){combo.changeOptionId(a,b)})];this.attachEvent("onEventChanged",function(a){this.save(a)});this.attachEvent("onEventAdded",function(a,c){b.data.pull[a]||b.add(c)});this.attachEvent("onEventDeleted",function(a){b.data.pull[a]&&b.remove(a)});e()};a.unsync=function(a){dhx.BaseBind.g.call(this,a)};a.b=function(){if(!this.a)this.a={id:dhx.uid()}}};Scheduler.$syncFactory(window.scheduler)}
if(window.dhtmlXCombo)dhtmlXCombo.prototype.bind=function(){dhx.BaseBind.bind.apply(this,arguments)},dhtmlXCombo.unbind=function(a){dhx.BaseBind.g.call(this,a)},dhtmlXCombo.unsync=function(a){dhx.BaseBind.g.call(this,a)},dhtmlXCombo.prototype.dataFeed=function(a){this.a?this.a.dataFeed=a:this.j=a},dhtmlXCombo.prototype.sync=function(a){this.b&&this.b();a.b&&a.b();var b=this,c=function(){b.clearAll();b.addOption(this.serialize())};this.w=[a.data.attachEvent("onStoreUpdated",function(){c.call(this)}),
a.data.attachEvent("onIdChange",function(a,c){b.changeOptionId(a,c)})];c.call(a)},dhtmlXCombo.prototype.b=function(){if(dhx.isUndefined(this.a))this.a={id:dhx.uid(),dataFeed:this.j},dhx.ui.views[this.a.id]=this,this.data={silent:dhx.bind(function(a){a.call(this)},this)},dhtmlxEventable(this.data),this.attachEvent("onChange",function(){this.callEvent("onSelectChange",[this.getSelectedValue()])}),this.attachEvent("onXLE",function(){this.callEvent("onBindRequest",[])})},dhtmlXCombo.prototype.item=function(a){return this.getOption(a)},
dhtmlXCombo.prototype.getSelected=function(){return this.getSelectedValue()},dhtmlXCombo.prototype.isVisible=function(){return!this.optionsArr.length&&!this.a.dataFeed?!1:!0},dhtmlXCombo.prototype.refresh=function(){this.render(!0)},dhtmlXCombo.prototype.filter=function(){alert("not implemented")};
if(window.dhtmlXGridObject)dhtmlXGridObject.prototype.bind=function(a,b,c){dhx.BaseBind.bind.apply(this,arguments)},dhtmlXGridObject.prototype.unbind=function(a){dhx.BaseBind.g.call(this,a)},dhtmlXGridObject.prototype.unsync=function(a){dhx.BaseBind.g.call(this,a)},dhtmlXGridObject.prototype.dataFeed=function(a){this.a?this.a.dataFeed=a:this.j=a},dhtmlXGridObject.prototype.sync=function(a,b){this.b&&this.b();a.b&&a.b();var c=this,d="_parsing",e="_parser",g="_locator",h="_process_store_row",f="_get_store_data";
this.save=function(b){b||(b=this.getCursor());dhx.extend(a.item(b),this.item(b),!0);a.update(b)};var i=function(){var a=c.getCursor?c.getCursor():null,b=0;c.B?(b=c.B,c.B=!1):c.clearAll();var i=this.dataCount();if(i){c[d]=!0;for(var m=b;m<i;m++){var n=this.order[m];if(n&&(!b||!c.rowsBuffer[m]))c.rowsBuffer[m]={idd:n,data:this.pull[n]},c.rowsBuffer[m][e]=c[h],c.rowsBuffer[m][g]=c[f],c.rowsAr[n]=this.pull[n]}if(!c.rowsBuffer[i-1])c.rowsBuffer[i-1]=dhtmlx.undefined,c.xmlFileUrl=c.xmlFileUrl||this.url;
c.pagingOn?c.changePage():c.Ta&&c.Oa?c.Ua():(c.render_dataset(),c.callEvent("onXLE",[]));c[d]=!1}a&&c.setCursor&&c.setCursor(c.rowsAr[a]?a:null)};this.w=[a.data.attachEvent("onStoreUpdated",function(a,b,d){d=="delete"?(c.deleteRow(a),c.data.callEvent("onStoreUpdated",[a,b,d])):d=="update"?(c.callEvent("onSyncUpdate",[b,d]),c.update(a,b),c.data.callEvent("onStoreUpdated",[a,b,d])):d=="add"?(c.callEvent("onSyncUpdate",[b,d]),c.add(a,b,this.indexById(a)),c.data.callEvent("onStoreUpdated",[a,b,d])):i.call(this)}),
a.data.attachEvent("onStoreLoad",function(b,d){c.xmlFileUrl=a.data.url;c.B=b.getInfo(d).m}),a.data.attachEvent("onIdChange",function(a,b){c.changeRowId(a,b)})];c.attachEvent("onDynXLS",function(b,d){for(var e=b;e<b+d;e++)if(!a.data.order[e])return a.loadNext(d,b),!1;c.B=b;i.call(a.data)});i.call(a.data);c.attachEvent("onEditCell",function(a,b,c,d,e){a==2&&d!=e&&this.save(b);return!0});c.attachEvent("onClearAll",function(){var a="_f_rowsBuffer";this[a]=null});b&&b.sort&&c.attachEvent("onBeforeSorting",
function(b,d,e){if(d=="connector")return!1;var f=this.getColumnId(b);a.sort("#"+f+"#",e=="asc"?"asc":"desc",d=="int"?d:"string");c.setSortImgState(!0,b,e);return!1});if(b&&b.filter)c.attachEvent("onFilterStart",function(b,d){var e="_con_f_used";if(c[e]&&c[e].length)return!1;a.data.silent(function(){a.filter();for(var e=0;e<b.length;e++)if(d[e]!=""){var f=c.getColumnId(b[e]);a.filter("#"+f+"#",d[e],e!=0)}});a.refresh();return!1}),c.collectValues=function(b){var c=this.getColumnId(b);return function(a){var b=
[],c={};this.data.each(function(d){var e=d[a];c[e]||(c[e]=!0,b.push(e))});return b}.call(a,c)};b&&b.select&&c.attachEvent("onRowSelect",function(b){a.setCursor(b)});c.clearAndLoad=function(b){a.clearAll();a.load(b)}},dhtmlXGridObject.prototype.b=function(){if(dhx.isUndefined(this.a)){this.a={id:dhx.uid(),dataFeed:this.j};dhx.ui.views[this.a.id]=this;this.data={silent:dhx.bind(function(a){a.call(this)},this)};dhtmlxEventable(this.data);for(var a="_cCount",b=0;b<this[a];b++)this.columnIds[b]||(this.columnIds[b]=
"cell"+b);this.attachEvent("onSelectStateChanged",function(a){this.callEvent("onSelectChange",[a])});this.attachEvent("onSelectionCleared",function(){this.callEvent("onSelectChange",[null])});this.attachEvent("onEditCell",function(a,b){a===2&&this.getCursor&&b&&b==this.getCursor()&&this.k();return!0});this.attachEvent("onXLE",function(){this.callEvent("onBindRequest",[])})}},dhtmlXGridObject.prototype.item=function(a){if(a===null)return null;var b=this.getRowById(a);if(!b)return null;var c="_attrs",
d=dhx.copy(b[c]);d.id=a;for(var e=this.getColumnsNum(),g=0;g<e;g++)d[this.columnIds[g]]=this.cells(a,g).getValue();return d},dhtmlXGridObject.prototype.update=function(a,b){for(var c=0;c<this.columnIds.length;c++){var d=this.columnIds[c];dhx.isUndefined(b[d])||this.cells(a,c).setValue(b[d])}var e="_attrs",g=this.getRowById(a)[e];for(d in b)g[d]=b[d];this.callEvent("onBindUpdate",[a])},dhtmlXGridObject.prototype.add=function(a,b,c){for(var d=[],e=0;e<this.columnIds.length;e++){var g=this.columnIds[e];
d[e]=dhx.isUndefined(b[g])?"":b[g]}this.addRow(a,d,c);var h="_attrs";this.getRowById(a)[h]=dhx.copy(b)},dhtmlXGridObject.prototype.getSelected=function(){return this.getSelectedRowId()},dhtmlXGridObject.prototype.isVisible=function(){var a="_f_rowsBuffer";return!this.rowsBuffer.length&&!this[a]&&!this.a.dataFeed?!1:!0},dhtmlXGridObject.prototype.refresh=function(){this.render_dataset()},dhtmlXGridObject.prototype.filter=function(a,b){if(this.a.dataFeed){var c={};if(!a&&!b)return;if(typeof a=="function"){if(!b)return;
a(b,c)}else dhx.isUndefined(a)?c=b:c[a]=b;this.clearAll();var d=this.a.dataFeed;if(typeof d=="function")return d.call(this,b,c);var e=[],g;for(g in c)e.push("dhx_filter["+g+"]="+encodeURIComponent(c[g]));this.load(d+(d.indexOf("?")<0?"?":"&")+e.join("&"));return!1}if(b===null)return this.filterBy(0,function(){return!1});this.filterBy(0,function(c,d){return a.call(this,d,b)})};
if(window.dhtmlXTreeObject)dhtmlXTreeObject.prototype.bind=function(){dhx.BaseBind.bind.apply(this,arguments)},dhtmlXTreeObject.prototype.unbind=function(a){dhx.BaseBind.g.call(this,a)},dhtmlXTreeObject.prototype.dataFeed=function(a){this.a?this.a.dataFeed=a:this.j=a},dhtmlXTreeObject.prototype.b=function(){if(dhx.isUndefined(this.a))this.a={id:dhx.uid(),dataFeed:this.j},dhx.ui.views[this.a.id]=this,this.data={silent:dhx.bind(function(a){a.call(this)},this)},dhtmlxEventable(this.data),this.attachEvent("onSelect",
function(a){this.callEvent("onSelectChange",[a])}),this.attachEvent("onEdit",function(a,b){a===2&&b&&b==this.getCursor()&&this.k();return!0})},dhtmlXTreeObject.prototype.item=function(a){return a===null?null:{id:a,text:this.getItemText(a)}},dhtmlXTreeObject.prototype.getSelected=function(){return this.getSelectedItemId()},dhtmlXTreeObject.prototype.isVisible=function(){return!0},dhtmlXTreeObject.prototype.refresh=function(){},dhtmlXTreeObject.prototype.filter=function(a,b){if(this.a.dataFeed){var c=
{};if(a||b){if(typeof a=="function"){if(!b)return;a(b,c)}else dhx.isUndefined(a)?c=b:c[a]=b;this.deleteChildItems(0);var d=this.a.dataFeed;if(typeof d=="function")return d.call(this,[data.id||data,data]);var e=[],g;for(g in c)e.push("dhx_filter["+g+"]="+encodeURIComponent(c[g]));this.loadXML(d+(d.indexOf("?")<0?"?":"&")+e.join("&"));return!1}}},dhtmlXTreeObject.prototype.update=function(a,b){dhx.isUndefined(b.text)||this.setItemText(a,b.text)};dhtmlx.skin="dhx_skyblue";


function seperatorappendgrid(gridobj){
		var len= gridobj.editor.obj.value;
		if(parseInt(len.length) >=10)
			ev.keyCode = 0;
		else if(parseInt(len.length)==2 || parseInt(len.length)==5){
			gridobj.editor.obj.value =len + "/";
		}
}